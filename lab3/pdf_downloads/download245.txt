Joint Dimensionality Reduction and Metric Learning: A Geometric Take
Supplementary Material

Mehrtash Harandi 1 2 Mathieu Salzmann 3 Richard Hartley 2 1

1. Quotient Manifolds: Theory and Derivations
In the following, we first provide some general theory about quotient manifolds, and then derive the quantities that are of
interest for our particular purpose.
1.1. Theory of Quotient Manifolds
Let Mp be a Riemannian manifold and G be a group acting on Mp , that is, G defines a mapping f : G × Mp → Mp .
The orbit of a point x ∈ Mp is the set of images of x under all elements of the group, i.e.,
Orb(x) = {f (g, x) : ∀g ∈ G} .
The action of group G defines a relation denoted by ∼ in the form x ∼ q : ∃g ∈ G s.t. q = f (g, x). Recall that a relation
∼ on a set X is said to be an equivalence relation iff ∀a, b, c ∈ X , a ∼ a (reflexive), a ∼ b ⇒ b ∼ a (symmetric) and if
a ∼ b and b ∼ c then a ∼ c(transitive). If the action of group G defines an equivalence relation, then under the conditions
of Theorem 1 below, the set of orbits denoted by Mp \G forms a smooth manifold.
Theorem 1 (Quotient Manifold Theorem). Suppose that a Lie group G acts smoothly, freely and properly on a smooth
manifold Mp . Then Mp \G is a topological manifold of dimension dim(Mp ) − dim(G), and has a unique smooth
structure.
Proof. See Theorem 9.16 in (Lee, 2003).
Intuitively, a quotient manifold M , Mp \G is formed by gluing points of Mp together using the equivalence relation
∼. Assuming that M is a smooth manifold, it is possible to make use of the structure of Mp to define the Riemannian
geometry of M, as discussed below. To this end, let us first define the tangent space of a quotient manifold in general, and
then focus on the specific quotient manifold of interest in this work.
1.1.1. TANGENT SPACES .
The equivalence relation ∼ splits the tangent space of Mt at Ω into two complementary parts, namely the horizontal
space HΩ Mp and the vertical space VΩ Mp with respect to the metric gp (·, ·) on the original manifold Mp . That is,
TΩ Mp = HΩ Mp ⊕ VΩ Mp , with
HΩ Mp = {hΩ ∈ TΩ Mp : gp (hΩ , v Ω ) = 0, ∀v Ω ∈ VΩ Mp } .

(1)

The tangent space of the quotient manifold is identified with the horizontal space of the original manifold, i.e., T[Ω] M ,
HΩ Mp . Once the horizontal space HΩ Mp is identified, a tangent vector on ξ[Ω] ∈ T[Ω] M can be uniquely represented
1

Data61, CSIRO, Canberra, Australia 2 Australian National University, Canberra, Australia 3 CVLab, EPFL, Switzerland. Correspondence to: Mehrtash Harandi <mehrtash.harandi@anu.edu.au>.
Proceedings of the 34 th International Conference on Machine Learning, Sydney, Australia, PMLR 70, 2017. Copyright 2017 by the
author(s).

Joint Dimensionality Reduction and Metric Learning: A Geometric Take
↑
by a horizontal tangent vector ξΩ
∈ HΩ Mp . For two tangent vectors ξ[Ω] , ϑ[Ω] ∈ T[Ω] M, the metric in the original space
induces a Riemannian metric on the quotient manifold given by
↑
g(ξ[Ω] , ϑ[Ω] ) , gp (ξΩ
, ϑ↑Ω ) .

(2)

1.2. Derivations for our Specific Quotient Manifold
p
For the product manifold Mp , St(p, n) × S++
, the tangent space is given by
p
T(W ,M ) = TW St(p, n) × TM S++
.

(3)

This lets us define the Riemannian metric of the product manifold as
T
g(W ,M ) ((ξW , ξM ) , (ςW , ςM )) = 2 Tr(ξW
ςW ) + Tr(M −1 ξM M −1 ςM ) .

(4)

The Riemannian gradient of such a space directly follows from the geometry of the Stiefel and SPD manifolds. That is, for
a smooth function fp (W , M ) : Mp → R, we have




 
grad fp = ∇W (fp ) − W sym W T ∇W (fp ) , M sym ∇M (fp ) M .
(5)
Here ∇W (f ) and ∇M (f ) denote the n × p and p × p Euclidean gradients, i.e., the matrix of partial derivatives such that
∇W (fp )i,j =
Theorem 2. The set M o,
n

W R, RT M R ; ∀R ∈ O(p) .
Tr(M

−1

ξM M

−1

∂fp (W , M )
,
∂W i,j

∇M (fp )i,j =

∂fp (W , M )
.
∂M i,j

(6)


p 
St(p, n) × S++
\O(p) with the equivalence relation [ W , M ]
and Riemannian metric g(W ,M ) ((ξW , ξM ) , (ςW , ςM ))

=

T
2 Tr(ξW
ςW )

∼
+

ςM ) forms a Riemannian quotient manifold.

Proof. M
the mapping π :
 is a smooth manifold
 as a direct result of Theorem 9.16 in (Lee, 2003). In particular,

W , M → W R, RT M R for R ∈ O(p) is smooth, free, as W , M = W R, RT M R iff R = Ip , and proper,
since the actions of compact Lie groups (O(p) here) are always proper. This concludes the proof.
Projecting onto the Horizontal Space
Let γ : t → (W R(t), R(t)T M R(t)), with R(t) ∈ Op , be a curve on Mp passing through (W , M ) at t = 0. The
vertical space at (W , M ) is given by γ̇(t) evaluated at t = 0, which yields
γ̇(t)|t=0 = (W Θ, M Ω − ΘM ),
with ΘT = −Θ ∈ Rp×p . As such,
V(W ,M ) Mp = {(W Θ, M Θ − ΘM ) : ΘT = −Θ ∈ Rp×p }.
A horizontal vector (ξW , ξM ) is then defined by the condition

gp (ξW , ξM ), (W Θ, M Θ − ΘM ) = 0 .
Expanding the metric yields

gp (ξW , ξM ), (W Θ, M Θ − ΘM ) = 0
T
⇒ 2 Tr(ξW
W Θ) + Tr(ξM M −1 (M Θ − ΘM )M −1 ) = 0
T
⇒ 2 Tr(ξW
W Θ) + Tr(ξM ΘM −1 ) − Tr(ξM M −1 Θ) = 0

 
T
⇒ Tr 2ξW
W + M −1 ξM − ξM M −1 Θ = 0 .

Joint Dimensionality Reduction and Metric Learning: A Geometric Take
T
Since Θ is a skew-symmetric matrix, the above equality is satisfied iff 2ξW
W + M −1 ξM − ξM M −1 is symmetric. That
is
T
2ξW
W + M −1 ξM − ξM M −1 = 2W T ξW + ξM M −1 − M −1 ξM .
(7)

Let (ξW , ξM ) ∈ T(W ,M ) Mp be a tangent vector of the product manifold. Removing the vertical component results in
the horizontal vector (ξW − W Θ, ξM − M Θ + ΘM ) ∈ H(W ,M ) M. As derived above, this vector should satisfy the
symmetry constraint of Eq. 7. To obtain Θ, we plug the horizontal vector (ξW − W Θ, ξM − M Θ + ΘM ) into Eq. 7,
which yields
2(ξW − W Θ)T W + M −1 (ξM − M Θ + ΘM ) − (ξM − M Θ + ΘM )M −1
= 2W T (ξW − W Θ) + (ξM − M Θ + ΘM )M −1 − M −1 (ξM − M Θ + ΘM )
⇒

T
2ξW
W − 2ΘT W T W + M −1 ξM − Θ + M −1 ΘM − ξM M −1 + M ΘM −1 − Θ

= 2W T ξW − 2W T W Θ + ξM M −1 − M ΘM −1 + Θ − M −1 ξM + Θ − M −1 ΘM
⇒

T
T
T
2ξW
W − 2ΘT + M −1 ξM
+ M −1 ΘM − Θ − ξM
M −1 − Θ + M ΘM −1

= 2W T ξW − 2Θ + ξM M −1 − M ΘM −1 + Θ − M −1 ξM + Θ − M −1 ΘM
⇒
⇒

T
M −1 ΘM + M ΘM −1 = ξW
W − W T ξW + M −1 ξM − ξM M −1


T
ΘM 2 + M 2 Θ = M ξW
W − W T ξW + M −1 ξM − ξM M −1 M .

In other words, Θ can be obtained as the solution to a Sylvester equation.
Remark 1. To have more insights on the structure of M, it is useful to study the form of the tangent vectors on M. Since
both the Stiefel and SPD manifolds are homogeneous spaces, their geometry and hence the geometry of their product space
can be studied by analyzing their structure around any predefined point. Choosing W = [Ip , 0p×(n−p) ]T and following
the derivation above, it can be shown that the tangent vectors of M can be represented as
( 
)


V M −1 − M −1 V
(n−p)×p
U
, V : V ∈ Sym(p), B ∈ R
,
B
with U ∈ On . In the form considered above, a basis for the horizontal subspace can be formed from bases derived from
B ∈ M (n−p)×p and V ∈ Sym(p). The basis elements for the V part are of the form

[V i M −1 − M −1 V i ; 0], V i
where the V i are basis elements for Sym(p). We note that this form of horizontal projection cannot be used in first order
optimization techniques as the basis elements are not orthogonal.
Optimization on M
Given the definitions above, the only missing quantities to perform first order optimization on M are the Euclidean gradients ∇W and ∇M of the cost function in Eq. 10 of the main paper. Defining δi = xi − x̃i , these gradients can be computed
as

 X
X
1
pi
δi δiT −
δi δiT W M ,
(8)
∇W (L(X, W , M )) = 2β
1 + pi
1 + pi
i|yi =0

i|yi =1

∇M (L(X, W , M )) = β

X
i|yi =1

X
pi
1
W T δi δiT W − β
W T δi δiT W + ∇M (r(M , M 0 )) .
1 + pi
1 + pi
i|yi =0

−1
For the Burg regularizer, ∇M (r(M , M 0 )) simply becomes M −1
.
0 −M

References
Lee, John M. Smooth manifolds. Springer, 2003.

(9)

