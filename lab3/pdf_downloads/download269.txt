Analysis and Optimization of Graph Decompositions by Lifted Multicuts
(Supplement)

Andrea Horňáková * 1 Jan-Hendrik Lange * 1 Bjoern Andres 1

Appendix
A. Multicuts
Proof of Lemma 2 First, we show that for any Π ∈ DG ,
the image φG (Π) is a multicut of G. Assume the contrary,
i.e. there exists a cycle C of G such that |C ∩ φG (Π)| = 1.
Let {u, v} = e ∈ C ∩ φG (Π), then for all U ∈ Π it holds
that u ∈
/ U or v ∈
/ U . However, C \ {e} is a sequence of
edges {w1 , w2 }, . . . , {wk−1 , wk } such that u = w1 , v =
wk and {wi , wi+1 } ∈
/ φG (Π) for all 1 ≤ i ≤ k − 1. Consequently, since Π is a partition of V , there exists some
U ∈ Π such that
w1 ∈ U ∧ w2 ∈ U ∧ . . . ∧ wk−1 ∈ U ∧ wk ∈ U.
This contradicts w1 = u ∈
/ U or wk = v ∈
/ U.
To show injectivity of φG , let Π = {U1 , . . . , Uk }, Π0 =
{U10 , . . . , U`0 } be two decompositions of G. Suppose Π 6=
Π0 . Then (w.l.o.g.) there exist some u, v ∈ V with {u, v} ∈
E and some Ui ∈ Π such that u, v ∈ Ui and for all Uj0 ∈ Π0
it holds that u ∈
/ Uj0 or v ∈
/ Uj0 . Thus, {u, v} ∈ φG (Π0 ) but
{u, v} ∈
/ φG (Π), which means φG (Π) 6= φG (Π0 ).
For surjectivity, take some multicut M ⊆ E of G. Let
Π = {U1 , . . . , Uk } collect the node sets of the connected
components of the graph (V, E \ M ). Apparently, Π defines
a decomposition of G. We have {u, v} ∈ φG (Π) if and
only if for all U ∈ Π it holds that v ∈
/ U or u ∈
/ U . The
latter holds true if and only if {u, v} is not contained in any
connected component of (V, E \ M ), which is equivalent
to {v, w} ∈ M . Hence, φG (Π) = M .
Proof of Lemma 4 First, we show that for any M ∈
MKV the image ψ(M ) is an equivalence relation on V .
Since KV is simple, we trivially have {v, v} ∈
/ M for any
v ∈ V . Therefore, (v, v) ∈ ψ(M ), which means ψ(M )
is reflexive. Symmetry of ψ(M ) follows from {u, v} =
*

Equal contribution 1 Max Planck Institute for Informatics,
Saarbrücken, Germany. Correspondence to: Bjoern Andres
<andres@mpi-inf.mpg.de>.
Proceedings of the 34 th International Conference on Machine
Learning, Sydney, Australia, PMLR 70, 2017. Copyright 2017 by
the author(s).

{v, u} for all u, v ∈ V . Now, suppose (u, v), (v, w) ∈
/ M and thus {u, w} ∈
/ M
ψ(M ). Then {u, v, }, {v, w} ∈
(otherwise C = {u, v, w} would be a cycle contradicting
the definition of a multicut). Hence, (u, w) ∈ ψ(M ), which
gives transitivity of ψ(M ).
Let M, M 0 be two multicuts of KV with ψ(M ) = ψ(M 0 ).
Then
{u, v} ∈ M ⇐⇒ (u, v) ∈
/ ψ(M )
⇐⇒ (u, v) ∈
/ ψ(M 0 )
⇐⇒ {u, v} ∈ M 0 .
Hence M = M 0 , so ψ is injective.
Let R be an equivalence relation on V and define M by
{u, v} ∈ M ⇐⇒ (u, v) ∈
/ R.
Transitivity of R implies that M is a multicut of KV . Moreover, by definition, it holds that ψ(M ) = R. Hence, ψ is
also surjective.

B. Lifted Multicuts
0

Proof of Lemma 5 Let x ∈ {0, 1}E be such that M 0 =
x−1 (1) is a multicut of G0 lifted from G. Every cycle in G is
a cycle in G0 . Moreover, for any path vw = f ∈ FGG0 and
any vw-path P in G, it holds that P ∪ {f } is a cycle in G0 .
Therefore, x satisfies all inequalities (4) and (5). Assume
x violates some inequality of (6). Then there is an edge
vw ∈ FGG0 and some vw-cut C in G such that xvw = 0
and for all e ∈ C we have xe = 1. Let Π be the partition
of V corresponding to M 0 according to Lemma 2. There
exists some U ∈ Π with v ∈ U and w ∈ U . However, for
any uu0 = e ∈ C it holds that u ∈
/ U or u0 ∈
/ U . This
U
means the subgraph (U, E ∩ 2 ) is not connected, as C is
a vw-cut. Hence, Π is not a decomposition of G, which is a
contradiction, because G is connected.
Now, suppose x ∈ E 0 satisfies all inequalities (4)–(6). We
show first that M 0 = x−1 (1) is a multicut of G0 . Assume
the contrary, then there is a cycle C 0 in G0 and some edge
e0 such that C 0 ∩ M 0 = {e0 }. For every vw = f ∈ FGG0 ∩
C 0 \ {e0 } there exists a vw-path P in G such that xe = 0
for all e ∈ P . Otherwise there would be some vw-cut in G

Analysis and Optimization of Graph Decompositions by Lifted Multicuts (Supplement)

a

a

ā

ā

b

c

c

c

s

j-th clause in A, containing one node for each of the
three literals1 in the clause. Every node is labeled with
its corresponding literal. Layer 0 contains only the
node s. Layer n + 1 contains only the node t.
t

c̄

d¯

e

ē

Figure 1. To show that the consistency problem is NP-hard, we
reduce 3-SAT to this problem. Shown above is the instance of the
consistency problem constructed for the instance of 3-SAT given by
¯ ∧ (ā ∨ c ∨ e) ∧ (ā ∨ c ∨ ē). Solid
the form (a ∨ b ∨ c̄) ∧ (a ∨ c ∨ d)
and dashed lines depict edges in E and E 0 \ E, respectively. Black
means x̃e = 0. Red means x̃e = 1. Grey means e ∈
/ dom x̃.

violating (6), as G is connected. If we replace every such
f with its associated path P in G, then the resulting cycle
violates either (4) (if e0 ∈ E) or (5) (if e0 ∈ FGG0 ). Thus,
M 0 is a multicut of G0 . By connectivity of G, the partition
0
0
φ−1
G0 (M ) is a decomposition of both G and G. Therefore,
−1
−1
0
0
M = λGG0 (M ) = φG (φG0 (M )) is a multicut of G and
hence M 0 = x−1 (1) is indeed lifted from G.

C. Partial Lifted Multicuts
Proof of Theorem 1 Firstly, we show that the consistency
problem is in NP. For that, we show that verifying, for
0
any given x ∈ {0, 1}E , that x is a completion of x̃ and a
characteristic function of a multicut of G0 lifted from G is
a problem of polynomial time complexity. To verify that x
is a completion of x̃, we verify for every e ∈ dom x̃ that
xe = x̃e . This takes time O(|E|). To verify that x−1 (1)
is a multicut of G0 lifted from G, we employ a disjoint set
data structure initialized with singleton sets V . For any
{v, w} ∈ x−1 (0), we call union(v, w). Then, we verify for
every {v, w} ∈ x−1 (1) that find(v) 6= find(w). This takes
time O(|E| + |V | log |V |).
To show that the consistency problem is NP-hard, we reduce
3- SAT to this problem. For that, we consider any instance of
3- SAT defined by a propositional logic formula A in 3- SAT
form. An example is shown in Fig. 1. Let m be the number
of variables and n the number of clauses in A.
In order to define an instance of the consistency problem w.r.t. this instance of 3- SAT, we construct in polynomial time a connected graph G = (V, E), a graph
G0 = (V, E 0 ) with E ⊆ E 0 , and a partial characteristic
0
function x̃ ∈ {0, 1, ∗}E as described below. An example
of this construction is shown in Fig. 1.
• There are 3n + 2 nodes in V . Two nodes are denoted
by s and t. Additional nodes are organized in n layers.
For j ∈ {1, . . . , n}, the j-th layer corresponds to the

• Any two consecutive layers are connected such that
their nodes together induce a complete bipartite subgraph of G. Additionally, any nodes v and w labeled with conflicting literals, a and ā, that are not
already connected in G are connected in G0 by an edge
{v, w} ∈ E 0 \ E.
• For any edge {v, w} ∈ E 0 whose nodes v and w are
labeled with conflicting literals, we set x̃vw = 1. In
addition, we introduce the edge {s, t} ∈ E 0 \ E and
define x̃st = 0. No other edges are in the domain of x̃.
Observe that x̃ is consistent iff there exists an st-path P in G
such that no edge or chord {v, w} of P is such that x̃vw = 1.
Any such path is called feasible. All other st-paths in G are
called infeasible.
Now, we show firstly that the existence of a feasible path
implies the existence of a solution to the given instance of
3- SAT. Secondly, we show that the existence of a solution
to the given instance of 3- SAT implies the existence of a
feasible path. That suffices.
1. Let P be a feasible path and let VP its node set. An
assignment χ to the variables of the instance of 3- SAT
is constructed as follows: For any node v ∈ VP whose
label is a variable a, we define χ(a) := true. For
any node v ∈ VP whose label is a negated variable ā,
we define χ(a) := false. All remaining variables are
assigned arbitrary truth values. By the properties of P ,
χ is well-defined and A[χ] is true.
2. Let χ be a solution to the given instance of 3- SAT.
As every clause of A contains one literal that is true,
and by construction of G, we can choose an st-path in
G along which all nodes are labeled with literals that
are true for the assignment χ. By virtue of χ being a
solution to the instance of 3- SAT, any pair of literals
that are both true are non-conflicting. Thus, P has no
edge or chord {v, w} such that x̃vw = 1.
Proof of Lemma 6 Firstly, suppose that E ⊆ dom x̃. In
this case, it is clear that x̃ is consistent iff x̃ satisfies all
cycle inequalities (4) w.r.t. the graph (V, E ∩ dom x̃). This
can be checked in time O(|V | + |E 0 |) as follows: Label the
maximal components of the subgraph Gx̃ of G induced by
the edge set {e ∈ E : x̃e = 0}. Then, for every {v, w} ∈
E 0 with x̃vw = 1, check if v and w are in distinct maximal
1

A literal is either a variable a or a negated variable ā.

Analysis and Optimization of Graph Decompositions by Lifted Multicuts (Supplement)

components of Gx̃ . If so, x̃ is consistent, otherwise x̃ is
inconsistent.

existence and uniqueness of the maximum of X̃GG0 [x̃] by
construction via dom x̃0 = E 0 [x̃].

Now, suppose x̃ ∈ {0, 1, ∗}E satisfies (10). We show that,
similar to the first case, x̃ is consistent iff all inequalities (4)
and (5) are satisfied w.r.t. the graph (V, E 0 ∩ dom x̃). This
can be checked analogously to the first case.

0

Let x̃0 ∈ X̃GG0 [x̃] be maximally specific and suppose x̃0 ≤
x̃00 for some x̃00 ∈ X̃GG0 [x̃]. Then dom x̃00 = dom x̃0 ,
since XGG0 [x̃0 ] 6= XGG0 [x̃00 ] if dom x̃00 \ E 0 [x̃] 6= ∅. Thus,
x̃0 = x̃00 , which means x̃0 is maximal w.r.t. ≤ in X̃GG0 [x̃].

Necessity of this condition is clear. To show sufficiency,
assume this condition holds true. We construct some x ∈
XGG0 [x̃] as follows. For all e ∈ dom x̃, set xe := x̃e . For
all {v, w} = f ∈ E 0 \ E such that f ∈
/ dom x̃ and such
that there is a vw-path P in G with x̃e = 0 for all e ∈ P ,
set xf := 0. For all remaining edges e, set xe := 1. By
construction, x satisfies (4), (5) and (6).

Conversely, any maximal element x̃0 of X̃GG0 [x̃] w.r.t. ≤
must satisfy E 0 [x̃] ⊆ dom x̃0 , which means it is maximally
specific.

Proof of Theorem 2 To show that the maximal specificity
problem is NP-hard, we reduce 3- SAT to this problem: For
any given instance of 3- SAT we construct in polynomial
time a connected graph G = (V, E), a graph G0 = (V, E 0 )
with E ⊆ E 0 , and a partial characteristic function x̃ ∈
0
{0, 1, ∗}E as in the proof of Thm. 1, except that now, we
let st ∈
/ dom x̃.
We know that x̃ is consistent because 1 ∈ XGG0 [x̃]. We
show that x̃ is maximally specific iff the given instance of
3- SAT has a solution:
Firstly, every e ∈ E 0 \ (dom x̃ ∪ {st}) is undecided, by
the following argument: (i) There exists an x ∈ XGG0 [x̃]
with xe = 1, namely 1. (ii) There exists an x ∈ XGG0 [x̃]
0
with xe = 0, namely the x ∈ {0, 1}E with xe = 0 and
∀f ∈ E 0 \ {e} : xf = 1. To see that x ∈ XGG0 [x̃], observe
that e ∈ E and x̃−1 (0) = ∅. Thus, st is the only edge in
E 0 \ dom x̃ that is possibly decided. That is:
E 0 [x̃] ⊆ {st} ∪ dom x̃

(42)

Thus, x̃ is maximally specific iff x̃ is undecided. More
specifically, x̃ is maximally specific iff there exists an x ∈
XGG0 [x̃] with xst = 0, as we know of the existence of
1 ∈ XGG0 [x̃]. Thus, x̃ is maximally specific iff the given
instance of 3- SAT has a solution, by the arguments made in
the proof of Thm. 1.
Proof of Lemma 7 Observe that x̃ is maximally specific
iff clGG0 x̃ = x̃. Thus, Lemma 7 follows from Lemma 11.
Proof of Lemma 8 Reflexivity is obvious. Antisymmetry:
(x̃ ≤ x̃0 ∧ x̃0 ≤ x̃) ⇒ (dom x̃ = dom x̃0 ∧ ∀e ∈ dom x̃ :
x̃e = x̃0e ). Transitivity: Let x̃ ≤ x̃0 ≤ x̃00 . Then dom x̃ ⊆
dom x̃0 ⊆ dom x̃00 and ∀e ∈ dom x̃ : x̃e = x̃0e = x̃00e .
Proof of Lemma 9 We show first that x̃0 is maximal w.r.t.
≤ in X̃GG0 [x̃] iff it is maximally specific. This implies

Hence, the unique maximum x̃0 ∈ X̃GG0 [x̃] is obtained
as follows. For an arbitrary x ∈ XGG0 [x̃] define x̃0 via
x̃0e := xe for all decided edges e ∈ E 0 [x̃].
Proof of Theorem 3

Let us have x̃, x̃0 ∈ X̃GG0 .

• The implication XGG0 [x̃] = XGG0 [x̃0 ] ⇒ X̃GG0 [x̃] =
X̃GG0 [x̃0 ] : follows from the definition of X̃GG0 [x̃] in
Lemma 9.
• The implication X̃GG0 [x̃] = X̃GG0 [x̃0 ] ⇒ clGG0 x̃ =
clGG0 x̃0 follows from the definition of the closure of x̃
as the maximum of X̃GG0 [x̃].
• The implication clGG0 x̃ = clGG0 x̃0 ⇒ XGG0 [x̃] =
XGG0 [x̃0 ] follows from clGG0 x̃ = clGG0 x̃0 ∈
X̃GG0 [x̃].
Proof of Lemma 10 Let x ∈ XG and define y = clGG0 x.
Since dom x = E, it holds that E 0 [x] = E 0 , i.e. all edges
are decided. Therefore, y −1 (1) is a multicut of G0 and for
all {v, w} = f ∈ E 0 \ E it holds that yf = 0 iff there is a
vw-path P in G such that xe = 0 for all e ∈ P . By Lemma
5, this implies y −1 (1) = λGG0 (x−1 (1)).
Proof of Theorem 4 Computing closures is at least as
hard as deciding maximal specificity: To decide maximal
specificity of x̃ ∈ X̃GG0 , compute its closure clGG0 x̃. Then
x̃ is maximally specific iff dom x̃ = dom clGG0 x̃, i.e., if
x̃ = clGG0 x̃. By Theorem 2, this means computing closures
is NP-hard.
Proof of Lemma 11

Let x̃ ∈ X̃GG0 and ỹ = clGG0 x̃.

Suppose first that E = E 0 . We describe how to compute
ỹ efficiently. Obviously, we must set ỹe = x̃e for all e ∈
dom x̃. Furthermore, we must set ỹvw = 0 for all {v, w} ∈
E \ dom x̃ such that there is a vw-path P in G with x̃e = 0
for all e ∈ P . Moreover, we must set ỹvw = 1 for all
{v, w} ∈ E \ dom x̃ that satisfy
∃P ∈ vw-paths(G) ∃!e ∈ P :
x̃e = 1 ∧ ∀e0 ∈ P \ {e} : x̃e0 = 0 .

(43)

Analysis and Optimization of Graph Decompositions by Lifted Multicuts (Supplement)

Therefore, initialize a disjoint-set data structure with singleton sets V . Apply the union operation on all edges
e ∈ dom x̃ where x̃e = 0, i.e. contract all 0-labeled edges.
Then, set ỹe = 0 for all edges that connect nodes of the
same component. If there is an edge e0 between two components such that x̃e0 = 1, then for all edges e between those
components set ỹe = 1. The remaining edges are undecided
by x̃. In case we only want to decide maximal specificity,
we can stop upon finding the first edge e ∈ dom ỹ \ dom x̃.
Now suppose that E ⊆ dom x̃. In this case, all edges are
decided, because x̃|E ∈ XG . According to Lemma 10, the
closure ỹ corresponds to the lifting of x̃|E to G0 . Therefore,
to obtain ỹ, compute the decomposition of G associated to
x̃|E using, e.g., a disjoint-set data structure. Set ỹe = 0 if e
is an edge within a component. Set ỹe = 1 if e is an edge
between components.

D. Metrics
Proof of Theorem 5 Symmetry and non-negativity follow
directly from the definition, and so does dµE 0 (x, x) = 0 for
all x ∈ XGG00 . For any e ∈ E 0 , the form d1e on E 0 × E 0 is
a Hamming metric on words of length 1 from the alphabet
{0, 1}. Therefore, it satisfies the triangle inequality. Hence,
for any x, y, z ∈ XGG00 :
X
dµE 0 (x, z) =
µe d1e (x, z)
(44)
e∈E 0

≤

X

µe (d1e (x, y) + d1e (y, z))

(45)

X

µe d1e (x, y) +

e∈E 0

=

dµE 0 (x, y)

X

µe d1e (y, z)

+

z̃e
0
1
*
1
1
*
*

lhs
0
0
0
1
1
θ
θ

rhs
0
0
0
2θ
1
θ
θ

In Tab. 1, the left-hand side and right-hand side of (48) are
evaluated for all possible assignments of values to x̃e , ỹe , z̃e .
It is apparent form this table that (48) holds iff θ ≥ 0.5.
We now show that d˜θE 0 is a pseudo-metric on X̃GG0 . Symmetry and non-negativity are obvious from the definition.
For all x̃ ∈ X̃GG0 , we have d˜θE 0 (x̃, x̃) = 0. Since
d˜θE 0 (x̃, x̃0 ) = d˜θE 0 (clGG0 x̃, clGG0 x̃0 ) and clGG0 x̃ ∈ X̂GG0
for any x̃ ∈ X̃GG0 , the triangle inequality follows from the
fact that d˜θE 0 is a metric on X̂GG0 .
Finally, it holds that d˜θE 0 (x̃, x̃0 ) = 0 iff clGG0 x̃ = clGG0 x̃0 ,
which in turn is equivalent to X̃GG0 [x̃] = X̃GG0 [x̃0 ], by
Theorem 3. This proves property (24).

E. Polyhedral Optimization
The all-one vector 1 ∈ {0, 1}E is
0

(47)

For any e ∈ E, xe ∈ {0, 1}E such that xee = 0 and
xeE\{e} = 1 and xeFGG0 = 1 holds xe ∈ XGG0 .

0

0

Thus, dµE 0 is a pseudo-metric on XGG00 .
If E ⊆ E 0 , then G0 = G00 and thus, XGG00 = XGG0 ⊆
XG0 . For any two x, x0 ∈ XGG00 ⊆ XG0 , it holds that
dµE 0 (x, x0 ) = 0 iff d1e (x, x0 ) = 0 for all e ∈ E 0 , i.e. iff
x = x0 . Conversely, suppose there exists some e ∈ E \ E 0 .
Define x, x0 ∈ XGG00 via xe0 = x0e0 = 1 for all e0 ∈
E 00 \ {e} and xe = 1, x0e = 0. It holds that x 6= x0 but
dµE 0 (x, x0 ) = 0.
Proof of Theorem 6 We first prove that d˜θE 0 is a metric
on X̂GG0 . For any x̃ ∈ X̂GG0 , we have clGG0 x̃ = x̃. Thus,
for all x̃, x̃0 ∈ X̂GG0 , we have d˜θE 0 (x̃, x̃0 ) = dθE 0 (x̃, x̃0 ).
Therefore, positive definiteness and symmetry are obvious
from the definition of dθE 0 (x̃, x̃0 ). To establish the triangle
inequality for dθE 0 , we prove it for θd1e and any edge e ∈ E 0 .
Let x̃, ỹ, z̃ ∈ X̂GG0 and consider the inequality
θd1e (x̃, z̃) ≤ θd1e (x̃, ỹ) + θd1e (ỹ, z̃).

ỹe
0
1
*
*
1/0
0/*
1/*

(46)

e∈E 0

dµE 0 (y, z),

x̃e
0
1
*
0
0
0
1

Proof of Theorem 7
such that 1 ∈ XGG0 .

e∈E 0

=

Table 1. The left- and right-hand side of the inequality θd1e (x̃, z̃) ≤
θd1e (x̃, ỹ) + θd1e (ỹ, z̃) for all possible combinations of values
x̃e , ỹe , z̃e where x̃, ỹ, z̃ ∈ X̂GG0 . The right-hand side is always
greater or equal the left-hand side iff 0.5 ≤ θ.

(48)

For any f ∈ FGG0 , any f -feasible xf ∈ {0, 1}E is such
that xf ∈ XGG0 . Moreover, xf can be chosen such that
one shortest path connecting the two nodes in f is the only
component containing more than one node.
0

For any e ∈ E, let y e ∈ RE such that
y e = 1 − xe .

(49)
0

For any f ∈ F1 , choose an f -feasible xf and let y f ∈ RE
such that
X
y f = 1 − xf −
ye .
(50)
{e∈E|xfe =0}

For any n ∈ N such that n > 1 and any f ∈ Fn , choose an
0
f -feasible xf and let y f ∈ RE such that
X
X
0
y f = 1 − xf −
yf
−
y e . (51)
{f 0 ∈FGG0 |f 0 6=f ∧xff 0 =0}

{e∈E|xfe =0}

Analysis and Optimization of Graph Decompositions by Lifted Multicuts (Supplement)

Here, `(f 0 ) < `(f ) ≤ n, by definition of f -feasibility. Thus,
0
all y f are well-defined by induction (over n).
0

Observe that {y e | e ∈ E 0 } is the unit basis in RE .
Moreover, each of its elements is a linear combination of
{1 − xe | e ∈ E 0 } which is therefore linearly independent.
Thus, {1} ∪ {xe | e ∈ E 0 } is affine independent. It is also
a subset of XGG0 and, therefore, a subset of ΞGG0 . Thus,
dim ΞGG0 = |E 0 |.
Proof of Lemma 12 Let {v, w} = f ∈ FGG0 and let
d(v, w) the length of a shortest vw-path in G. Then,
d(v, w) > 1 because FGG0 ∩ E = ∅.
If d(v, w) = 2, there exists a u ∈ V such that {v, u} ∈ E
and {u, w} ∈ E. Moreover, {v, u} ∈
/ FGG0 and {u, w} ∈
/
FGG0 , as FGG0 ∩ E = ∅. Thus, f ∈ F1 .
If d(v, w) = m with m > 2, consider any shortest vwpath P in G. Moreover, let F 0 ⊆ FGG0 such that, for any
{v 0 , w0 } = f 0 ∈ FGG0 , f 0 ∈ F 0 iff v 0 ∈ P and w0 ∈ P and
f 0 6= f . If F 0 = ∅ then f ∈ F1 . Otherwise:
∀{v 0 , w0 } ∈ F 0 :

d(v 0 , w0 ) < m

(52)

and thus:
∀f 0 ∈ F 0 ∃nf 0 ∈ N :

f 0 ∈ Fnf 0

(53)

by induction (over m). Let
n = max
nf 0 .
0
0
f ∈F

(54)

Then, f ∈ Fn+1 .
Proof of Lemma 13 For any {v, w} = f ∈ FGG0 , let P
be a shortest vw-path in G and let
0
0
0
0
0
FGG
0 := {{v , w } ∈ FGG0 | v ∈ P ∧ w ∈ P }

(55)

00
0
FGG
0 := FGG0 \ FGG0 .

(56)

P that has e as a chord contains a subpath P 0 such that
P 0 ∪ {e} is a cycle. Thus, for any x ∈ S, the inequalities
(4) or (5) (for e ∈ E or e ∈ FGG0 , respectively) imply
the existence of some eP 0 ∈ P 0 such that xeP 0 = 1. Let
0
P denote the
S set of all such paths P . Apparently, the
collection P 0 ∈P {eP 0 } ∪ {e} is a v-w-separating set of
edges. Therefore, it contains some subset C that is a vw-cut.
This gives xf = 1 via the inequality of (6) corresponding
to C.
We turn to the proof of sufficiency. Assume there is no vw =
f ∈ FGG0 such that e connects a pair of v-w-cut-vertices in
G. The construction of an affine independent |E 0 |-elementsubset of S ⊂ XGG0 is analogous to the proof of Theorem
7. The assumption guarantees for any f ∈ FGG0 with f 6= e
the existence of an f -feasible x ∈ S such that there is a
vw-path P with xP = 0. In particular, the hierarchy on
FGG0 defined by the level function ` remains unchanged
(if e ∈ FGG0 , then `(e) ≥ `(f ) for all f ∈ FGG0 ). Hence,
dim Σ = |E 0 | − 1, which means Σ is a facet of ΞGG0 .
Proof of Theorem 9 Let S = {x ∈ XGG0 | xe = 0} and
put Σ = conv S.
Consider the case that e ∈ E. Let G[e] and G0[e] be the
graphs obtained from G and G0 , respectively, by contracting
the edge e. The lifted multicuts x−1 (1) for x ∈ S correspond bijectively to the multicuts of G0[e] lifted from G[e] .
This implies dim Σ = dim ΞG[e] G0[e] . The claim follows
from Theorem 7 and the fact that G0[e] has |E 0 | − 1 many
edges if and only if e is not contained in any triangle in G0 .
Now, suppose uv = e ∈ FGG0 . We show necessity of
Conditions (a)-(c) by proving that if any of them is violated,
then all x ∈ S satisfy some additional, orthogonal equality
and thus, dim Σ ≤ |E 0 | − 2.
First, assume that (a) is violated. Hence, there are edges
e0 , e00 ∈ E 0 such that T = {e, e0 , e00 } is a triangle in G0 .
Every x ∈ S satisfies the cycle inequalities

0

Moreover, let x ∈ {0, 1}E with xP = 0 and xE\P = 1 and
0
00
xFGG
= 0 and xFGG
= 1. P has no chord in E, because
0
0
it is a shortest path. Thus, x ∈ XGG0 .
Proof of Theorem 8 Let S = {x ∈ XGG0 | xe = 1} and
put Σ = conv S.
To show necessity, suppose there is some vw = f ∈ FGG0
such that e connects a pair of v-w-cut-vertices. Then, for
any vw-path P in G, either e ∈ P or e is a chord of P .
We claim that we have xf = 1 for any x ∈ S. This gives
dim Σ ≤ |E 0 | − 2, so the inequality xe ≤ 1 cannot define
a facet of ΞGG0 . If there are no vw-paths that have e as a
chord, then {e} is a vw-cut and the claim follows from the
corresponding inequality of (6). Otherwise, every vw-path

xe0 ≤ xe + xe00

(57)

xe00 ≤ xe + xe0

(58)

by Lemma 3 applied to the multicut x−1 (1) of G0 . Every
x ∈ S satisfies xe0 = xe00 , by (57) and (58) and xe = 0.
Next, assume that (b) is violated. Consider a violating pair
{u0 , v 0 } 6= {u, v}, u0 6= v 0 of u-v-cut-vertices. For every
x ∈ S, there exists a uv-path P in G with xP = 0, as
xe = 0. Any such path P has a sub-path P 0 from u0 to v 0
because u0 and v 0 are u-v-cut-vertices.
• If the distance of u0 and v 0 in G0 is 1, then u0 v 0 ∈ E 0 . If
u0 v 0 ∈ P , then xu0 v0 = 0 because xP = 0. Otherwise,

Analysis and Optimization of Graph Decompositions by Lifted Multicuts (Supplement)

xu0 v0 = 0 by xP 0 = 0 and the cycle/path inequality
X
xu0 v0 ≤
xê .
(59)
ê∈P 0

Thus xu0 v0 = 0 for all x ∈ S.

e00 ∈C1 \{e}

• If the distance of u0 and v 0 in G0 is 2, there is a u0 v 0 path in G0 consisting of two distinct edges e0 , e00 ∈ E 0 .
We show that all x ∈ S satisfy xe0 = xe00 :
– If e0 ∈ P and e00 ∈ P then xe0 = xe00 = 0
because xP = 0.
– If e0 ∈ P and e00 ∈
/ P then xe0 = xe00 = 0 by
xP = 0 and the cycle/path inequality
X
xe00 ≤
xê .
(60)
ê∈P 0 \{e0 }

– If e0 ∈
/ P and e00 ∈
/ P then xe0 = xe00 by xP = 0
and the cycle/path inequalities
X
xê
(61)
xe00 ≤ xe0 +
ê∈P 0

xe0 ≤ xe00 +

X

xê .

(62)

Now, assume that (c) is violated. Hence, there exists a uv-cut-vertex t and a u-v-separating set of vertices {s, s0 }
such that {ts, ts0 , ss0 } is a triangle in G0 . We have that all
x ∈ S satisfy xss0 = xts + xts0 as follows. At most one of
xts and xts0 is 1, because t is a u-v-cut-vertex and {s, s0 }
is u-v-separating as well. Moreover, xts + xts0 = 0 if and
only if xss0 = 0.
Proof of Theorem 10 Note that both C and P ∪ {f } are
cycles in G0 . We show that, for any chordal cycle C 0 of G0
and any e ∈ C 0 , the inequality
X
xe ≤
x e0
(63)
e0 ∈C 0 \{e}

is not facet-defining for ΞG0 . This implies that (63) cannot be facet-defining for ΞGG0 either, as ΞGG0 ⊆ ΞG0 and
dim ΞGG0 = dim ΞG0 . Hence, for facet-definingness of (4)
and (5), it is necessary that C and P ∪ {f } be chordless in
G0 .
0

0

For this purpose, consider some cycle C of G with a chord
uv = e0 ∈ E 0 . We may write C 0 = P1 ∪ P2 where P1 and
P2 are edge-disjoint uv-paths such that C1 = P1 ∪ {e0 } and
C2 = P2 ∪ {e0 } are cycles in G0 . Let e ∈ C 0 , then either
e ∈ P1 or e ∈ P2 . W.l.o.g. we may assume e ∈ P1 . The
inequalities
X
xe ≤
xe00 ,
(64)
e00 ∈C1 \{e}

X
e00 ∈C2 \{e0 }

xe00

e00 ∈C1 \{e,e0 }

X

≤

e00 ∈C1 \{e,e0 }

X

=

X

xe00 +

xe00

e00 ∈C2 \{e0 }

xe00 .

(66)

e00 ∈C 0 \{e}

Thus, (63) is not facet-defining for ΞG0 .
For the proof of sufficiency, suppose the cycle C of G is
chordless in G0 and let e ∈ C. Let Σ be a facet of ΞGG0
such that ΣGG0 (e, C) ⊆ Σ and suppose it is induced by the
inequality
X
ae0 xe0 ≤ α
(67)
e0 ∈E 0
0

ê∈P 0

x e0 ≤

are both valid for ΞG0 . Moreover, since e0 ∈ C1 , (64) and
(65) imply (63) via
X
X
xe ≤
xe00 =
xe00 + xe0

(65)

with a ∈ RE and α ∈ R, i.e., Σ = conv S, where

(
)
 X

S := x ∈ XGG0 
ae0 xe0 = α .
 0 0

(68)

e ∈E

For convenience, we also define the linear space

(
)
 X
E0 
L := x ∈ R 
a 0x 0 = α .
 0 0 e e

(69)

e ∈E

As 0 ∈ SGG0 (e, C) ⊆ S, we have α = 0. We show that
(67) is a scalar multiple of (4) and thus ΣGG0 (e, C) = Σ.
0

Let y ∈ {0, 1}E be defined by
yC = 0,

yE 0 \C = 1,

(70)

i.e. all edges except C are cut. Then y ∈ SGG0 (e, C) ⊆ S,
since C is chordless.
0

For any e0 ∈ C \ {e}, the vector x ∈ {0, 1}E with
xC\{e,e0 } = 0,

xE 0 \C∪{e,e0 } = 1

(71)

holds x ∈ SGG0 (e, C) ⊆ S. Therefore, y − x ∈ L. Thus,
∀e0 ∈ C \ {e} :

ae0 = −ae .

(72)

It remains to show that ae0 = 0 for all edges e0 ∈ E 0 \C. We
proceed by considering edges from E and FGG0 separately.
We consider the nodes u, v ∈ V such that uv = e0 . W.l.o.g.,
we assume that v does not belong to C. This is possible
because C does not have a chord in G0 .
Firstly, consider e0 ∈ E and distinguish the following cases:

Analysis and Optimization of Graph Decompositions by Lifted Multicuts (Supplement)

(i) If e0 connects two nodes not contained in C or it is the
only edge connecting some node in C to v, then for
0
x ∈ {0, 1}E , defined by
xC = 0,

xe0 = 0,

xE 0 \(C∪{e0 }) = 1,

(73)

it holds that x ∈ SGG0 (e, C) ⊆ S. Therefore, y − x ∈
L, which evaluates to ae0 = 0.
0
:= {{u0 , v} ∈ E 0 |
(ii) Otherwise, let EC,v
0
u belongs to C} denote the set of edges in E 0 that
connect v to some node in C. By assumption, we have
0
that |EC,v
| ≥ 2. Now, pick some direction on C and
traverse C from one endpoint of e to the other endpoint
0
of e. We may order the edges EC,v
= {e1 , . . . , ek }
such that the endpoint of ei appears before the endpoint
of ei+1 in the traversal of C. We show that aei = 0 for
all 1 ≤ i ≤ k:

e2

e00
e1

v

e000
e3

e1

e

(74)

it holds that x ∈ SGG0 (e, C) ⊆ S. Therefore, y − x ∈
L. Thus:
X
aei = 0.
(75)

v

e000
e3

e

Figure 2. The figure illustrates the argument from case (ii) in the
proof of Theorem 10 for the cycle C = {e, e00 , e000 }. In this
example, e3 = e0 , e1 ∈ FGG0 and e2 ∈ E. The left multicut is
chosen for i = 1 and the right one for i = 2.

by (72). If ei ∈ FGG0 , we similarly obtain
X
X
0=
aej − ae − ae00 =
aej . (85)
i+1≤j≤k

0

For the vector x ∈ {0, 1}E defined by

00

0 if e ∈ C
0
xe00 = 0 if e00 ∈ EC,v


1 else,

e2

e00

i+1≤j≤k

P
Together with (75), this yields 1≤j≤i aej = 0 as
well. Applying this argument repeatedly from i = 1 to
i = m − 1, we conclude that ae1 = . . . = aem−1 = 0.
0
By reversing the order of the edges in EC,v
, it can
be shown analogously that aek = aek−1 = . . . =
aem+1 = 0. Thus, by (75), ae0 = aem = 0.
Next, consider e0 ∈ FGG0 and distinguish the following
additional cases:

1≤i≤k
0

Consider the m ∈ {1, . . . , k} such that e = em . For
any i with 1 ≤ i ≤ m − 1, consider the following
construction that is illustrated also in Fig. 2: Let e00 ∈
C be some edge between the endpoints of ei and ei+1 .
0
If ei ∈ E, define x ∈ {0, 1}E via
xe = xe00 = 1

(76)

xC\{e,e00 } = 0

(77)

∀j ≤ i : xej = 0

(78)

∀j > i : xej = 1

(79)
0

If ei ∈ FGG0 , define x ∈ {0, 1}E via
xe = xe00 = 1

(80)

xC\{e,e00 } = 0

(81)
(82)

∀j > i : xej = 0

(83)

Either way, it holds that x ∈ SGG0 (e, C) ⊆ S and thus,
y − x ∈ L. If ei ∈ E, this yields
X
X
0=
aej − ae − ae00 =
aej
(84)
1≤j≤i

Then x ∈ SGG0 (e, C) ⊆ S and thus y − x ∈ L. This
gives
X
X
ae0 +
ae00 +
ae00 = 0.
(87)
e00 ∈P 0

∀j ≤ i : xej = 1

1≤j≤i

(iii) Suppose there is a uv-path P 0 in G that does not con0
tain any node from C. Define x ∈ {0, 1}E via

0 if e00 ∈ C



0 if e00 = e0
(86)
xe00 =
0 if e00 ∈ P 0 or e00 is a chord of P 0



1 else.

e00 chord
of P 0

We argue that all terms except ae0 vanish by induction
over the level function `(e0 ). If `(e0 ) = 1, then P 0
does not have any chords from FGG0 , thus ae0 = 0,
because ae00 = 0 for all e00 ∈ E as shown previously
in the cases (i) and (ii). If `(e0 ) > 1, then for any chord
e00 ∈ FGG0 of P 0 it holds that `(e00 ) < `(e0 ). The
induction hypothesis provides ae00 = 0 and hence we
conclude ae0 = 0.
(iv) Suppose u is contained in C. Pick a shortest uv-path
P 0 in G. We argue inductively over the length of P 0 ,

Analysis and Optimization of Graph Decompositions by Lifted Multicuts (Supplement)

which we denote by d(P 0 ). If d(P 0 ) = 1, then P 0
consists of only one edge from E. This situation is
in fact already covered by case (ii). If d(P 0 ) > 1,
then we employ an argument similar to (ii) as follows.
Let FC,v := {{u0 , v} ∈ FGG0 | u0 belongs to C} =
{f1 , . . . , fk } be the set of edges fi ∈ FGG0 that connect v to some node in C. Again, assume they are
ordered such that the endpoint of fi appears before the
endpoint of fi+1 on C in a traversal from e to itself.
0
For the vector x ∈ {0, 1}E defined by

0 if e00 ∈ C





0 if e00 ∈ P 0 or e00 is a chord of P 0



0 if e00 = u0 v 0 where u0 belongs to C,
xe00 =

v 0 6= v belongs to P 0





0 if e00 ∈ FC,v



1 else,
(88)
it holds that x ∈ SGG0 (e, C) ⊆ S and thus y − x ∈ L.
This yields
X
X
ae00 +
ae00
e00 chord
of P 0

e00 ∈P 0

+

X

ae00 +

e00 =u0 v 0 :
u0 belongs to C,
v 0 6=v belongs to P 0

X

ae00 = 0

(89)

e00 ∈FC,v

1≤i≤k

afi =

X

ae00 = 0,

(92)

i+1≤j≤k

Together with (90), we obtain
X
afi = 0.

(93)

1≤j≤i

Applying this argument repeatedly for i = 1 to i = m,
we conclude af1 = . . . = afm = 0. Similarly, we
obtain afk = afk−1 = . . . = afm = 0, by reversing
the direction of traversal of C and employing the same
reasoning.
(v) Finally, suppose neither u nor v belong to the cycle
C, but every uv-path in G shares at least one node
with C. Let P 0 be such a uv-path. Define the vector
0
x ∈ {0, 1}E by

00

0 if e ∈ C



0 if e00 = e0


0 if e00 ∈ P 0 or e00 is a chord of P 0
xe00 =

0 if e00 = u0 v 0 where u0 belongs to C,





v 0 belongs to P 0



1 else.
(94)
It holds that x ∈ SGG0 (e, C) ⊆ S and thus y − x ∈ L.
This gives
X
X
X
ae0 +
ae00 +
ae00 +
ae00 = 0.

and thus
X

(apply the induction hypothesis once more),
X
afj = 0.

(90)

e00 ∈FC,v

as all other terms vanish (apply the induction hypothesis to all u0 v 0 ∈ FGG0 where u0 belongs to C and
v 0 6= v belongs to P 0 ). Let m be the highest index
such that the endpoint of fm appears before the endpoint of P 0 on C. Now, for any i with 1 ≤ i ≤ m, pick
an edge e00 ∈ C between the endpoint of fi and the
endpoint of fi+1 and before the endpoint of P 0 on C.
0
Define x ∈ {0, 1}E by

0 if g ∈ C \ {e, e00 }





0 if g ∈ P 0 or g is a chord of P 0



0 0


0 if g = u v where
0
xg =
u appears before endpoint of P 0 on C,



v 0 6= v belongs to P 0





0 if g = fj ∀j > i



1 else.
(91)
Then, it holds that x ∈ SGG0 (e, C) ⊆ S and thus
y − x ∈ L. This yields, after removing all zero terms

e00 ∈P 0

e00 chord
of P 0

e00 =u0 v 0 :
u0 belongs to C,
v 0 belongs to P 0

(95)
We argue inductively over the level function `(e0 ). If
`(e0 ) = 1, then P 0 does not have any chords and our
consideration in cases (i)–(iv) yield that all terms except ae0 vanish. If `(e0 ) > 1, then we additionally
employ the induction hypothesis to achieve the same
result. Hence, it holds that ae0 = 0 as well.
The proof of sufficiency in the second assertion is completely analogous (replace C by P ∪ {f } and e by f ). The
chosen multicuts remain valid, because e = f is the only
edge in the cycle that is not contained in E.
Proposition 1 For every connected graph G = (V, E), every graph G0 = (V, E 0 ) with E ⊆ E 0 , every vw ∈ FGG0
and every C ∈ vw-cuts(G), the following holds:
(a) Every x ∈ SGG0 (vw, C) defines a decomposition of
G into (vw, C)-connected components. That is, every
maximal component of the graph (V, {e ∈ E|xe = 0})
is (vw, C)-connected. At most one of these is properly
(vw, C)-connected. It exists iff xvw = 0.

Analysis and Optimization of Graph Decompositions by Lifted Multicuts (Supplement)

(b) For every (vw, C)-connected component (V ∗ , E ∗ ) of
0
G, the x ∈ {0, 1}E such that ∀rs ∈ E 0 (xrs = 0 ⇔
r ∈ V ∗ ∧ s ∈ V ∗ ) is such that x ∈ SGG0 (vw, C).

• Otherwise, there exists an e ∈ P such that e ∈
/ E∗.
Therefore, xe = 1, by (100). Thus, (5) holds, as the
r.h.s. is at least 1.

Proof of Proposition 1 a) Let x ∈ SGG0 (vw, C) arbitrary.
Let E0 := {e ∈ E|xe = 0} and let G0 := (V, E0 ).

For any st ∈ FGG0 and any C 0 ∈ st-cuts(G), distinguish
two cases:

If xvw = 1 then ∀e ∈ C : xe = 1, by (35). Thus, every
component of G0 is improperly (vw, C)-connected.
If xvw = 0 then
∃e ∈ C(xe = 0 ∧ ∀e0 ∈ C \ {e}(xe0 = 1))

(96)

by (35). Let (V ∗ , E ∗ ) the maximal component of G0 with
e ∈ E∗ .

(98)

by (96) and definition of G0 . There does not exist a C 0 ∈
vw-cuts(G) with xC 0 = 1, because this would imply xvw =
1, by (6). Thus, there exists a P ∈ vw-paths(G) with
xP = 0, as G is connected. Any such path P has e ∈ P , as
P ∩ C 6= ∅ and C ∩ E0 = {e} and P ⊆ E0 . Thus:
v ∈V∗∧w ∈V∗
∗

• Otherwise, there exists an e ∈ C 0 such that e ∈ E ∗ .
Therefore, xe = 0, by (100). Thus, (6) holds, as the
r.h.s. is at least 1.

(97)

Clearly:
∀e0 ∈ C \ {e} : e0 ∈
/ E∗

• If C 0 ∩ E ∗ = ∅ then s ∈
/ V∗ ∨t ∈
/ V ∗ . Therefore,
xst = 1, by definition of x. Moreover, xC 0 = 1, by
(100). Thus, (6) evaluates to 0 = 0.

(99)

∗

by (97). (V , E ) is properly (vw, C)-connected, by (97),
(98) and (99). Any other component of G0 does not cross
the cut, by (96), (97) and definition of G0 , and is thus improperly (vw, C)-connected.

Proof of Theorem 11 Assume that C1 does not hold (as in
Fig. 4a). Then, there exists an e ∈ C such that no (vw, C)connected component of G contains e. Thus, for all x ∈
SGG0 (vw, C):
xe = 1

(101)

by Proposition 1. Now, dim ΣGG0 (vw, C) ≤ |E 0 | − 2, by
(35) and (101). Thus, ΣGG0 (vw, C) is not a facet of ΞGG0 ,
by Theorem 7.
Assume that C2 does not hold. Then, for any e ∈ C there
exists some number m such that for all (vw, C)-connected
components (V ∗ , E ∗ ) with e ∈ E ∗ it holds that |F ∩FV ∗ | =
m. Thus, we can write
C=

b) We have

|F |
[

C(F, m),

(102)

m=0

∀st ∈ E : xst = 0 ⇔ st ∈ E ∗

(100)

by the following argument:
• If st ∈ E ∗ , then s ∈ V ∗ ∧ t ∈ V ∗ , as (V ∗ , E ∗ ) is a
graph. Thus, xst = 0, by definition of x.
• If st ∈
/ E ∗ then s ∈
/ V∗ ∨t ∈
/ V ∗ , as (V ∗ , E ∗ ) is a
component of G. Thus, xst = 1, by definition of x.
Consider the decomposition of G into (V ∗ , E ∗ ) and singleton components. E1 := {e ∈ E|xe = 1} is the set of edges
that straddle distinct components of this decomposition, by
(100). Therefore, E1 is a multicut of G, by Lemma 2. Thus,
(4) holds, by Lemma 3.
For any st ∈ FGG0 and any P ∈ st-paths(G), distinguish
two cases:
• If P ⊆ E ∗ , then s ∈ V ∗ ∧ t ∈ V ∗ , as (V ∗ , E ∗ ) is a
graph. Thus, xst = 0, by definition of x. Moreover,
xP = 0, by (100). Hence, (5) evaluates to 0 = 0.


∗
where C(F, m) := e ∈ C | |F ∩
	 FV | = m ∀ (vw, C)∗
∗
∗
connected (V , E ) with e ∈ E . It follows that for all
x ∈ SGG0 (vw, C) we have the equality
|F |
X
m=0

m

X

(1 − xe ) =

e∈C(F,m)

X

(1 − xf 0 )

(103)

f 0 ∈F

by the following argument:
• If xe = 1 for all e ∈ C, then xf 0 = 1 for all
v 0 w0 = f 0 ∈ F , since C is also a v 0 w0 -cut. Thus,
(103) evaluates to 0 = 0.
• Otherwise there exists precisely one edge e ∈ C such
that xe = 0. Let m be such that e ∈ C(F, m). By
definition of C(F, m), there are exactly m edges f 0 ∈
F with xf 0 = 0. Thus, (103) evaluates to m = m.
Assume that condition C3 does not hold. Then there exists
an f 0 ∈ FGG0 (vw, C), a set ∅ 6= F ⊆ FGG0 (vw, C) and

Analysis and Optimization of Graph Decompositions by Lifted Multicuts (Supplement)

a)
v 0 = v1

b)
e1
e2

v3
v5

v0

v2

e3
e4

e0

e1

v4

v2

e5

e2

v1
e3
v3

v6 = w 0

V0

• If xvw = 1, then xEP = 1, by (35) and (6). Thus,
(108) evaluates to 1 = 1, by (109).

V0

Figure 3. Depicted are the nodes (in black) and edges (in green)
on a path (a) and on a cycle (b), respectively. Nodes in the set
V 0 are are either in V ∗ (filled circle) or not in V ∗ (open circle).
Consequently, pairs of consecutive edges are either cut (dotted
lines) or not cut (solid lines).

• If xvw = 0, the decomposition of G defined by x contains precisely one properly (vw, C)-connected component (V ∗ , E ∗ ) of G, by Proposition 1. Without loss
of generality, (106) holds. Otherwise, that is, if (107)
holds, exchange v and w.
Consider the nodes VP as depicted in Fig. 3a: v1 =
v 0 ∈ V ∗ , by (106). For every even j, vj ∈ V (w, C),
by definition of P . Thus:
∀j ∈ {1, . . . , (|EP | + 1)/2} : v2j ∈ V ∗

(110)

by (106).
some k ∈ N such that for all (vw, C) connected components
(V ∗ , E ∗ ) and (V ∗∗ , E ∗∗ ) with f 0 ∈ FV ∗ and f 0 ∈
/ FV ∗∗ it
holds that

Consider the edges EP as depicted in Fig. 3a: e1 =
v1 v2 ∈ E ∗ , as v1 ∈ V ∗ and v2 ∈ V ∗ and as (V ∗ , E ∗ )
is a component of G. Thus,

|F ∩ FV ∗ | = k and |F ∩ FV ∗∗ | = 0.

x e1 = 0

(104)

In other words, for all x ∈ SGG0 (vw, C) it holds that xf 0 =
0 iff there are exactly k edges f 00 ∈ F such that xf 00 = 0.
Similarly, it holds that xf 0 = 1 iff for all f 00 ∈ F we
have xf 00 = 1. Therefore, all x ∈ SGG0 (vw, C) satisfy the
additional equality
X
k(1 − xf 0 ) =
1 − xf 00 .
(105)

by Proposition 1. For every j ∈ {1, . . . , (|EP |−1)/2},
distinguish two cases:
– If v2j+1 ∈ V ∗ , then e2j = v2j v2j+1 ∈ E ∗ and
e2j+1 = v2j+1 v2j+2 ∈ E ∗ , because v2j ∈ V ∗
and v2j+2 ∈ V ∗ , by (110), and because (V ∗ , E ∗ )
is a component of G. Thus:
xe2j = 0 ∧ xe2j+1 = 0 .

f 00 ∈F

Assume that C4 does not hold. Then, there exist v 0 ∈
V (v, C) and w0 ∈ V (w, C) and a v 0 w0 -path P = (VP , EP )
in G0 (vw, C) such that every properly (vw, C)-connected
component (V ∗ , E ∗ ) of G holds:

∨

(v 0 ∈ V ∗ ∧ V (w, C) ∩ VP ⊆ V ∗ )

(106)

(w0 ∈ V ∗ ∧ V (v, C) ∩ VP ⊆ V ∗ ) .

(107)

Let v1 < · · · < v|VP | the linear order of the nodes VP and
let e1 < · · · < e|EP | the linear order of the edges EP in the
v 0 w0 -path P . Now, for all x ∈ SGG0 (vw, C):
xvw =

|EP |

X

(−1)j+1 xej

(108)

j=1

by the following argument: |EP | is odd, as the path P
alternates between the set V (v, C) where it begins and the
set V (w, C) where it ends. Thus,
|EP |

(|EP |−1)/2

j=1

j=1

X

(−1)j+1 xej = xe1 −

Distinguish two cases:

X
(xe2j − xe2j+1 ) .

(109)

(111)

(112)

– If v2j+1 ∈
/ V ∗ , then e2j = v2j v2j+1 and e2j+1 =
v2j+1 v2j+2 straddle distinct components of the
decomposition of G defined by x, because v2j ∈
V ∗ and v2j+2 ∈ V ∗ , by (110). Thus:
xe2j = 1 ∧ xe2j+1 = 1 .

(113)

In any case:
∀j ∈ {1, . . . , (|EP | − 1)/2} : xe2j − xe2j+1 = 0 .
(114)
Thus, (108) evaluates to 0 = 0, by (109), (111), (114).
Assume that C5 does not hold. Then, there exists a cycle Y = (VY , EY ) in G0 (vw, C) such that every properly
(vw, C)-connected component (V ∗ , E ∗ ) of G holds:

∨

VY ∩ V (v, C) ⊆ V ∗

(115)

VY ∩ V (w, C) ⊆ V ∗ .

(116)

Let v0 < · · · < v|VY |−1 an order on VY such that v0 ∈
V (v, C) and, for all j ∈ {0, . . . , |EY | − 1}:
ej := {vj , vj+1 mod |EY | } ∈ EY .

(117)

Analysis and Optimization of Graph Decompositions by Lifted Multicuts (Supplement)

Now, for all x ∈ SGG0 (vw, C):
|EY |−1

X

0=

(−1)j xej

(118)

j=0

by the following argument: |EY | is even, as the cycle Y
alternates between the sets V (v, C) and V (w, C). Thus,
|EY |−1

X

j

(|EY |−2)/2

(−1) xej =

j=0

X
(xe2j − xe2j+1 ) .

(119)

j=0

Distinguish two cases:
• If xvw = 1, then xEY = 1, by (35) and (6). Thus,
(118) evaluates to 0 = 0, by (119).
• If xvw = 0, the decomposition of G defined by x contains precisely one properly (vw, C)-connected component (V ∗ , E ∗ ) of G, by Proposition 1. Without loss
of generality, (115) holds. Otherwise, that is, if (116)
holds, exchange v and w.
Consider the nodes VY as depicted in Fig. 3b: For
every even j, vj ∈ V (v, C), by definition of Y and the
order. Thus:
∀j ∈ {0, . . . , (|EY | − 2)/2} : v2j ∈ V ∗

(120)

by (115).
Consider the edges EY as depicted in Fig. 3b: For every j ∈ {0, . . . , (|EY | − 2)/2}, distinguish two cases:
– If v2j+1 ∈ V ∗ , then e2j = v2j v2j+1 ∈ E ∗ and
e2j+1 = v2j+1 v2j+2 mod |EY | ∈ E ∗ , because
v2j ∈ V ∗ and v2j+2 mod |EY | ∈ V ∗ , by (120),
and because (V ∗ , E ∗ ) is a component of G. Thus:
xe2j = 0 ∧ xe2j+1 = 0 .

(121)

– If v2j+1 ∈
/ V ∗ , then e2j = v2j v2j+1 and
e2j+1 = v2j+1 v2j+2 mod |EY | straddle distinct
components of the decomposition of G defined by
x, because v2j ∈ V ∗ and v2j+2 mod |EY | ∈ V ∗ ,
by (120). Thus:
xe2j = 1 ∧ xe2j+1 = 1 .

(122)

In any case:
∀j ∈ {0, . . . , (|EY | − 2)/2} : xe2j − xe2j+1 = 0 .
(123)
Thus, (118) evaluates to 0 = 0, by (119) and (123).

Acknowledgements
The examples depicted in Fig. 4h and 4j were proposed by
Banafsheh Grochulla and Ashkan Mokarian, respectively.

Analysis and Optimization of Graph Decompositions by Lifted Multicuts (Supplement)

a)

b)

c)

e0

v

d)

f

f
r

v

w

f

e

v

w=s

e
e)

f

f
f

0

r

s

0

v

f)

v

w

e1

w

e0

f0

e0

g)
f0

f0
f 00

f1

v

f

f1

w

f2

f

v

f

w

f2

w
h)

i)

j)

f
f3
f2

v0

v

f

f1

w0

w

f

e

v = v0
f1

f2
v

f0

f1
f3

f4

w

f2
w = w0
k)

f

e

v
f3

f1
f2
w

Figure 4. Depicted above are graphs G = (V, E) (in black) and G0 = (V, E 0 ) with E ⊆ E 0 (E 0 in green), distinct nodes v, w ∈ V and
a vw-cut C of G (as dotted lines). In any of the above examples, one condition of Theorem 11 is violated and thus, ΣGG0 (vw, C) is
not a facet of the lifted multicut polytope ΞGG0 . a) Condition C1 is violated for e. b) Condition C2 is violated as r and s are connected
in any (vw, C)-connected component. c) Condition C2 is violated as r and s are not connected in any (vw, C)-connected component.
d) Condition C2 is violated. Specifically, C({f 0 }, 1) = {e0 } and C({f 0 }, 0) = {e1 } in the proof of Theorem 11. e) Condition C2 is
violated for F = {f1 , f2 }. f) Condition C3 is violated. g) Condition C3 is violated for F = {f1 , f2 } and k = 1. h) Condition C4 is
violated for the v 0 w0 -path f1 f2 f3 . i) Condition C4 is violated for the v 0 w0 -path ef1 f2 . j) Condition C5 is violated for the cycle f1 f2 f3 f4 .
k) Condition C5 is violated for the cycle ef1 f2 f3 .

