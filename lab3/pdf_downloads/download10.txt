Connected Subgraph Detection with Mirror Descent on SDPs

Appendix
Comparison between constraint (4) and other
measures of connectivity
To form a better understanding of how conductance arises
in this context, consider a (dual) flow formulation of connectedness: S 2 ⇤r if, for any i 2 S, there exists a way to
route one unit of flow from the root r to i with finite congestion. This can be strengthened by requiring that 1 unit of
flow be routed from r to i with congestion k1 , yielding the
notion of k-edge connectivity. Finally, we can strengthen
the flow requirement further, by demanding that (1) di units
of flow be routed from r to i, and (2) the flows from r to
all vertices i 2 S be routed concurrently with congestion
1
. The maxflow-mincut theorem shows that such a flow
routing exists if and only if the condition of (4) holds.
While the notions of connectivity and conductance converge to connectedness in the limit as goes to 0, they
display different behaviors for larger . In particular, conductance appears to be a more meaningful in the context of
anomaly detection scenarios, where the anomalous set may
be constructed by an unspecified diffusion process, such as
the epidemic in the example of disease outbreak detection,
which is unlikely to cross low-conductance cuts. Moreover,
for noisy input graphs, conductance is a more robust notion
than edge connectivity.
Proof of Theorem 3.2
Proof. We prove the contrapositive. Given a vector x such
that
2

x> LStar(r) x,
S
2
we produce a cut T ✓ S, r 2
/ T , with GS (T ) < . To do
so, consider the embedding y 2 Rn given by yi = |xi xr |.
Then, it is easy to check that:
x > L GS x <

y > L GS y  x > L GS x <

2

2
2

=

2

x> LStar(r) x
S

X

di yi2 .

i2S\{r}

By Lemma 3.1, a sweep cut of y yields a cut T such that
GS (T ) < . Moreover, because yr = 0, r does not belong to T .
Proof of Theorem 3.3 and an alternative formulation
using effective resistance
In this section we offer an alternative approach to obtain the
inequality constraint (9) through electrical networks and
the concept of effective resistance. Using this formulation,
we then prove Theorem 3.3 that shows that the inequality
constraint enforces connected through a simple rounding of
M.

We shortly introduce the concept of effective resistance in
the electrical network interpretation of graphs. In contrast
to s-t flow that interprets edge weights on a graph as flow
capacities, electrical flow considers edge weights wij as
the conductance (inverse resistance) r1ij between two nodes
i, j.
Define
of a Laplacian L+ =
Pn 1 the > pseudoinverse P
n
>
i=2 i vi vi where L =
i=2 i vi vi is its eigendecomposition, and we note that the minimum eigenvalue 1
corresponding to all 1 eigenvector is zero. Also note that
LG[M ] denotes the Laplacian of the subgraph with adjacency matrix A M ( is the elementwise/Hadamard matrix product)2 and let L+
G[M ] denote its pseudoinverse.
Defining a vector of directional current flows into/out of
nodes with f (e.g. where positive elements are currents
into the node and vice versa), the relationship between the
vector of voltages v and f in an electrical circuit graph
with resistances rij are given by the relation v = L+ f .
This fact follows from Kirchoff’s current and voltage laws
(Vishnoi, 2012). The effective resistance Rab between any
two nodes a, b is then defined by the voltage difference
va vb = v > (ea eb ) when unit current is flowing between
two nodes such that f = ea eb (or equivalently, inverse
of the current flow with unit voltage difference between a
and b). We then have the identity Rab = (ea eb )> v =
(ea eb )> L+ (ea eb ).
Given a root/anchor node r 2 V that is assumed to be contained in the subgraph S, consider the case where a current flow of di Mii is present between r and i 2 V on
the induced graph with Laplacian LG[M ] . Letting mi =
di Mii (er
ei ), the voltage vector v i corresponding to
these inputs is given by v i = L+
G[M ] mi . We then obtain the resistance between nodes r and i for input current
di Mii with the identity vri vii = (er ei )L+
G[M ] mi =
1
> +
di Mii mi LG[M ] mi , which we intend to be finite for i 2 S
(and thus Mii > 0) if GS is connected. For a conductance
threshold ⌧ , we would thus like to impose the constraint
+
m>
i LG[M ] mi 

di Mii
,
⌧

(12)

for all i 2 V , where the scaling with Mii serves to restrict
the constraint to only the nodes i 2 S. We also remark that
the constraint (12) is independent of uniform multiplicative
scaling of M , thus constraining M to unit trace does not
affect the choice of ⌧ .
We next unify the n different resistance constraints to a single PSD constraint. Define the 2n ⇥ 2n matrix AM as
✓
◆
LG[M ]
LStar(r) [M ]
AM =
,
LStar(r) [M ] ⌧1 LStar(r) [M ]
2
Corresponding to the original graph with edge weights scaled
by Mij .

Connected Subgraph Detection with Mirror Descent on SDPs

for which we define our connectivity constraint to be
AM ⌫ 0. For i 6= r consider the submatrix Ai formed by
the top-left n ⇥ n submatrix (i.e. LG[M ] ) and the (n + i)-th
row and column, which results in

Ai =

✓

LG[M ]
mi

m>
i
di Mii
⌧

◆

P

j6=r

Mjj

⌧

Proof.
Notice
that:
· rY f (Y (t) )
⇣
⌘
2
LG[M ]
=
2 · LStar(r) [M ] . Because In · M
we have:
2

.

Since AM ⌫ 0 it implies that any such submatrix satisfies
Ai ⌫ 0 and through the Schur complement condition that
is equivalent to condition (12). We have thus shown that
the condition AM ⌫ 0 encapsulates the pairwise effective
resistance constraints of the form (12). We note that we
obtain a similarPcondition for the root node, where with
currents mr , j6=r mj applied to the nodes and a convex
+
combination of voltage differences, m>
r LG[M ] mr is being
compared to

Proof of Lemma 4.1

.

Finally, we can again utilize the Schur complement condition for positive semidefiniteness and simplify the PSD
condition AM ⌫ 0 on the 2n ⇥ 2n matrix to a PSD condition on an n ⇥ n matrix, which directly leads to inequality
2
(9) when we replace ⌧ with 2 .
Now we prove Theorem 3.3 using the above reformulation
of (9). Assume there exists i 2 Ŝ such that there exists
no path between r and i, i.e., the subgraph GŜ is disconnected. Since Q (M ) ⌫ 0, it follows that AM ⌫ 0 and
2
thus Ai ⌫ 0 for ⌧ = 2 . Through the Schur complement lemma and (12) we have that vri vii  ⌧1 , i.e., that
the voltage difference between nodes r and i is finite when
a current flow of di Mii is applied that is non-zero (since
Mii > 0). This voltage difference is computed for the
graph G with edge weights given by Mij . It is easy to
see that if this voltage difference is finite, the voltage difference in the original graph G is also finite since Mij are
bounded. However a contradiction arises because there exists no path between i and r in G and thus the effective
resistance Rri = (er ei )> L+ (er ei ) is infinite.
Proof of Theorem 3.4
Proof. Consider an optimal solution M of arbitrary rank.
Construct
a tentative rank-1 solution m by taking mi =
p
M
.
Notice
that, because M ⌫ 0, we P
must have Mij 
ii
p
Mii Mjj = mi mj . Then: C ·mm> = i,j Cij mi mj
C ·M, by the non-negativity of C. Moreover, Q (mm> ) ⌫
Q (M ) as the weights of G[mm> ] are larger than the
weights of G[M ]. The theorem follows as mmT is a feasible rank-1 solution of value at least as large as the optimal.

2

·D

2

· LStar(r)

· rY f (Y (t) )

It follows that:
kD

1/2

rY f (Y (t) )D

1/2

k

2

LG

=
1,

2D

