Robust Probabilistic Modeling with Bayesian Data Reweighting

A. Localized generalized linear model as an RPM
Localization in generalized linear models (GLMs) is equivalent to reweighting, with constraints on the weight function w. /
induced by pw . We prelude the theorem with a simple illustration in linear regression.
Consider N iid observations f.xn ; yn /gN
1 . We regress y against x:

where xN D

PN

nD1

i id

yn D ˇ1 .xn

x/
N C ˇ0 C ✏n ; ✏n ⇠ N.0;

2

/;

xn . The maximum likelihood estimate of .ˇ0 ; ˇ1 / is

The localized model is

.b̌0 ; b̌1 / D argminˇ0 ;ˇ1
yn D ˇ1n ⇥ .xn

N
X

.yn

x/
N

ˇ1 .xn

nD1

i id

x/
N C ˇ0 C ✏n ; ˇ1n ⇠ N.ˇ1 ;

2

ˇ0 /2 :

i id

2

/; ✏n ⇠ N.0;

/;

where fˇ1n gN
? f✏n gN
nD1 ?
nD1 . Marginalizing out ˇ1n ’s gives
yn D ˇ1 ⇥ .xn

x/
N C ˇ0 C

n; n

i id

⇠ N.0; .xn

x/
N 2

2

C

2

/:

The maximum likelihood estimate of .ˇ0 ; ˇ1 / in the localized model thus becomes
.b̌0 ; b̌1 / D argminˇ0 ;ˇ1

N
X
.yn ˇ1 .xn
.xn x/
N 2
nD1

x/
N
ˇ0 / 2
:
2C 2

This is equivalent to the reweighting approach with

wn D

.xn

1
x/
N 2

2

C

2

:

We generalize this argument into generalized linear models.
Theorem 3 Localization in a GLM with identity link infers ˇ1 from
✓
◆
yn ⌘n b1 .⌘n /
yn j xn ; ˇ1n ; ˇ0 ⇠ exp
C c1 .yn ; / ;
a1 . /
⌘n D ˇ0 C ˇ1n .xn x/;
N
✓
◆
ˇ1n ˇ1 b2 .ˇ1 /
ˇ1n j ˇ1 ⇠ exp
C c2 .ˇ1n ; ⌫/ ;
a2 .⌫/
where a1 . /; a2 . / denote dispersion constants, b1 . /; b2 . / denote normalizing constants, and c1 . /; c2 . / denote carrier
densities of exponential family distributions.
Inferring ˇ1 from this localized GLM is equivalent to inferring ˇ1 from the reweighted model with weights
"
!#
.yn E.yn j ˇ0 C ˇQ1n .xn x///.ˇ
N
ˇ1 /.xn x/
N
1n
wn D Ep.ˇ1n jˇ1 / exp
a1 . /
for some fˇQ1n gN
1 .
Proof A classical GLM with an identity link is
yn ⇠ exp

✓

◆
yn ⌘n b1 .⌘n /
C c1 .yn ; / ;
a1 . /

Robust Probabilistic Modeling with Bayesian Data Reweighting

whose maximum likelihood estimate calculates

where
Lc;n D exp

✓

⌘n D ˇ0 C ˇ1 .xn

.b̌0 ; b̌1 / D argmaxˇ0 ;ˇ1
yn .ˇ0 C ˇ1 .xn

x/;
N
N
Y

Lc;n ;

nD1

x//
N
b1 .ˇ0 C ˇ1 .xn
a1 . /

x//
N

◆
C c1 .yn ; / :

On the other hand, the maximum likelihood estimate of the localized model calculates

where
Ll;n D

Z

exp

✓

.b̌0 ; b̌1 / D argmaxˇ0 ;ˇ1
yn .ˇ0 C ˇ1n .xn

N
Y

Ll;n ;

nD1

x//
N
b1 .ˇ0 C ˇ1n .xn x//
N
C c1 .yn ; /
a1 . /
◆
ˇ1n ˇ1 b2 .ˇ1 /
C
C c2 .ˇ1n ; ⌫/ dˇ1n :
a2 .⌫/

A localized GLM is thus reweighting the likelihood term of each observation by
✓
Z
Ll;n
yn .ˇ1n ˇ1 /.xn x/
N
b1 .ˇ0 C ˇ1n .xn x//
N C b1 .ˇ0 C ˇ1 .xn x//
N
D exp
Lc;n
a1 . /
◆
ˇ1n ˇ1 b2 .ˇ1 /
C
C c2 .ˇ1n ; ⌫/ dˇ1n
a2 .⌫/
Z
yn .ˇ1n ˇ1 /.xn x/
N
b10 .ˇ0 C ˇQ1n .xn x//.ˇ
N
ˇ1 /.xn x/
N
1n
D exp
a1 . /
◆
ˇ1n ˇ1 b2 .ˇ1 /
C
C c2 .ˇ1n ; ⌫/ dˇ1n
a2 .⌫/
Z
.yn b10 .ˇ0 C ˇQ1n .xn x///.ˇ
N
ˇ1 /.xn x/
N
ˇ1n ˇ1 b2 .ˇ1 /
1n
D exp
C
a1 . /
a2 .⌫/
Cc2 .ˇ1n ; ⌫// dˇ1n
DEp.ˇ1n jˇ1 / exp

.yn

E.yn j ˇ0 C ˇQ1n .xn x///.ˇ
N
1n
a1 . /

ˇ1 /.xn

x/
N

!

where ˇQ1n is some value between ˇ1 and ˇ1n and the second equality is due to mean value theorem. The last equality is due
to yn residing in the exponential family.
⌅

Robust Probabilistic Modeling with Bayesian Data Reweighting

B. Proof sketch of theorem 1
i id
Denote as `.y j ˇ W ˇ 2 ‚/ the statistical model we fit to the data set y1 ; :::; yN ⇠ PNN . `. jˇ/ is a density function with
respect to some carrier measure ⌫.dy/; and ‚ is the parameter space of ˇ.

Denote the desired true value of ˇ as ˇ0 . Let p0 .dˇ/ be the prior measure absolute continuous in a neighborhood of ˇ0
with a continuous density at ˇ0 . Let pw .dw/ be the prior measure on weights .wn /N
nD1 . Finally, let the posterior mean of ˇ
N
N
under the weighted and unweighted model be ˇw and ˇu and the corresponding maximum likelihood estimate (MLE) be
b̌w and b̌u respectively.
Let us start with some assumptions.

Assumption 1 `. jˇ/ is twice-differentiable and log-concave.
Assumption 2 There exist an increasing function w. / W R ! RC such that wn D w.log `.yn jˇ// solves
@
pw ..wn /N
nD1 / C log `.yn jˇ/ D 0; n D 1; :::; N:
@wn
We can immediately see that the bank of Beta.˛; ˇ/ priors with ˛ > 1 and the bank of Gamma.k; ✓/ priors with k > 1
satisfy this condition.
Assumption 3 P .j log `.yn j b̌w /

log `.yn j ˇ0 /j < ✏/ > 1

ı1 holds 8n for some ✏; ı1 > 0.

This assumption includes the following two cases: (1) b̌w is close to the true parameter ˇ0 , i.e. the corruption is not at all
influential in parameter estimation, and (2) deviant points in y1 ; :::; yN are far enough from typical observations coming
from `.y j ˇ0 / that log `.yn j b̌w / and log `.yn j ˇ0 / almost coincide. This assumption precisely explains why the RPM
performs well in Section 3.
Assumption 4 jb̌u

ˇ0 j

M for some M .

Assumption 5 There exist a permutation ⇡.i / W f1; :::; N g ! f1; :::; N g s.t.
k
X

k
log `.y⇡.i / jˇQn /00
4✏ X
/
; k D 1; :::; n
PN
M nD1 nD1 log `.y⇡.i / jˇLn /00

log `.y⇡.i / jˇ0 /0
 .1
PN
0
nD1 log `.y⇡.i / jˇ0 /
nD1

P.

for ˇQn and ˇLn between b̌u and ˇ0 and for some ı2 > 0.
By noticing that

PN

log `.yn jˇ0 /0
nD1 PN log `.y jˇ /0
n 0
nD1

D 1,

PN

log `.yn jˇQn /00
nD1 PN log `.y jˇL /00 .1
n n
nD1

4✏
/
M

1/

1

ı2 ;

⇡ 1, and Var.log `.yn jˇ/0 / >>

Var.log `.yn jˇ/00 / in general, this assumption is not particularly restrictive. For instance, a normal likelihood has
Var.log `.yn jˇ/00 / D 0.
Theorem Assume Assumption 1-Assumption 5. There exists an N ⇤ such that for N > N ⇤ , we have jˇNu ˇ0 j ⌫2 jˇNw
where ⌫2 denotes second order stochastic dominance.
Proof Sketch. We resort to MAP estimates of fwn gN
1 and ı1 D ı2 D 0 for simplicity of the sketch.

ˇ0 j,

By Bernstein von-Mises theorem, there exists N ⇤ s.t. N > N ⇤ implies the posterior means ˇNw and ˇNu are close to their
4✏
corresponding MLEs b̌w and b̌u . Thus it is sufficient to show instead that jb̌u ˇ0 j.1 M
/ ⌫2 .jb̌w ˇ0 j/.
By mean value theorem, we have

jˇOw
and

PN
w.log `.yn jˇ0 //.log `.yn jˇ0 /0 /
ˇ0 j D PNnD1
Q 00
nD1 w.log `.yn jˇ0 //.log `.yn jˇn / /
jˇOu

PN

log `.yn jˇ0 /0
ˇ0 j D PNnD1
;
L 00
nD1 log `.yn jˇn /

Robust Probabilistic Modeling with Bayesian Data Reweighting

where ˇQn and ˇLn are between ˇOu and ˇ0 .
It is thus sufficient to show
j

N
X

log `.yn jˇQn /00
w.log `.yn jˇ0 // PN
.1
L 00
nD1 log `.yn jˇn /
nD1

N
X
4✏
log `.yn jˇ0 /0
j
/j ⌫2 j
w.log `.yn jˇ0 // PN
0
M
nD1 log `.yn jˇ0 /
nD1

This is true by Assumption 5 and a version of stochastic majorization inequality (e.g. Theorem 7 of (Egozcue & Wong,
2010)).
⌅
The whole proof of Theorem 1 is to formalize the intuitive argument that if we downweight an observation whenever it
deviates from the truth of ˇ0 , our posterior estimate will be closer to ˇ0 than without downweighting, given the presence of
these disruptive observations.

Robust Probabilistic Modeling with Bayesian Data Reweighting

C. Proof sketch of theorem 2
We again resort to MAP estimates of weights for simplicity. Denote a probability distribution with a t -mass at z as
P t D t ız C .1 t /Pˇ0 . By differentiating the estimating equation
Z
fw.log `.z j ˇ// log `0 .z j ˇ/gP t .z/dz D 0
with respect to t, we obtain that

where

IF .zI b̌w ; `. jˇ0 // D Jw .ˇ0 /

1

fw.log `.z j ˇ0 // log `0 .zjˇ0 /g;

⇥
⇤
Jw .ˇ0 / D E`.zjˇ0 / w.log `.z j ˇ0 // log `0 .zjˇ0 / log `0 .zjˇ0 /> :

It is natural to consider z with log `.z j ˇ0 / negatively large as an outlier. By investigating the behavior of w.a/ as a goes to
1, we can easily see that

if

IF .zI b̌w ; `. j ˇ0 // ! 0; as `.z j ˇ0 / ! 0;

lim w.a/ D 0 and

a! 1

lim a w.a/ < 1:

a! 1

Robust Probabilistic Modeling with Bayesian Data Reweighting

D. Empirical study details
We present details of the four models in Section 3.
D.1. Corrupted observations
We generate a data set fyn gN
F / N of them from Poisson(5) and F N of them from Poisson(50).
1 of size N D 100, .1
The corruption rate F takes values from 0, 0.05, 0.10, ..., 0.45.
The localized Poisson model is
N
fyn gN
1 j f✓n g1 ⇠

N
Y

nD1

Poisson.yn j ✓n /;

i id

✓n j ✓ ⇠ N .✓;

2

✓ ⇠ Gamma. a ;

b /;

/;

with priors
2

⇠ lognormal.0; ⌫ 2 /:

The RPM is
p.fyn gN
1

j

✓; fwn gN
1 /

D

"

N
Y

nD1

wn

Poisson.yn I ✓/

#

Gamma.✓ j2; 0:5/

"

N
Y

nD1

#

Beta.wn I 0:1; 0:01/ :

D.2. Missing latent groups
We generate a data set f.yn ; xn gN
1 of size N D 100; xn ⇠ Unif. 10; 10/; yn ⇠ Bernoulli.1=1 C exp. pn // where
.1 F / N of them from pn D 0:5xn and F N of them from pn D 0:01xn . The missing latent group size F takes values
from 0, 0.05, 0.10, ..., 0.45.
The localized model is
yjx ⇠

N
Y

nD1

Bernoulli.yn j logit.ˇ1n xn //;

ˇ1n ⇠ N .ˇ1 ;

2

/;

with priors
ˇ1 ⇠ N .0; ⌧ 2 /;
2

⇠ Gamma. a ;

b /:

The RPM is
N
p.fyn gN
1 ; ˇ; fwn g1

j

fxn gN
1 /

D
⇥

"
"

N
Y

nD1
N
Y

nD1

Bernoulli.yn I 1=1 C exp. ˇxn //

wn

#

#

N .ˇI 0; 10/

Beta.wn I 0:1; 0:01/ :

D.3. Covariate dependence misspecification
i id

i id

i id

2
2
We generate a data set f.yn ; x1n ; x2n /gN
1 of size N D 100; x1n ⇠ N .10; 5 /, x2n ⇠ N .0; 10 /, ˇ0;1;2;3 ⇠
i id

Unif. 10; 10/, ✏n ⇠ N .0; 1/:

Robust Probabilistic Modeling with Bayesian Data Reweighting

1. Missing an interaction term
Data generated from yn D ˇ0 C ˇ1 x1 C ˇ2 x2 C ˇ3 x1 x2 C ✏n .

The localized model is

y j .x1 ; x2 / ⇠

N
Y

nD1

N .yn j ˇ0n C ˇ1n x1n C ˇ2n x2n ;
i id

ˇj n j ˇj ⇠ N .ˇj ;

2

/;

2
j /;

with priors
i id

ˇj ⇠ N .0; ⌧ 2 /; j D 0; 1; 2;
2 i id
j ⇠

lognormal.0; ⌫ 2 /; j D 0; 1; 2;
2

⇠ Gamma. a ;

The RPM is
p

N
fyn gN
1 ; ˇ0;1;2 ; fwn g1

j

fx1n ; x2n gN
1 /

D

"

N
Y

nD1

b /:

N .yn I ˇ0 C ˇ1 x1 C ˇ2 x2 ;

⇥ Gamma.
⇥

2
Y

j D0

2

I 1; 1/

N .ˇj I 0; 10/

"

N
Y

nD1

2 wn

/

#
#

Beta.wn I 0:1; 0:01/ :

2. Missing a quadratic term
Data generated from yn D ˇ0 C ˇ1 x1 C ˇ2 x2 C ˇ3 x22 C ✏n .

The localized model is

y j .x1 ; x2 / ⇠

N
Y

nD1

N .yn j ˇ0n C ˇ1n x1n C ˇ2n x2n ;
i id

ˇj n j ˇj ⇠ N .ˇj ;

2

/;

2
j /;

with priors
i id

ˇj ⇠ N .0; ⌧ 2 /; j D 0; 1; 2;
2 i id
j ⇠

lognormal.0; ⌫ 2 /; j D 0; 1; 2;
2

⇠ Gamma. a ;

The RPM is
p

N
fyn gN
1 ; ˇ0;1;2 ; fwn g1

j

fx1n ; x2n gN
1 /

D

"

N
Y

nD1

b /:

N .yn I ˇ0 C ˇ1 x1 C ˇ2 x2 ;

⇥ Gamma.
⇥
3. Missing a covariate
Data generated from yn D ˇ0 C ˇ1 x1 C ˇ2 x2 C ✏n .

2
Y

j D0

2

I 1; 1/

N .ˇj I 0; 10/

"

N
Y

nD1

2 wn

/

#
#

Beta.wn I 0:1; 0:01/ :

Robust Probabilistic Modeling with Bayesian Data Reweighting

The localized model is
y j .x1 / ⇠

N
Y

nD1

N .yn j ˇ0n C ˇ1n x1n ;
i id

/;

2
j /;

ˇj n j ˇj ⇠ N .ˇj ;

with priors

2

i id

ˇj ⇠ N .0; ⌧ 2 /; j D 0; 1;
2 i id
j ⇠

lognormal.0; ⌫ 2 /; j D 0; 1;
2

⇠ Gamma. a ;

The RPM is The RPM is
p

N
fyn gN
1 ; ˇ0;1 ; fwn g1

j

fx1n gN
1 /

D

"

N
Y

nD1

N .yn I ˇ0 C ˇ1 x1 ;

⇥ Gamma.
⇥

1
Y

j D0

b /:

2

I 1; 1/

N .ˇj I 0; 10/

"

N
Y

nD1

2 wn

/

#
#

Beta.wn I 0:1; 0:01/ :

D.4. Skewed distributions
We generate a data set f.x1n ; x2n /gN
1 of size N D 2000 from a mixture of three skewed normal distributions, with location
parameters (-2, -2), (3, 0), (-5, 7), scale parameters (2, 2), (2, 4), (4, 2), shape parameters -5, 10, 15, and mixture proportions
0.3, 0.3, 0.4. So the true number of components in this data set is 3.
The RPM is
30
30
30
N
p.f.x1n ; x2n /gN
1 ; f k g1 ; f†k g1 ; f⇡k g1 ; fwn g1 /
" N 30
# " 30
Y X
Y
wn
D
Œ
⇡k N ..x1n ; x2n I k ; †k /ç
N.
nD1 kD1

where

k

D.

k;1 ;

kD1

⇥

"

⇥

Dirichlet..⇡k /30
1 I 1/

k;2 /

30
Y

lognormal.

kD1

and †k D

✓

2
k;1

0

k;1 I 0; 10/N . k;2 I 0; 10/

#

k;1 I 0; 10/lognormal. k;2 I 0; 10/

"

N
Y

nD1

0
2
k;2

#

Beta.wn I 1; 0:05/ ;
◆

.

#

Robust Probabilistic Modeling with Bayesian Data Reweighting

E. Poisson factorization model
Poisson factorization models a matrix of count data as a low-dimensional inner product (Cemgil, 2009; Gopalan et al., 2015).
Consider a data set of a matrix sized U ⇥ I with non-negative integer elements xui . In the recommendation example, we
have U users and I items and each xui entry being the rating of user u on item i .
The user-reweighted RPM is
I
p.fxui gU ⇥I ; f✓u gU
1 ; fˇi g1 /

"

U Y
I
Y
D
Œ
Poisson.xui I ✓u >ˇi /çwu
uD1 iD1

⇥
⇥

"

U Y
K
Y

uD1 kD1

U
Y

uD1

#

#"

Gamma.✓u;k I 1; 0:001/

I Y
K
Y

iD1 kD1

#

Gamma.ˇi;k I 1; 0:001/

Beta.wu I 100; 1/;

where K is the number of latent dimensions.
Dataset . We use the Movielens-1M data set: user-movie ratings collected from a movie recommendation service.3

3 http://grouplens.org/datasets/movielens/

Robust Probabilistic Modeling with Bayesian Data Reweighting

F. Profile of a downweighted user
Here we show a donweighted user in the RPM analysis of the Movielens 1M dataset. This user watched 325 movies; we
rank her movies according to their popularity in the dataset.
Title

Genres

Usual Suspects, The (1995)
2001: A Space Odyssey (1968)
Ghost (1990)
Lion King, The (1994)
Leaving Las Vegas (1995)
Star Trek: Generations (1994)
African Queen, The (1951)
GoldenEye (1995)
Birdcage, The (1996)
Much Ado About Nothing (1993)
Hudsucker Proxy, The (1994)
My Fair Lady (1964)
Philadelphia Story, The (1940)
James and the Giant Peach (1996)
Crumb (1994)
Remains of the Day, The (1993)
Adventures of Priscilla, Queen of the Desert, The (1994)
Reality Bites (1994)
Notorious (1946)
Brady Bunch Movie, The (1995)
Roman Holiday (1953)
Apartment, The (1960)
Rising Sun (1993)
Bringing Up Baby (1938)
Bridges of Madison County, The (1995)
Pocahontas (1995)
Hunchback of Notre Dame, The (1996)
Mr. Smith Goes to Washington (1939)
His Girl Friday (1940)
Tank Girl (1995)
Adventures of Robin Hood, The (1938)
Eat Drink Man Woman (1994)
American in Paris, An (1951)
Secret Garden, The (1993)
Short Cuts (1993)
Six Degrees of Separation (1993)
First Wives Club, The (1996)
Age of Innocence, The (1993)
Father of the Bride (1950)
My Favorite Year (1982)
Shadowlands (1993)
Some Folks Call It a Sling Blade (1993)
Little Women (1994)
Kids in the Hall: Brain Candy (1996)
Cat on a Hot Tin Roof (1958)
Corrina, Corrina (1994)
Muppet Treasure Island (1996)
39 Steps, The (1935)
Farewell My Concubine (1993)
Renaissance Man (1994)
With Honors (1994)
Virtuosity (1995)
Cold Comfort Farm (1995)

CrimejThriller
DramajMysteryjSci-FijThriller
ComedyjRomancejThriller
AnimationjChildren’sjMusical
DramajRomance
ActionjAdventurejSci-Fi
ActionjAdventurejRomancejWar
ActionjAdventurejThriller
Comedy
ComedyjRomance
ComedyjRomance
MusicaljRomance
ComedyjRomance
AnimationjChildren’sjMusical
Documentary
Drama
ComedyjDrama
ComedyjDrama
Film-NoirjRomancejThriller
Comedy
ComedyjRomance
ComedyjDrama
ActionjDramajMystery
Comedy
DramajRomance
AnimationjChildren’sjMusical
AnimationjChildren’sjMusical
Drama
Comedy
ActionjComedyjMusicaljSci-Fi
ActionjAdventure
ComedyjDrama
MusicaljRomance
Children’sjDrama
Drama
Drama
Comedy
Drama
Comedy
Comedy
DramajRomance
DramajThriller
Drama
Comedy
Drama
ComedyjDramajRomance
AdventurejComedyjMusical
Thriller
DramajRomance
ComedyjDramajWar
ComedyjDrama
Sci-FijThriller
Comedy

%
45.0489
41.6259
32.0293
30.7457
27.3533
27.0171
26.1614
25.1222
19.7433
18.6125
17.1760
17.1760
15.5562
13.8142
13.1724
12.9279
12.8362
12.4389
12.0416
11.9499
11.8888
11.6748
11.1858
11.1553
10.9413
10.8802
10.8191
10.6663
10.5134
10.4218
10.0856
9.9939
9.7188
9.3215
9.0465
8.8325
8.6797
8.3435
8.2213
8.1601
8.1601
8.0990
8.0379
7.9768
7.7017
7.3961
7.3655
7.2127
7.2127
7.1210
6.7543
6.7543
6.4792

Robust Probabilistic Modeling with Bayesian Data Reweighting
Man Without a Face, The (1993)
East of Eden (1955)
Three Colors: White (1994)
Shadow, The (1994)
Boomerang (1992)
Hellraiser: Bloodline (1996)
Basketball Diaries, The (1995)
My Man Godfrey (1936)
Very Brady Sequel, A (1996)
Screamers (1995)
Richie Rich (1994)
Beautiful Girls (1996)
Meet Me in St. Louis (1944)
Ghost and Mrs. Muir, The (1947)
Waiting to Exhale (1995)
Boxing Helena (1993)
Belle de jour (1967)
Goofy Movie, A (1995)
Spitfire Grill, The (1996)
Village of the Damned (1995)
Dracula: Dead and Loving It (1995)
Twelfth Night (1996)
Dead Man (1995)
Miracle on 34th Street (1994)
Halloween: The Curse of Michael Myers (1995)
Once Were Warriors (1994)
Kid in King Arthur’s Court, A (1995)
Road to Wellville, The (1994)
Restoration (1995)
Oliver & Company (1988)
Basquiat (1996)
Pagemaster, The (1994)
Giant (1956)
Surviving the Game (1994)
City Hall (1996)
Herbie Rides Again (1974)
Backbeat (1993)
Umbrellas of Cherbourg, The (1964)
Ruby in Paradise (1993)
Mrs. Winterbourne (1996)
Bed of Roses (1996)
Chungking Express (1994)
Free Willy 2: The Adventure Home (1995)
Party Girl (1995)
Solo (1996)
Stealing Beauty (1996)
Burnt By the Sun (Utomlyonnye solntsem) (1994)
Naked (1993)
Kicking and Screaming (1995)
Jeffrey (1995)
Made in America (1993)
Lawnmower Man 2: Beyond Cyberspace (1996)
Davy Crockett, King of the Wild Frontier (1955)
Vampire in Brooklyn (1995)
NeverEnding Story III, The (1994)
Candyman: Farewell to the Flesh (1995)
Air Up There, The (1994)

Drama
Drama
Drama
Action
ComedyjRomance
ActionjHorrorjSci-Fi
Drama
Comedy
Comedy
Sci-FijThriller
Children’sjComedy
Drama
Musical
DramajRomance
ComedyjDrama
MysteryjRomancejThriller
Drama
AnimationjChildren’sjComedy
Drama
HorrorjSci-Fi
ComedyjHorror
ComedyjDramajRomance
Western
Drama
HorrorjThriller
CrimejDrama
AdventurejComedyjFantasy
Comedy
Drama
AnimationjChildren’s
Drama
AdventurejAnimationjFantasy
Drama
ActionjAdventurejThriller
DramajThriller
AdventurejChildren’sjComedy
DramajMusical
DramajMusical
Drama
ComedyjRomance
DramajRomance
DramajMysteryjRomance
AdventurejChildren’sjDrama
Comedy
ActionjSci-FijThriller
Drama
Drama
Drama
ComedyjDrama
Comedy
Comedy
Sci-FijThriller
Western
ComedyjRomance
AdventurejChildren’sjFantasy
Horror
Comedy

6.4181
6.2958
5.9597
5.9291
5.6846
5.6540
5.5318
5.3790
5.3484
5.2567
5.1956
5.1650
5.1650
4.9817
4.9817
4.7983
4.7983
4.6760
4.6760
4.6149
4.5232
4.5232
4.4927
4.4621
4.4315
4.3704
4.3399
4.3399
4.2176
4.0648
3.9731
3.8814
3.8509
3.8509
3.8509
3.7897
3.6675
3.5758
3.5452
3.4841
3.4841
3.3619
3.3313
3.2702
3.1785
3.1479
3.1479
2.9034
2.9034
2.8729
2.8423
2.8117
2.7812
2.7506
2.6895
2.6284
2.6284

Robust Probabilistic Modeling with Bayesian Data Reweighting
High School High (1996)
Young Poisoner’s Handbook, The (1995)
Jane Eyre (1996)
Jury Duty (1995)
Girl 6 (1996)
Farinelli: il castrato (1994)
Chamber, The (1996)
Blue in the Face (1995)
Little Buddha (1993)
King of the Hill (1993)
Shanghai Triad (Yao a yao yao dao waipo qiao) (1995)
Scarlet Letter, The (1995)
Blue Chips (1994)
House of the Spirits, The (1993)
Tom and Huck (1995)
Life with Mikey (1993)
For Love or Money (1993)
Princess Caraboo (1994)
Addiction, The (1995)
Mrs. Parker and the Vicious Circle (1994)
Cops and Robbersons (1994)
Wonderful, Horrible Life of Leni Riefenstahl, The (1993)
Strawberry and Chocolate (Fresa y chocolate) (1993)
Bread and Chocolate (Pane e cioccolata) (1973)
Of Human Bondage (1934)
To Live (Huozhe) (1994)
Now and Then (1995)
Flipper (1996)
Mr. Wrong (1996)
Before and After (1996)
Maya Lin: A Strong Clear Vision (1994)
Horseman on the Roof, The (Hussard sur le toit, Le) (1995)
Moonlight and Valentino (1995)
Andre (1994)
House Arrest (1996)
Celtic Pride (1996)
Amateur (1994)
White Man’s Burden (1995)
Heidi Fleiss: Hollywood Madam (1995)
Adventures of Pinocchio, The (1996)
National Lampoon’s Senior Trip (1995)
Angel and the Badman (1947)
Poison Ivy II (1995)
Bitter Moon (1992)
Perez Family, The (1995)
Georgia (1995)
Love in the Afternoon (1957)
Inkwell, The (1994)
Bloodsport 2 (1995)
Bad Company (1995)
Underneath, The (1995)
Widows’ Peak (1994)
Alaska (1996)
Jefferson in Paris (1995)
Penny Serenade (1941)
Big Green, The (1995)
What Happened Was... (1994)

Comedy
Crime
DramajRomance
Comedy
Comedy
DramajMusical
Drama
Comedy
Drama
Drama
Drama
Drama
Drama
DramajRomance
AdventurejChildren’s
Comedy
Comedy
Drama
Horror
Drama
Comedy
Documentary
Drama
Drama
Drama
Drama
Drama
AdventurejChildren’s
Comedy
DramajMystery
Documentary
Drama
DramajRomance
AdventurejChildren’s
Comedy
Comedy
CrimejDramajThriller
Drama
Documentary
AdventurejChildren’s
Comedy
Western
Thriller
Drama
ComedyjRomance
Drama
ComedyjRomance
ComedyjDrama
Action
Action
MysteryjThriller
Drama
AdventurejChildren’s
Drama
DramajRomance
Children’sjComedy
ComedyjDramajRomance

2.5978
2.5367
2.5367
2.4756
2.4450
2.3227
2.2616
2.2005
2.2005
2.1699
2.1699
2.1699
2.1394
2.1394
2.0477
2.0477
2.0171
1.9560
1.9560
1.9254
1.9254
1.8949
1.8949
1.8643
1.8643
1.8337
1.8337
1.8032
1.8032
1.7115
1.6504
1.6504
1.6504
1.6504
1.6198
1.6198
1.6198
1.5892
1.5892
1.5892
1.5587
1.5587
1.5281
1.4976
1.4670
1.4364
1.4059
1.4059
1.4059
1.3753
1.3753
1.3447
1.2836
1.2531
1.2531
1.2531
1.2531

Robust Probabilistic Modeling with Bayesian Data Reweighting
Great Day in Harlem, A (1994)
Underground (1995)
House Party 3 (1994)
Roommates (1995)
Getting Even with Dad (1994)
Cry, the Beloved Country (1995)
Stalingrad (1993)
Endless Summer 2, The (1994)
Browning Version, The (1994)
Fluke (1995)
Scarlet Letter, The (1926)
Pyromaniac’s Love Story, A (1995)
Castle Freak (1995)
Double Happiness (1994)
Month by the Lake, A (1995)
Once Upon a Time... When We Were Colored (1995)
Favor, The (1994)
Manny & Lo (1996)
Visitors, The (Les Visiteurs) (1993)
Carpool (1996)
Total Eclipse (1995)
Panther (1995)
Lassie (1994)
It’s My Party (1995)
Kaspar Hauser (1993)
It Takes Two (1995)
Purple Noon (1960)
Nadja (1994)
Haunted World of Edward D. Wood Jr., The (1995)
Dear Diary (Caro Diario) (1994)
Faces (1968)
Love & Human Remains (1993)
Man of the House (1995)
Curdled (1996)
Jack and Sarah (1995)
Denise Calls Up (1995)
Aparajito (1956)
Hunted, The (1995)
Colonel Chabert, Le (1994)
Thin Line Between Love and Hate, A (1996)
Nina Takes a Lover (1994)
Ciao, Professore! (Io speriamo che me la cavo ) (1993)
In the Bleak Midwinter (1995)
Naked in New York (1994)
Maybe, Maybe Not (Bewegte Mann, Der) (1994)
Police Story 4: Project S (Chao ji ji hua) (1993)
Algiers (1938)
Tom & Viv (1994)
Cold Fever (A koldum klaka) (1994)
Amazing Panda Adventure, The (1995)
Marlene Dietrich: Shadow and Light (1996)
Jupiter’s Wife (1994)
Stars Fell on Henrietta, The (1995)
Careful (1992)
Kika (1993)
Loaded (1994)
Killer (Bulletproof Heart) (1994)

Documentary
War
Comedy
ComedyjDrama
Comedy
Drama
War
Documentary
Drama
Children’sjDrama
Drama
ComedyjRomance
Horror
Drama
ComedyjDrama
Drama
ComedyjRomance
Drama
ComedyjSci-Fi
ComedyjCrime
DramajRomance
Drama
AdventurejChildren’s
Drama
Drama
Comedy
CrimejThriller
Drama
Documentary
ComedyjDrama
Drama
Comedy
Comedy
Crime
Romance
Comedy
Drama
Action
DramajRomancejWar
Comedy
ComedyjRomance
Drama
Comedy
ComedyjRomance
Comedy
Action
DramajRomance
Drama
ComedyjDrama
AdventurejChildren’s
Documentary
Documentary
Drama
Comedy
Drama
DramajThriller
Thriller

1.1919
1.1919
1.1614
1.1614
1.1308
1.1308
1.1308
1.1308
1.1308
1.1002
1.1002
1.0697
1.0697
1.0697
1.0391
1.0391
1.0086
1.0086
1.0086
0.9780
0.9780
0.9474
0.9474
0.9169
0.9169
0.9169
0.8863
0.8557
0.8557
0.8252
0.8252
0.7946
0.7946
0.7641
0.7641
0.7641
0.7641
0.7641
0.7335
0.7335
0.7335
0.7029
0.7029
0.7029
0.6724
0.6418
0.6418
0.6418
0.6112
0.6112
0.6112
0.6112
0.6112
0.5807
0.5807
0.5501
0.5501

Robust Probabilistic Modeling with Bayesian Data Reweighting
Clean Slate (Coup de Torchon) (1981)
Killer: A Journal of Murder (1995)
301, 302 (1995)
New Jersey Drive (1995)
Gold Diggers: The Secret of Bear Mountain (1995)
Spirits of the Dead (Tre Passi nel Delirio) (1968)
Fear, The (1995)
From the Journals of Jean Seberg (1995)
Celestial Clockwork (1994)
They Made Me a Criminal (1939)
Man of the Year (1995)
New Age, The (1994)
Reluctant Debutante, The (1958)
Savage Nights (Nuits fauves, Les) (1992)
Faithful (1996)
Land and Freedom (Tierra y libertad) (1995)
Boys (1996)
Big Squeeze, The (1996)
Gumby: The Movie (1995)
All Things Fair (1996)
Kim (1950)
Infinity (1996)
Peanuts - Die Bank zahlt alles (1996)
Ed’s Next Move (1996)
Hour of the Pig, The (1993)
Walk in the Sun, A (1945)
Death in the Garden (Mort en ce jardin, La) (1956)
Collectionneuse, La (1967)
They Bite (1996)
Original Gangstas (1996)
Gordy (1995)
Last Klezmer, The (1995)
Butterfly Kiss (1995)
Talk of Angels (1998)
In the Line of Duty 2 (1987)
Tarantella (1995)
Under the Domin Tree (Etz Hadomim Tafus) (1994)
Dingo (1992)
Billy’s Holiday (1995)
Venice/Venice (1992)
Low Life, The (1994)
Phat Beach (1996)
Catwalk (1995)
Fall Time (1995)
Scream of Stone (Schrei aus Stein) (1991)
Frank and Ollie (1995)
Bye-Bye (1995)
Tigrero: A Film That Was Never Made (1994)
Wend Kuuni (God’s Gift) (1982)
Sonic Outlaws (1995)
Getting Away With Murder (1996)
Fausto (1993)
Brothers in Trouble (1995)
Foreign Student (1994)
Tough and Deadly (1995)
Moonlight Murder (1936)
Schlafes Bruder (Brother of Sleep) (1995)

Crime
CrimejDrama
Mystery
CrimejDrama
AdventurejChildren’s
Horror
Horror
Documentary
Comedy
CrimejDrama
Documentary
Drama
ComedyjDrama
Drama
Comedy
War
Drama
ComedyjDrama
AnimationjChildren’s
Drama
Children’sjDrama
Drama
Comedy
Comedy
DramajMystery
Drama
Drama
Drama
Drama
Crime
Comedy
Documentary
Thriller
Drama
Action
Drama
Drama
Drama
Drama
Drama
Drama
Comedy
Documentary
Drama
Drama
Documentary
Drama
DocumentaryjDrama
Drama
Documentary
Comedy
Comedy
Drama
Drama
ActionjDramajThriller
Mystery
Drama

0.5501
0.5501
0.5196
0.5196
0.4890
0.4890
0.4890
0.4890
0.4584
0.4584
0.4584
0.4279
0.4279
0.4279
0.4279
0.4279
0.3973
0.3973
0.3973
0.3973
0.3667
0.3667
0.3667
0.3667
0.3667
0.3667
0.3362
0.3362
0.3362
0.3362
0.3362
0.3056
0.3056
0.3056
0.3056
0.3056
0.2751
0.2751
0.2751
0.2751
0.2751
0.2751
0.2751
0.2445
0.2445
0.2445
0.2445
0.2445
0.2445
0.2445
0.2445
0.2445
0.2445
0.2445
0.2445
0.2445
0.2139

Robust Probabilistic Modeling with Bayesian Data Reweighting
Metisse (Cafe au Lait) (1993)
Promise, The (Versprechen, Das) (1994)
Und keiner weint mir nach (1996)
Hungarian Fairy Tale, A (1987)
Liebelei (1933)
Paris, France (1993)
Girl in the Cadillac (1995)
Hostile Intentions (1994)
Two Bits (1995)
Rent-a-Kid (1995)
Beyond Bedlam (1993)
Touki Bouki (Journey of the Hyena) (1973)
Convent, The (Convento, O) (1995)
Open Season (1996)
Lotto Land (1995)
Frisk (1995)
Shadow of Angels (Schatten der Engel) (1976)
Yankee Zulu (1994)
Last of the High Kings, The (1996)
Sunset Park (1996)
Happy Weekend (1996)
Criminals (1996)
Happiness Is in the Field (1995)
Associate, The (L’Associe)(1982)
Target (1995)
Relative Fear (1994)
Honigmond (1996)
Eye of Vichy, The (Oeil de Vichy, L’) (1993)
Sweet Nothing (1995)
Harlem (1993)
Condition Red (1995)
Homage (1995)
Superweib, Das (1996)
Halfmoon (Paul Bowles - Halbmond) (1995)
Silence of the Palace, The (Saimt el Qusur) (1994)
Headless Body in Topless Bar (1995)
Rude (1995)
Garcu, Le (1995)
Guardian Angel (1994)
Roula (1995)
Jar, The (Khomreh) (1992)
Small Faces (1995)
New York Cop (1996)
Century (1993)

Comedy
Romance
DramajRomance
Fantasy
Romance
Comedy
Drama
ActionjDramajThriller
Drama
Comedy
DramajHorror
Drama
Drama
Comedy
Drama
Drama
Drama
ComedyjDrama
Drama
Drama
Comedy
Documentary
Comedy
Comedy
ActionjDrama
HorrorjThriller
Comedy
Documentary
Drama
Drama
ActionjDramajThriller
Drama
Comedy
Drama
Drama
Comedy
Drama
Drama
ActionjDramajThriller
Drama
Drama
Drama
ActionjCrime
Drama

0.2139
0.2139
0.2139
0.2139
0.2139
0.2139
0.2139
0.2139
0.2139
0.2139
0.2139
0.2139
0.2139
0.2139
0.1834
0.1834
0.1834
0.1834
0.1834
0.1834
0.1834
0.1834
0.1528
0.1528
0.1528
0.1528
0.1528
0.1528
0.1528
0.1528
0.1528
0.1528
0.1222
0.1222
0.1222
0.1222
0.1222
0.1222
0.1222
0.0917
0.0917
0.0917
0.0917
0.0917

Robust Probabilistic Modeling with Bayesian Data Reweighting

References
Cemgil, Ali Taylan. Bayesian inference for nonnegative matrix factorisation models. Computational Intelligence and
Neuroscience, 2009, 2009.
Egozcue, Martin and Wong, Wing-Keung. Gains from diversification on convex combinations: A majorization and stochastic
dominance approach. European Journal of Operational Research, 200(3):893–900, 2010.
Gopalan, Prem, Hofman, Jake M, and Blei, David M. Scalable recommendation with hierarchical Poisson factorization.
UAI, 2015.

