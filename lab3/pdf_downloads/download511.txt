Bayesian Boolean Matrix Factorisation – Supplementary Information

Tammo Rukat 1 Chris C. Holmes 1 2 Michalis K. Titsias 3 Christopher Yau 4 5

A. Derivation of the Conditionals
Here we derive the full conditional for a latent variable znl as stated in eq. (4). The expression for uld is analogous. We
start from the full joint:
p(X, U , Z, λ) = p(X|U , Z, λ)p(Z)p(U )p(λ) .
We drop terms that do not depend on znl , and plug in the likelihood from eq. (3):
"
#
Y
Y
p(znl | · ) ∝
σ λx̃nd (1−2
(1−znl0 ul0 d )) p(znl ) .
l0

d

Next, we normalise this expression for znl ∈ [0, 1] and restrict to znl = 1 for simplicity:
#
"
Q
X
1+ exp[−λx̃nd (1−2 l0 (1−znl0 ul0 d ))]znl =0
Q
.
p(znl = 1| · ) = σ logit(p(znl ) +
log
1+ exp[−λx̃nd (1−2 l0 (1−znl0 ul0 d ))]znl =1

(9)

d

We can distinctly simplify the second line of equation eq. (9) by distinguishing the two possible contributions to the sum.
Changing znl from 0 to 1 in the fraction inside the sum can have the following two consequences:
1. Numerator and denominator remain equal, then the contribution to the sum is zero.
2. The numerator’s exponent evaluates to λx̃nd and the denominator’s exponent to −λx̃nd , then the contribution to the
sum is λx̃nd , as we can see by using the identity log(1 + ex ) − log(1 + e−x ) = x.
For scenario 2 to take place, we can see from eq. (9) that two conditions need to be met:
1. uld = 1. Otherwise, the value znl does not effect the likelihood. Viewed es directed graphical model, there would be
no link between znl and xnd .
2. zn0 l ul0 d = 0 ∀ l0 6= l. Otherwise, another parent already explains xnd . Viewed as directed graphical model, xnd
would be explained away.
Thus we find the equality for the fraction in eq. (9):
Q
X
X
Y
1+ exp[−λx̃nd (1−2 l0 (1−znl0 ul0 d ))]znl =0
Q
log
=λ
x̃nd uld
(1−znl0 ul0 d ) .
1+ exp[−λx̃nd (1−2 l0 (1−znl0 ul0 d ))]znl =1
0
d

d

This leads to the full conditional as given in eq. (4):

p(znl | · ) = σ logit(p(znl ))+λz̃nl

l 6=l


X
d

x̃nd uld

Y

(1−znl0 ul0 d ) .

l0 6=l

1

Department of Statistics, University of Oxford, UK 2 Nuffield Department of Medicine, University of Oxford, UK 3 Department of
Informatics, Athens University of Economics and Business, Greece 4 Centre for Computational Biology, Institute of Cancer and Genomic
Sciences, University of Birmingham, UK 5 Wellcome Trust Centre for Human Genetics, University of Oxford, UK. Correspondence to:
Tammo Rukat <tammo.rukat@stats.ox.ac.uk>.
Proceedings of the 34 th International Conference on Machine Learning, Sydney, Australia, PMLR 70, 2017. Copyright 2017 by the
author(s).

