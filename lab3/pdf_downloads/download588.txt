Neural Networks and Rational Functions
Matus Telgarsky 1

Abstract
Neural networks and rational functions efficiently approximate each other. In more detail, it is shown here that for any ReLU network, there exists a rational function of degree O(poly log(1/)) which is -close, and similarly for any rational function there exists a
ReLU network of size O(poly log(1/)) which
is -close. By contrast, polynomials need degree â„¦(poly(1/)) to approximate even a single
ReLU. When converting a ReLU network to a
rational function as above, the hidden constants
depend exponentially on the number of layers,
which is shown to be tight; in other words, a compositional representation can be beneficial even
for rational functions.

1. Overview
Significant effort has been invested in characterizing the
functions that can be efficiently approximated by neural
networks. The goal of the present work is to characterize
neural networks more finely by finding a class of functions
which is not only well-approximated by neural networks,
but also well-approximates neural networks.
The function class investigated here is the class of rational
functions: functions represented as the ratio of two polynomials, where the denominator is a strictly positive polynomial. For simplicity, the neural networks are taken to
always use ReLU activation Ïƒr (x) := max{0, x}; for a review of neural networks and their terminology, the reader
is directed to Section 1.4. For the sake of brevity, a network
with ReLU activations is simply called a ReLU network.
1.1. Main results
The main theorem here states that ReLU networks and rational functions approximate each other well in the sense
1

University of Illinois, Urbana-Champaign; work completed
while visiting the Simons Institute. Correspondence to: your
friend <mjt@illinois.edu>.
Proceedings of the 34 th International Conference on Machine
Learning, Sydney, Australia, PMLR 70, 2017. Copyright 2017
by the author(s).

4

spike
rat
poly
net

3

2

1

0
âˆ’1.00

âˆ’0.75

âˆ’0.50

âˆ’0.25

0.00

0.25

0.50

0.75

1.00

Figure 1. Rational, polynomial, and ReLU network fit to â€œspikeâ€,
a function which is 1/x along [1/4, 1] and 0 elsewhere.

that -approximating one class with the other requires a
representation whose size is polynomial in ln(1 / ), rather
than being polynomial in 1/.
Theorem 1.1. 1. Let  âˆˆ (0, 1] and nonnegative integer k be given. Let p : [0, 1]d â†’ [âˆ’1, +1] and
q : [0, 1]d â†’ [2âˆ’k , 1] be polynomials of degree â‰¤ r,
each with â‰¤ s monomials. Then there exists a function
f : [0, 1]d â†’ R, representable as a ReLU network of
size (number of nodes)

O k 7 ln(1 / )3
n
o
+ min srk ln(sr / ), sdk 2 ln(dsr / )2 ,
such that



p(x) 

sup f (x) âˆ’
â‰¤ .
q(x) 
xâˆˆ[0,1]d
2. Let  âˆˆ (0, 1] be given. Consider a ReLU network
f : [âˆ’1, +1]d â†’ R with at most m nodes in each
of at most k layers, where each node computes z 7â†’
Ïƒr (a> z + b) where the pair (a, b) (possibly distinct
across nodes) satisfies kak1 + |b| â‰¤ 1. Then there exists a rational function g : [âˆ’1, +1]d â†’ R with degree
(maximum degree of numerator and denominator)


O ln(k/)k mk
such that
sup
xâˆˆ[âˆ’1,+1]d



f (x) âˆ’ g(x) â‰¤ .

Neural networks and rational functions

Perhaps the main wrinkle is the appearance of mk when
approximating neural networks by rational functions. The
following theorem shows that this dependence is tight.
Theorem 1.2. Let any integer k â‰¥ 3 be given. There exists a function f : R â†’ R computed by a ReLU network
with 2k layers, each with â‰¤ 2 nodes, such that any rational function g : R â†’ R with â‰¤ 2kâˆ’2 total terms in the
numerator and denominator must satisfy

thresh
rat
poly

1.0
0.8
0.6
0.4
0.2
0.0

Z

1
.
|f (x) âˆ’ g(x)| dx â‰¥
64
[0,1]

âˆ’1.00

âˆ’0.75

âˆ’0.50

âˆ’0.25

0.00

0.25

0.50

0.75

1.00

Figure 2. Polynomial and rational fit to the threshold function.

Note that this statement implies the desired difficulty of approximation, since a gap in the above integral (L1 ) distance
implies a gap in the earlier uniform distance (Lâˆž ), and
furthermore an r-degree rational function necessarily has
â‰¤ 2r + 2 total terms in its numerator and denominator.
As a final piece of the story, note that the conversion between rational functions and ReLU networks is more seamless if instead one converts to rational networks, meaning
neural networks where each activation function is a rational
function.
Lemma 1.3. Let a ReLU network f : [âˆ’1, +1]d â†’ R
be given as in Theorem 1.1, meaning f has at most l layers
and each node computes z 7â†’ Ïƒr (a> z + b) where where the
pair (a, b) (possibly distinct across nodes) satisfies kak1 +
|b| â‰¤ 1. Then there exists a rational function R of degree
O(ln(l/)2 ) so that replacing each Ïƒr in f with R yields a
function g : [âˆ’1, +1]d â†’ R with
sup

|f (x) âˆ’ g(x)| â‰¤ .

xâˆˆ[âˆ’1,+1]d

Combining Theorem 1.2 and Lemma 1.3 yields an intriguing corollary.
Corollary 1.4. For every k â‰¥ 3, there exists a function
f : R â†’ R computed by a rational network with O(k)
layers and O(k) total nodes, each node invoking a rational
activation of degree O(k), such that every rational function
g : R â†’ R with less than 2kâˆ’2 total terms in the numerator
and denominator satisfies
Z
|f (x) âˆ’ g(x)| dx â‰¥
[0,1]

1
.
128

1.2. Auxiliary results
The first thing to stress is that Theorem 1.1 is impossible
with polynomials: namely, while it is true that ReLU networks can efficiently approximate polynomials (Yarotsky,
2016; Safran & Shamir, 2016; Liang & Srikant, 2017), on
the other hand polynomials require degree â„¦(poly(1/)),
rather than O(poly(ln(1/))), to approximate a single
ReLU, or equivalently the absolute value function (Petrushev & Popov, 1987, Chapter 4, Page 73).
Another point of interest is the depth needed when converting a rational function to a ReLU network. Theorem 1.1
is impossible if the depth is o(ln(1/)): specifically, it is
impossible to approximate the degree 1 rational function
x 7â†’ 1/x with size O(ln(1/)) but depth o(ln(1/)).
Proposition 1.5. Set f (x) := 1/x, the reciprocal map. For
any  > 0 and ReLU network g : R â†’ R with l layers and
m < (27648)âˆ’1/(2l) /2 nodes,
Z
|f (x) âˆ’ g(x)| dx > .
[1/2,3/4]

Lastly, the implementation of division in a ReLU network
requires a few steps, arguably the most interesting being
a â€œcontinuous switch statementâ€, which computes reciprocals differently based on the magnitude of the input. The
ability to compute switch statements appears to be a fairly
foundational operation available to neural networks and rational functions (Petrushev & Popov, 1987, Theorem 5.2),
but is not available to polynomials (since otherwise they
could approximate the ReLU).
1.3. Related work

The hard-to-approximate function f is a rational network
which has a description of size O(k 2 ). Despite this, attempting to approximate it with a rational function of the
usual form requires a description of size â„¦(2k ). Said another way: even for rational functions, there is a benefit to
a neural network representation!

The results of the present work follow a long line of work
on the representation power of neural networks and related functions. The ability of ReLU networks to fit continuous functions was no doubt proved many times, but
it appears the earliest reference is to Lebesgue (Newman,
1964, Page 1), though of course results of this type are usu-

Neural networks and rational functions

ally given much more contemporary attribution (Cybenko,
1989). More recently, it has been shown that certain function classes only admit succinct representations with many
layers (Telgarsky, 2015). This has been followed by proofs
showing the possibility for a depth 3 function to require exponentially many nodes when rewritten with 2 layers (Eldan & Shamir, 2016). There are also a variety of other
result giving the ability of ReLU networks to approximate
various function classes (Cohen et al., 2016; Poggio et al.,
2017).
Most recently, a variety of works pointed out neural networks can approximate polynomials, and thus smooth
functions essentially by Taylorâ€™s theorem (Yarotsky, 2016;
Safran & Shamir, 2016; Liang & Srikant, 2017). This
somewhat motivates this present work, since polynomials
can not in turn approximate neural networks with a dependence O(poly log(1/)): they require degree â„¦(1/) even
for a single ReLU.
Rational functions are extensively studied in the classical
approximation theory literature (Lorentz et al., 1996; Petrushev & Popov, 1987). This literature draws close connections between rational functions and splines (piecewise
polynomial functions), a connection which has been used
in the machine learning literature to draw further connections to neural networks (Williamson & Bartlett, 1991). It
is in this approximation theory literature that one can find
the following astonishing fact: not only is it possible to approximate the absolute value function (and thus the ReLU)
over [âˆ’1, +1] to accuracy  > 0 with a rational function of
degree O(ln(1/)2 ) (Newman, 1964), but moreover the optimal rate is known (Petrushev & Popov, 1987; Zolotarev,
1877)! These results form the basis of those results here
which show that rational functions can approximate ReLU
networks. (Approximation theory results also provide other
functions (and types of neural networks) which rational
functions can approximate well, but the present work will
stick to the ReLU for simplicity.)
An ICML reviewer revealed prior work which was embarrassingly overlooked by the author: it has been known,
since decades ago (Beame et al., 1986), that neural networks using threshold nonlinearities (i.e., the map x 7â†’
1[x â‰¥ 0]) can approximate division, and moreover the
proof is similar to the proof of part 1 of Theorem 1.1!
Moreover, other work on threshold networks invoked
Newman polynomials to prove lower bound about linear
threshold networks (Paturi & Saks, 1994). Together this
suggests that not only the connections between rational
functions and neural networks are tight (and somewhat
known/unsurprising), but also that threshold networks and
ReLU networks have perhaps more similarities than what is
suggested by the differing VC dimension bounds, approximation results, and algorithmic results (Goel et al., 2017).

12

5
9
13

10
8
6
4
2
0
âˆ’1.00

âˆ’0.75

âˆ’0.50

âˆ’0.25

0.00

0.25

0.50

0.75

1.00

Figure 3. Newman polynomials of degree 5, 9, 13.

1.4. Further notation
Here is a brief description of the sorts of neural networks
used in this work. Neural networks represent computation
as a directed graph, where nodes consume the outputs of
their parents, apply a computation to them, and pass the
resulting value onward. In the present work, nodes take
their parentsâ€™ outputs z and compute Ïƒr (a> z + b), where
a is a vector, b is a scalar, and Ïƒr (x) := max{0, x}; another popular choice of nonlineary is the sigmoid x 7â†’
(1 + exp(âˆ’x))âˆ’1 . The graphs in the present work are
acyclic and connected with a single node lacking children
designated as the univariate output, but the literature contains many variations on all of these choices.
As stated previously, a rational function f : Rd â†’ R is
ratio of two polynomials. Following conventions in the approximation theory literature (Lorentz et al., 1996), the denominator polynomial will always be strictly positive. The
degree of a rational function is the maximum of the degrees
of its numerator and denominator.

2. Approximating ReLU networks with
rational functions
This section will develop the proofs of part 2 of Theorem 1.1, Theorem 1.2, Lemma 1.3, and Corollary 1.4.
2.1. Newman polynomials
The starting point is a seminal result in the theory of rational functions (Zolotarev, 1877; Newman, 1964): there
exists a rational function of degree O(ln(1/)2 ) which can
approximate the absolute value function along [âˆ’1, +1] to
accuracy  > 0. This in turn gives a way to approximate
the ReLU, since
Ïƒr (x) = max{0, x} =

x + |x|
.
2

(2.1)

The construction here uses the Newman polynomials (New-

Neural networks and rational functions

man, 1964): given an integer r, define
Nr (x) :=

1.0

râˆ’1
Y

0.8

i=1

0.6

âˆš
(x + exp(âˆ’i/ r)).

The Newman polynomials N5 , N9 , and N13 are depicted
in Figure 3. Typical polynomials in approximation theory,
for instance the Chebyshev polynomials, have very active
oscillations; in comparison, the Newman polynomials look
a little funny, lying close to 0 over [âˆ’1, 0], and quickly increasing monotonically over [0, 1]. The seminal result of
Newman (1964) is that




âˆš
Nr (x) âˆ’ Nr (âˆ’x) 

sup |x| âˆ’ x
 â‰¤ 3 exp(âˆ’ r)/2.


N
(x)
+
N
(âˆ’x)
r
r
|x|â‰¤1
Thanks to this bound and eq. (2.1), it follows that the ReLU
can be approximated to accuracy  > 0 by rational functions of degree O(ln(1/)2 ).
(Some basics on Newman polynomials, as needed in the
present work, can be found in Appendix A.1.)
2.2. Proof of Lemma 1.3
Now that a single ReLU can be easily converted to a rational function, the next task is to replace every ReLU in
a ReLU network with a rational function, and compute
the approximation error. This is precisely the statement of
Lemma 1.3.
The proof of Lemma 1.3 is an induction on layers, with
full details relegated to the appendix. The key computation, however, is as follows. Let R(x) denote a rational
approximation to Ïƒr . Fix a layer i + 1, and let H(x) denote the multi-valued mapping computed by layer i, and
let HR (x) denote the mapping obtained by replacing each
Ïƒr in H with R. Fix any node in layer i + 1, and let
x 7â†’ Ïƒr (a> H(x) + b) denote its output as a function of
the input. Then




Ïƒr (a> H(x) + b) âˆ’ R(a> HR (x) + b)




â‰¤ Ïƒr (a> H(x) + b) âˆ’ Ïƒr (a> HR (x) + b)
|
{z
}
â™¥





+ Ïƒr (a> HR (x) + b) âˆ’ R(a> HR (x) + b) .
|
{z
}
â™£

For the first term â™¥, note since Ïƒr is 1-Lipschitz and by
HoÌˆlderâ€™s inequality that




â™¥ â‰¤ a> (H(x) âˆ’ HR (x)) â‰¤ kak1 kH(x) âˆ’ HR (x)kâˆž ,
meaning this term has been reduced to the inductive hypothesis since kak1 â‰¤ 1. For the second term â™£, if

âˆ†
rat
poly

0.4
0.2
0.0
0.0

0.2

0.4

0.6

0.8

1.0

Figure 4. Polynomial and rational fit to âˆ†.

a> HR (x) + b can be shown to lie in [âˆ’1, +1] (which is
another easy induction), then â™£ is just the error between R
and Ïƒr on the same input.
2.3. Proof of part 2 of Theorem 1.1
It is now easy to find a rational function that approximates
a neural network, and to then bound its size. The first step,
via Lemma 1.3, is to replace each Ïƒr with a rational function R of low degree (this last bit using Newman polynomials). The second step is to inductively collapse the network
into a single rational function. The reason for the dependence on the number of nodes m is that, unlike polynomials, summing rational functions involves an increase in
degree:
p1 (x)q2 (x) + p2 (x)q1 (x)
p1 (x) p1 (x)
+
=
.
q1 (x)
q2 (x)
q1 (x)q2 (x)
2.4. Proof of Theorem 1.2
The final interesting bit is to show that the dependence on
ml in part 2 of Theorem 1.1 (where m is the number of
nodes and l is the number of layers) is tight.
Recall the â€œtriangle functionâ€
ï£±
ï£´
ï£´
x âˆˆ [0, 1/2],
ï£²2x
âˆ†(x) := 2(1 âˆ’ x) x âˆˆ (1/2, 1],
ï£´
ï£´
ï£³0
otherwise.
The k-fold composition âˆ†k is a piecewise affine function
with 2kâˆ’1 regularly spaced peaks (Telgarsky, 2015). This
function was demonstrated to be inapproximable by shallow networks of subexponential size, and now it can be
shown to be a hard case for rational approximation as well.
Consider the horizontal line through y = 1/2. The function âˆ†k will cross this line 2k times. Now consider a rational function f (x) = p(x)/q(x). The set of points where
f (x) = 1/2 corresponds to points where 2p(x)âˆ’q(x) = 0.

Neural networks and rational functions

A poor estimate for the number of zeros is simply the degree of 2pâˆ’q, however, since f is univariate, a stronger tool
becomes available: by Descartesâ€™ rule of signs, the number
of zeros in f âˆ’ 1/2 is upper bounded by the number of
terms in 2p âˆ’ q.

ReLU
rat
poly

1.0
0.8
0.6
0.4

3. Approximating rational functions with
ReLU networks
This section will develop the proof of part 1 of Theorem 1.1, as well as the tightness result in Proposition 1.5

To establish part 1 of Theorem 1.1, the first step is to approximate polynomials with ReLU networks, and the second is to then approximate the division operation.
The representation of polynomials will be based upon constructions due to Yarotsky (2016). The starting point is the
following approximation of the squaring function.
Lemma 3.1 ((Yarotsky, 2016)). Let any  > 0 be given.
There exists f : x â†’ [0, 1], represented as a ReLU
network with O(ln(1/)) nodes and layers, such that
supxâˆˆ[0,1] |f (x) âˆ’ x2 | â‰¤  and f (0) = 0.
Yarotskyâ€™s proof is beautiful and deserves mention. The
approximation of x2 is the function fk , defined as
k
X
âˆ†i (x)
i=1

4i

,

where âˆ† is the triangle map from Section 2. For every
k, fk is a convex, piecewise-affine interpolation between
points along the graph of x2 ; going from k to k + 1 does
not adjust any of these interpolation points, but adds a new
set of O(2k ) interpolation points.
Once squaring is in place, multiplication comes via the polarization identity xy = ((x + y)2 âˆ’ x2 âˆ’ y 2 )/2.
Lemma 3.2 ((Yarotsky, 2016)). Let any  > 0 and B â‰¥ 1
be given. There exists g(x, y) : [0, B]2 â†’ [0, B 2 ], represented by a ReLU network with O(ln(B/) nodes and
layers, with
sup |g(x, y) âˆ’ xy| â‰¤ 
x,yâˆˆ[0,1]

and g(x, y) = 0 if x = 0 or y = 0.
Next, it follows that ReLU networks can efficiently approximate exponentiation thanks to repeated squaring.
Lemma 3.3. Let  âˆˆ (0, 1] and positive integer y be given.
There exists h : [0, 1] â†’ [0, 1], represented by a ReLU
network with O(ln(y/)2 ) nodes and layers, with


sup h(x) âˆ’ xy  â‰¤ 
x,yâˆˆ[0,1]

0.0
âˆ’1.00

âˆ’0.75

âˆ’0.50

âˆ’0.25

0.00

0.25

0.50

0.75

1.00

Figure 5. Polynomial and rational fit to Ïƒr .

3.1. Proving part 1 of Theorem 1.1

fk (x) := x âˆ’

0.2

With multiplication and exponentiation, a representation
result for polynomials follows.
Lemma 3.4. Let  âˆˆ (0, 1] be given.
Let p :
[0, 1]d â†’ [âˆ’1, +1] denote a polynomial with â‰¤ s
monomials, each with degree â‰¤ r and scalar coefficient within [âˆ’1, +1]. Then there exists a function
q : [0, 1]d â†’ [âˆ’1, +1] computed by
 a network of
size O min{sr ln(sr/), sd ln(dsr/)2 } , which satisfies
supxâˆˆ[0,1]d |p(x) âˆ’ q(x)| â‰¤ .
The remainder of the proof now focuses on the division operation. Since multiplication has been handled, it suffices
to compute a single reciprocal.
Lemma 3.5. Let  âˆˆ (0, 1] and nonnegative integer k be
given. There exists a ReLU network q : [2âˆ’k , 1] â†’ [1, 2k ],
of size O(k 2 ln(1/)2 ) and depth O(k 4 ln(1/)3 ) such that



1
sup q(x) âˆ’  â‰¤ .
x
xâˆˆ[2âˆ’k ,1]
This proof relies on two tricks. The first is to observe, for
x âˆˆ (0, 1], that
X
1
1
=
=
(1 âˆ’ x)i .
x
1 âˆ’ (1 âˆ’ x)
iâ‰¥0

Thanks to the earlier development of exponentiation, truncating this summation gives an expression easily approximate by a neural network as follows.
Lemma 3.6. Let 0 < a â‰¤ b and  > 0 be given. Then there
exists a ReLU network q : R â†’ R with O(ln(1/(a))2 )
layers and O((b/a) ln(1/(a))3 ) nodes satisfying



1 

sup q(x) âˆ’  â‰¤ 2.
x
xâˆˆ[a,b]
Unfortunately, Lemma 3.6 differs from the desired statement Lemma 3.6: inverting inputs lying within [2âˆ’k , 1] requires O(2k ln(1/)2 ) nodes rather than O(k 4 ln(1/)3 )!

Neural networks and rational functions

To obtain a good estimate with only O(ln(1/)) terms of
the summation, it is necessary for the input to be x bounded
below by a positive constant (not depending on k). This
leads to the second trick (which was also used by Beame
et al. (1986)!).

1.0

Consider, for positive constant c > 0, the expression
X
c
1
(1 âˆ’ cx)i .
=
=c
x
1 âˆ’ (1 âˆ’ cx)

0.4

âˆ†3
rat
poly

0.8
0.6

0.2

iâ‰¥0

If x is small, choosing a larger c will cause this summation
to converge more quickly. Thus, to compute 1/x accurately
over a wide range of inputs, the solution here is to multiplex approximations of the truncated sum for many choices
of c. In order to only rely on the value of one of them, it
is possible to encode a large â€œswitchâ€ style statement in a
neural network. Notably, rational functions can also representat switch statements (Petrushev & Popov, 1987, Theorem 5.2), however polynomials can not (otherwise they
could approximate the ReLU more efficiently, seeing as it
is a switch statement of 0 (a degree 0 polynomial) and x (a
degree 1 polynomial).
Lemma 3.7. Let  > 0, B â‰¥ 1, reals a0 â‰¤ a1 â‰¤ Â· Â· Â· â‰¤
an â‰¤ an+1 and a function f : [a0 , an+1 ] â†’ R be given.
Moreover, suppose for i âˆˆ {1, . . . , n}, there exists a ReLU
network gi : R â†’ R of size â‰¤ mi and depth â‰¤ ki with
gi âˆˆ [0, B] along [aiâˆ’1 , ai+1 ] and
|gi (x) âˆ’ f | â‰¤ .

sup
xâˆˆ[aiâˆ’1 ,ai+1 ]

Then there exists a function g : R â†’ P
R computed
by a

ReLU network of size O
n
ln(B/)
+
m
and
depth
i
i

O ln(B/) + maxi ki satisfying
sup

|g(x) âˆ’ f (x)| â‰¤ 3.

xâˆˆ[a1 ,an ]

3.2. Proof of Proposition 1.5
It remains to show that shallow networks have a hard time
approximating the reciprocal map x 7â†’ 1/x.
This proof uses the same scheme as various proofs in (Telgarsky, 2016), which was also followed in more recent
works (Yarotsky, 2016; Safran & Shamir, 2016): the idea
is to first upper bound the number of affine pieces in ReLU
networks of a certain size, and then to point out that each
linear segment must make substantial error on a curved
function, namely 1/x.
The proof is fairly brute force, and thus relegated to the
appendices.

4. Summary of figures
Throughout this work, a number of figures were presented
to show not only the astonishing approximation properties

0.0
0.0

0.2

0.4

0.6

0.8

1.0

Figure 6. Polynomial and rational fit to âˆ†3 .

of rational functions, but also the higher fidelity approximation achieved by both ReLU networks and rational functions as compared with polynomials. Of course, this is only
a qualitative demonstration, but still lends some intuition.
In all these demonstrations, rational functions and polynomials have degree 9 unless otherwise marked. ReLU networks have two hidden layers each with 3 nodes. This is
not exactly apples to apples (e.g., the rational function has
twice as many parameters as the polynomial), but still reasonable as most of the approximation literature fixes polynomial and rational degrees in comparisons.
Figure 1 shows the ability of all three classes to approximate a truncated reciprocal. Both rational functions and
ReLU networks have the ability to form â€œswitch statementsâ€ that let them approximate different functions on different intervals with low complexity (Petrushev & Popov,
1987, Theorem 5.2). Polynomials lack this ability; they can
not even approximate the ReLU well, despite it being low
degree polynomials on two separate intervals.
Figure 2 shows that rational functions can fit the threshold
function errily well; the particular rational function used
here is based on using Newman polynomials to approximate (1 + |x|/x)/2 (Newman, 1964).
Figure 3 shows Newman polynomials N5 , N9 , N13 . As discussed in the text, they are unlike orthogonal polynomials,
and are used in all rational function approximations except
Figure 1, which used a least squares fit.
Figure 4 shows that rational functions (via the Newman
polynomials) fit âˆ† very well, whereas polynomials have
trouble. These errors degrade sharply after recursing,
namely when approximating âˆ†3 as in Figure 6.
Figure 5 shows how polynomials and rational functions fit
the ReLU, where the ReLU representation, based on Newman polynomials, is the one used in the proofs here. Despite the apparent slow convergence of polynomials in this
regime, the polynomial fit is still quite respectable.

Neural networks and rational functions

5. Open problems
There are many next steps for this and related results.
1. Can rational functions, or some other approximating
class, be used to more tightly bound the generalization properties of neural networks? Notably, the VC
dimension of sigmoid networks uses a conversion to
polynomials (Anthony & Bartlett, 1999).
2. Can rational functions, or some other approximating
class, be used to design algorithms for training neural
networks? It does not seem easy to design reasonable
algorithms for minimization over rational functions;
if this is fundamental and moreover in contrast with
neural networks, it suggests an algorithmic benefit of
neural networks.
3. Can rational functions, or some other approximating
class, give a sufficiently refined complexity estimate
of neural networks which can then be turned into a
regularization scheme for neural networks?

Acknowledgements
The author thanks Adam Klivans and Suvrit Sra for stimulating conversations. Adam Klivans and the author both
thank Almare Gelato Italiano, in downtown Berkeley, for
necessitating further stimulating conversations, but now on
the topic of health and exercise. Lastly, the author thanks
the University of Illinois, Urbana-Champaign, and the Simons Institute in Berkeley, for financial support during this
work.

References
Anthony, Martin and Bartlett, Peter L. Neural Network
Learning: Theoretical Foundations. Cambridge University Press, 1999.
Beame, Paul, Cook, Stephen A., and Hoover, H. James.
Log depth circuits for division and related problems.
SIAM Journal on Computing, 15(4):994â€“1003, 1986.
Cohen, Nadav, Sharir, Or, and Shashua, Amnon. On the
expressive power of deep learning: A tensor analysis.
2016. COLT.
Cybenko, George. Approximation by superpositions of a
sigmoidal function. Mathematics of Control, Signals and
Systems, 2(4):303â€“314, 1989.
Eldan, Ronen and Shamir, Ohad. The power of depth for
feedforward neural networks. In COLT, 2016.
Goel, Surbhi, Kanade, Varun, Klivans, Adam, and Thaler,
Justin. Reliably learning the relu in polynomial time. In
COLT, 2017.

Liang, Shiyu and Srikant, R. Why deep neural networks
for function approximation? In ICLR, 2017.
Lorentz, G. G., Golitschek, Manfred von, and Makovoz,
Yuly. Constructive approximation : advanced problems.
Springer, 1996.
Newman, D. J. Rational approximation to |x|. Michigan
Math. J., 11(1):11â€“14, 03 1964.
Paturi, Ramamohan and Saks, Michael E. Approximating
threshold circuits by rational functions. Inf. Comput.,
112(2):257â€“272, 1994.
Petrushev, P. P. Penco Petrov and Popov, Vasil A. Rational
approximation of real functions. Encyclopedia of mathematics and its applications. Cambridge University Press,
1987.
Poggio, Tomaso, Mhaskar, Hrushikesh, Rosasco, Lorenzo,
Miranda, Brando, and Liao, Qianli. Why and when can
deep â€“ but not shallow â€“ networks avoid the curse of
dimensionality: a review. 2017. arXiv:1611.00740
[cs.LG].
Safran, Itay and Shamir, Ohad. Depth separation in relu
networks for approximating smooth non-linear functions. 2016. arXiv:1610.09887 [cs.LG].
Telgarsky, Matus. Representation benefits of deep feedforward networks. 2015. arXiv:1509.08101v2
[cs.LG].
Telgarsky, Matus. Benefits of depth in neural networks. In
COLT, 2016.
Williamson, Robert C. and Bartlett, Peter L. Splines, rational functions and neural networks. In NIPS, 1991.
Yarotsky, Dmitry. Error bounds for approximations with
deep relu networks. 2016. arXiv:1610.01145
[cs.LG].
Zolotarev, E.I. Application of elliptic functions to the problem of the functions of the least and most deviation from
zero. Transactions Russian Acad. Scai., pp. 221, 1877.

Neural networks and rational functions

A. Deferred material from Section 2
This section collects technical material omitted from Section 2. The first step is to fill in some missing details regarding
Newman polynomials.
A.1. Newman polynomials
Define the Newman polynomial (Newman, 1964)
Nr (x) :=

râˆ’1
Y

âˆš
where Î±r := exp(âˆ’1/ r).

(x + Î±ri )

(A.1)

i=1

Define Ar (x), the Newman approximation to |x|, as

Ar (x) := x

Nr (x) âˆ’ Nr (âˆ’x)
Nr (x) + Nr (âˆ’x)


.

Lemma A.2 (Newman (1964)). Suppose r â‰¥ 5.
â€¢ Nr (x) + Nr (âˆ’x) > 0; in particular, Ar is well-defined over R.
â€¢ Given any b â‰¥ 1,



âˆš
bAr (x/b) âˆ’ |x| â‰¤ 3b exp(âˆ’ r).

sup
xâˆˆ[âˆ’b,+b]

Proof.

â€¢ If x = 0, then Nr (âˆ’x) = Nr (x) =

Qrâˆ’1
i=1

Î±ri > 0. Otherwise x > 0, and note for any i âˆˆ {1, . . . , r âˆ’ 1} that

â€“ x âˆˆ (0, Î±ri ] means |x âˆ’ Î±ri | = Î±ri âˆ’ x < Î±ri + x,
â€“ x > Î±ri means |x âˆ’ Î±ri | = x âˆ’ Î±ri < x + Î±ri .
Together, |x âˆ’ Î±ri | < x + Î±ri , and


râˆ’1

Y


Nr (x) =
(x + Î±ri ) >
|x âˆ’ Î±ri | =  (x âˆ’ Î±ri ) = |Nr (âˆ’x)|.
 i=1

i=1
i=1
râˆ’1
Y

râˆ’1
Y

Since Nr (x) > 0 when x > 0, thus Nr (x) + Nr (âˆ’x) > Nr (x) âˆ’ |Nr (x)| = 0.
Lastly, the case x < 0 follows from the case x > 0 since x 7â†’ Nr (x) + Nr (âˆ’x) is even.
â€¢ For any x âˆˆ [âˆ’b, +b],




âˆš

||x| âˆ’ bAr (x/b)| = b |x/b| âˆ’ Ar (x/b)  = b x/b âˆ’ Ar (x/b) â‰¤ 3b exp(âˆ’ r),
where the last step was proved by Newman (Lorentz et al., 1996, Theorem 7.3.1).

Finally, define
x + bAr (x/b)
RÌƒr,b (x) := Rr (x; b) :=
,
2
âˆš
r,b := 3 exp(âˆ’ r)/2,
Rr,b (x) := (1 âˆ’ 2r,b )RÌƒr,b (x) + br,b .

Neural networks and rational functions

Lemma A.3. If r â‰¥ 5 and b â‰¥ 1 and r,b â‰¤ 1/2, then Rr,b is a degree-r rational function over R, and




sup Ïƒr (x) âˆ’ RÌƒr,b (x) â‰¤ br,b ,
xâˆˆ[âˆ’b,+b]

sup



Ïƒr (x) âˆ’ Rr,b (x) â‰¤ 3br,b .

xâˆˆ[âˆ’b,+b]

If r,b â‰¤ 1, then Rr,b âˆˆ [0, b] along [âˆ’b, +b].
Proof. Let r, b be given, and for simplicity omit the various subscripts. The denominator of RÌƒ is positive over R by
Lemma A.2. Now fix x âˆˆ [âˆ’b, +b]. Using the second part of Lemma A.2,
  x + |x| x + bA(x/b)  1 


âˆš


 = |x| âˆ’ bA(x/b) â‰¤ 3b exp(âˆ’ r)/2 = b.
âˆ’
Ïƒr (x) âˆ’ RÌƒ(x) = 

2
2
2
Next, note that RÌƒ âˆˆ [âˆ’b, b(1 + )]:
RÌƒ(x) â‰¤ Ïƒr (x) + b â‰¤ b(1 + ),

RÌƒ(x) â‰¥ Ïƒr (x) âˆ’ b â‰¥ âˆ’b.

Thus

 

 
Ïƒr (x) âˆ’ R(x) â‰¤ Ïƒr (x) âˆ’ RÌƒ(x) + RÌƒ(x) âˆ’ R(x)




â‰¤ b + 0 + 2RÌƒ(x) âˆ’ b/2
â‰¤ 3b.
Moreover
R(x) = (1 âˆ’ 2)RÌƒ(x) + b â‰¥ (1 âˆ’ 2)(âˆ’b) + b â‰¥ 0,
R(x) â‰¤ (1 âˆ’ 2)b(1 + ) + b â‰¤ b.

A.2. Remaining deferred proofs
The details of converting a ReLU network into a rational network are as follows.
Lemma A.4. Let f : Rd â†’ R be represented by a ReLU network with â‰¤ l layers, and with each node computing a map
z 7â†’ Ïƒr (a> z + b) where kak1 + |b| â‰¤ 1. Then for every  > 0 there exists a function g : Rd â†’ R with |g(x) âˆ’ f (x)| â‰¤ 
for kxkâˆž â‰¤ 1 where g is obtained from f by replacing each ReLU with an r-rational function with r = O(ln(1/)2 ).
Proof of Lemma 1.3. This construction will use the Newman-based approximation R := Rr,b to Ïƒr with degree
O(ln(l/)2 ). By Lemma A.3, this degree suffices to guarantee R(x) âˆˆ [0, 1] and |R(x) âˆ’ Ïƒr (x)| â‰¤ /l for |x| â‰¤ 1.
First note, by induction on layers, that the output of every node has absolute value at most 1. The base case is the
inputs themselves, and thus the statement holds by the assumption kxkâˆž â‰¤ 1. In the inductive step, consider any node
z 7â†’ R(a> z + b), where z is the multivariate input to this node. By the inductive hypothesis, kzkâˆž â‰¤ 1, thus
|a> z + b| â‰¤ kak1 kzkâˆž + |b| â‰¤ 1.
As such, R(a> z + b) âˆˆ [0, 1].
It remains to prove the error bound. For any node, if h : Rd â†’ R denote the function (of the input x) compute by this node,
then let hR denote the function obtained by replacing all ReLUs with R. It will be shown that every node in layer i has
|hR (x) âˆ’ h(x)| â‰¤ i/l when kxkâˆž â‰¤ 1. The base case is the inputs themselves, and thus there is no approximation error,
meaning the bound holds with error 0 â‰¤ 1 Â· /l. Now consider any node in layer i + 1 with i â‰¥ 0, and suppose the claim
holds for nodes in layers i and lower. For convenience, let H denote the multivalued map computed by the previous layer,

Neural networks and rational functions

and HR denote the multivalued map obtained by replacing all activations in earlier layers with R. Since Ïƒr is 1-Lipschitz,
and since the earlier boundedness property grants



 >
a HR (x) + b â‰¤ kak1 kHR (x)kâˆž + |b| â‰¤ 1,
then




|h(x) âˆ’ hR (x)| = Ïƒr (a> H(x) + b) âˆ’ R(a> HR (x) + b)

 


 

â‰¤ Ïƒr (a> H(x) + b) âˆ’ Ïƒr (a> HR (x) + b) + Ïƒr (a> HR (x) + b) âˆ’ R(a> HR (x) + b)




â‰¤ a> H(x) âˆ’ a> HR (x) + /l
â‰¤ kak1 kH âˆ’ HR kâˆž + /l
â‰¤ (i + 1)/l.

Next, collapsing a rational network down into a single rational function is proved as follows.
Lemma A.5. Let f : Rd â†’ R be a rational network with â‰¤ m nodes in each of â‰¤ l layers, and the activation function
has degree r. Then the rational function obtained by collapsing f has degree at most (rm)l .
Proof. Throughout this proof, let R denote the rational activation function at each node, and write R(x) = p(x)/q(x)
where p and q are polynomials of degree at most r. The proof establishes, by induction on layers, that the nodes of layer i
compute rational functions of degree at most (rm)i . The base case is layer 1, where each node computes
Panrational function
of degree r â‰¤ rm. For the case of layer i > 1, fix any node, and denote its computation by h(x) = R( j=1 aj gj (x) + b),
where n â‰¤ m and gj = pj /qj is a rational function of degree at most (rm)iâˆ’1 . Note
ï£¶
ï£«
!
Q
P
Q
X aj pj (x)
b j qj (x) + j aj pj (x) k6=j qk (x)
ï£¸
ï£­
Q
+ b = deg
deg
qj (x)
j qj (x)
j
â‰¤ m(mr)iâˆ’1 .
P
the map f := j aj gj + b is rational of degree m(mr)iâˆ’1 . Let pf and qf denote its numerator and denominator. Since R
P
P
is univariate, its numerator p and denominator q have the form p(x) := jâ‰¤r cj xj and q(x) jâ‰¤r dj xj . Thus, using the
fact that q > 0,
ï£«P
!ï£¶
j
r
c
(p
(x)/q
(x))
q
(x)
j
f
f
f
jâ‰¤r
ï£¸
deg(h(x)) = deg(R(f (x))) = deg ï£­ P
j
qf (x)r
jâ‰¤r dj (pf (x)/qf (x))
!
P
j
râˆ’j
jâ‰¤r cj pf (x) qf (x))
= deg P
â‰¤ rm(rm)iâˆ’1 = (rm)i .
j q (x))râˆ’j
d
p
(x)
j
f
f
jâ‰¤r

The proof of part 2 of Theorem 1.1 now follows by combining Lemmas 1.3, A.3 and A.5.
The last piece is a slighly more detailed account of Theorem 1.2.
Proof of Theorem 1.2. Let âˆ† : R â†’ R denote the triangle function from (Telgarsky, 2015):
ï£±
ï£´
ï£´2x
x âˆˆ [0, 1/2],
ï£²
âˆ†(x) := 2(1 âˆ’ x) x âˆˆ (1/2, 1],
ï£´
ï£´
ï£³0
otherwise.

Neural networks and rational functions

Define the target function f = âˆ†k , which as in (Telgarsky, 2015) has 2k regular-spaced crossings of 0 along [0, 1], and can
be written as a network with 2k layers, each with â‰¤ 2 nodes.
Next consider the rational function g. As in the text, it is necessary to count the zeros of g âˆ’ 1/2 (the case g = 1/2 is
trivial). Writing g = p/q, equivalently this means the zeros of 2p âˆ’ q. Since p and q together have â‰¤ 2kâˆ’2 terms, by
Descartesâ€™ rule of signs, g crosses 1/2 at most 2kâˆ’2 times along (0, 1]. Therefore, following a similar calculation to the
proof in (Telgarsky, 2016, Proof of Theorem 1.1),
!
Z
2(2kâˆ’2 )
1
1
1âˆ’
=
.
|f (x) âˆ’ g(x)| dx â‰¥
k
32
2
64
(0,1]

B. Deferred material from Section 3
B.1. Towards the proof of part 1 of Theorem 1.1
To start, the lemmas due to Yarotsky are slightly adjusted to clip the range to [0, 1].
Proof of Lemma 3.1. Inspecting Yarotskyâ€™s proof, the construction provides g(x) with g(0) = 0 and supxâˆˆ[0,1] |g(x) âˆ’
x2 | â‰¤ . To provide the desired f , it suffices to define f (x) = Ïƒr (g(x)) âˆ’ Ïƒr (g(x) âˆ’ 1).
Proof of Lemma 3.2. First suppose B = 1, let f be as in Lemma 3.1 at resolution /8, and define h via the polarization
identity (as in Yarotskyâ€™s proof):
h(x, y) = 2(f (x/2 + y/2) âˆ’ f (x/2) âˆ’ f (y/2))
(where x/2 appears since f has domain [0, 1]2 ). Since f (0) = 0,
h(x, 0) = 2(f (x/2) âˆ’ f (x/2) âˆ’ 0) = 0,

h(0, y) = 2(f (y/2) âˆ’ 0 âˆ’ f (y/2)) = 0.

Moreover, for any x, y âˆˆ [0, 1]


h(x, y) âˆ’ xy â‰¤ 2 (x/2 + y/2)2 + /8 âˆ’ x2 /4 + /8 âˆ’ y 2 /4 + /8 âˆ’ xy â‰¤ xy + ,


h(x, y) âˆ’ xy â‰¥ 2 (x/2 + y/2)2 âˆ’ /8 âˆ’ x2 /4 âˆ’ /8 âˆ’ y 2 /4 âˆ’ /8 âˆ’ xy â‰¤ xy âˆ’ .
Finally, set gÌƒ(x, y) := Ïƒr (h(x, y)) âˆ’ Ïƒr (h(x, y) âˆ’ 1), which preserves the other properties.
Now consider the case B â‰¥ 1, and set g(x, y) = B 2 g(x/B, y/B). Then (x, y) âˆˆ [0, B]2 implies




g(x, y) âˆ’ xy  = B 2 gÌƒ(x/B, y/B) âˆ’ (x/B)(y/B) â‰¤ B 2 ,
and g âˆˆ [0, B 2 ] over [0, B]2 since gÌƒ âˆˆ [0, 1] over [0, 1]2 .
The full details for the proof of fast exponentiation are as follows.
Proof of Lemma 3.3. This proof constructs a network implementing the russian peasant algorithm for exponentiation:
1. Set v := 1.
2. For b âˆˆ bits-ltr(y) (the bits of y from left to right):
(a) Set v := v 2 .
(b) If b = 1, set v := vx.

Neural networks and rational functions

For example,
4

2

x101012 = ((((12 Â· x)2 )2 Â· x)2 )2 Â· x = x2 Â· x2 Â· x.
The two lines in the inner loop will use the squaring function f from Lemma 3.1 and the multiplication function g from
Lemma 3.2, each with accuracy c where c := 1/y 2 . At the end, the network returns Ïƒr (v) âˆ’ Ïƒr (v âˆ’ 1) to ensure the output
lies in [0, 1]; this procedure can not increase the error. Since the loop is invoke O(ln(y)) times and each inner loop requires
a network of size O(ln(1/(c))) = O(ln(y/)), the full network has size O(ln(y/)2 ).
It remains to show that the network computes a function h which satisfies
h(x) = xy .
Let zj denote the integer corresponding to the first j bits of y when read left-to-right; it will be shown by induction (on the
bits of y from left to right) that, at the end of the jth invocation of the loop,
|v âˆ’ xzj | â‰¤ zj2 c.
This suffices to establish the claim since then |v âˆ’ xy | â‰¤ y 2 c = .
For the base case, consider j = 0; then v = 1 = xz0 = x0 as desired. For the inductive step, let w denote v at the end of
the previous iteration, whereby the inductive hypothesis grants
2
|w âˆ’ xzjâˆ’1 | â‰¤ zjâˆ’1
c.

The error after the approximate squaring step can be upper bounded as

 

f (w) âˆ’ x2zjâˆ’1 â‰¤ f (w) âˆ’ w2 + w2 âˆ’ x2zjâˆ’1


2
â‰¤ c + (xzjâˆ’1 + zjâˆ’1
c)2 âˆ’ x2zjâˆ’1
2
4
â‰¤ c + 2zjâˆ’1
c + zjâˆ’1
c2 2
2
2
â‰¤ c + 2zjâˆ’1
c + zjâˆ’1
c

â‰¤ (2zjâˆ’1 )2 c.
The reverse inequality is proved analogously, thus




f (w) âˆ’ x2zjâˆ’1  â‰¤ (2zjâˆ’1 )2 c.
If the bit b in this iteration is 0, then 2zjâˆ’1 = zj and the proof for this loop iteration is complete. Otherwise b = 1, and
v âˆ’ xzj = g(f (w), x) âˆ’ x2zjâˆ’1 +b
â‰¤ xf (w) + c âˆ’ x2zjâˆ’1 +b


â‰¤ (2zjâˆ’1 )2 + 1 c
â‰¤ (zj )2 c.
The proof of the reverse inequality is analogous, which establishes the desired error bound on v for this loop iteration.
Using the preceding exponentiation lemma, the proof of polynomial approximation is as follows.
Proof of Lemma 3.4. It will be shown momentarily that
 a single monomial term can be approximating to accuracy /s with
a network of size O min{r ln(sr/), d ln(dsr/)2 } . This implies the result by summing â‰¤ s monomials comprising a
polynomial, along with their errors.
For a single monomial, here are two constructions.

Neural networks and rational functions

â€¢ One approach is to product together â‰¤ r individual variables (and lastly multiple by a fixed scalar coefficient), with
no concern of the multiplicities of individual variables. To this end, let (y1 , . . . , yk ) with s â‰¤ r denote coordinates
Qk
of the input variable so that i=1 yi is the desired multinomial. Let g denote multiplication with error 0 := /(rs)
as provided by Lemma 3.2. The network will compute Î±gi (y), where Î± âˆˆ [âˆ’1, +1] is the scalar coefficient on the
monomial, and gi is recursively defined as
gi+1 (y) := f (yi+1 , gi (y))

g1 (y) = y1 ,
It is established by induction that





i
Y


gi (y) âˆ’
yj  â‰¤ j0



j=1
The base case is immediate since g1 (y) = y1 =
gi+1 (y) âˆ’

i+1
Y
j=1

yj = f (yi+1 , gi (y)) âˆ’

i+1
Y

Q1

j=1

yj . For the inductive step,

yj â‰¤ yi+1 gi (y) + 0 âˆ’

j=1

i+1
Y

yj â‰¤ yi+1 (i0 +

j=1

i
Y
j=1

yj ) + 0 âˆ’

i+1
Y

yj â‰¤ (i + 1)0 ,

j=1

and the reverse inequality is proved analogously.
â€¢ Alternatively, the network uses the fast exponentiation routine from Lemma 3.3, and then multiplies together the terms
for individual coordinates. In particular, the exponentiation for each coordinate with accuracy 1 := /(ds) requires
a network of size O(ln(r/1 )2 ). By an analysis similar to the preceding construction, multiplying â‰¤ d such networks
will result in a network approximating the monomial with error /s and size O(d ln(r/1 )2 ).

Next, the proof that ReLU networks can efficiently compute reciprocals, namely Lemma 3.5. As stated in the text, it is
first necessary to establish Lemma 3.6, which gives computes reciprocals at a choice of magnitude, and then Lemma 3.7,
which combines these circuits across scales.
Proof of Lemma 3.7. For each i âˆˆ {1, . . . , n}, define the function
ï£±
zâˆ’aiâˆ’1
ï£´
ï£´
ï£² ai âˆ’aiâˆ’1 z âˆˆ [aiâˆ’1 , ai ],
i+1 âˆ’z
pi (z) := aai+1
z âˆˆ (ai , ai+1 ],
âˆ’ai
ï£´
ï£´
ï£³0
otherwise.
The functions (pi )ni=1 have the following properties.
â€¢ Each pi can be represented by a ReLU network with three nodes in 2 layers.
â€¢ For any x âˆˆ [a1 , an ], there exists j âˆˆ {1, . . . , n} so that i âˆˆ {j, j + 1} implies pi (x) â‰¥ 0 and i 6âˆˆ {j, j + 1} implies
pi (x) = 0. Indeed, it suffices to let j be the smallest element of {1, . . . , n âˆ’ 1}. satisfying x âˆˆ [aj , aj+1 ].
Pn
â€¢ For any x âˆˆ [a1 , an ], i=1 pi (x) = 1.
The family (pi )ni=1 thus forms a partition of unity over [a1 , an ], moreover with the property that at most two elements,
necessarily consecutive, are nonzero at any point in the interval.
Let h : [0, B]2 â†’ [0, B] be a uniform -approximation via ReLU networks to the multiplication map (x, y) 7â†’ xy; by
Lemma 3.2, h has O(ln(B/)) nodes and layers, and moreover the multiplication is exact when either input is 0. Finally,
define g : R â†’ R as
n
X
g(x) :=
h(pi (x), gi (x)).
i=1

Neural networks and rational functions

By construction, g is a ReLU network with O(ln(B/) + maxi ki ) layers and O(n ln(B/) +
It remains
to check the approximation
properties of g.

	
min j âˆˆ {1, n âˆ’ 1} : x âˆˆ [aj , aj+1 ] . Then

Let x

âˆˆ

P

i

mi ) nodes.

[a1 , an ] be given, and set j

:=


 

f (x) âˆ’ g(x) = f (x) âˆ’ h(pj (x), gj (x)) âˆ’ h(pj+1 (x), gj+1 (x))


â‰¤ f (x) âˆ’ pj (x)gj (x) âˆ’ pj+1 (x)gj+1 (x)

 

+ pj (x)gj (x) âˆ’ h(pj (x), gj (x)) + pj+1 (x)gj+1 (x) âˆ’ h(pj+1 (x), gj+1 (x))




â‰¤ pj (x)f (x) âˆ’ gj (x) + pj+1 (x)f (x) âˆ’ gj+1 (x) +  + 
â‰¤ pj (x) + pj+1 (x) + 2.

Proof of Lemma 3.6. Set c := 1/b and r := db ln(1/(a))/ae and 0 := /(r2 c). For i âˆˆ {0, . . . , r}, let hi : [0, 1] â†’ [0, 1]
denote a ReLU network 0 -approximation to the map x 7â†’ xi ; by Lemma 3.3, hi has O(ln(1/0 )2 nodes and layers. Define
q : [0, 1] â†’ R as
r
X
:=
q(x)
c
hi (1 âˆ’ cx).
i=0
2

By construction, q is a ReLU network with O(r ln(1/0 ) ) nodes and O(ln(1/0 )2 ) layers.
For the approximation property of q, let x âˆˆ [a, b] be given, and note


 
 


  X
r
r
X
 




1
1
i
i
q(x) âˆ’  â‰¤ q(x) âˆ’ c

(1 âˆ’ cx)  + c
(1 âˆ’ cx) âˆ’ 



x
x

  i=0
i=0



r 
r
  X
X

c

i
i


â‰¤c
(1 âˆ’ cx) âˆ’
hi (1 âˆ’ cx) âˆ’ (1 âˆ’ cx)  + c

1
âˆ’
(1
âˆ’
cx)


i=0
i=0


 X

âˆž
X
 r

i
i

â‰¤  + c
(1 âˆ’ cx) âˆ’ c
(1 âˆ’ cx) 
 i=0

i=0
=+c

âˆž
X

(1 âˆ’ cx)i

i=r+1

c(1 âˆ’ cx)r+1)
=+
1 âˆ’ (1 âˆ’ cx)
exp(âˆ’cx(r + 1))
â‰¤+
x
exp(âˆ’car)
â‰¤+
a
â‰¤  + .

Proof of Lemma 3.5. Set 0 := /3. For i âˆˆ {1, . . . , k}, Let qÌƒi denote the ReLU network 0 -approximation to 1/x
along [2âˆ’i , 2âˆ’i+1 ]; by Lemma 3.6, qÌƒi has O(k 2 ln(1/)2 ) layers and O(k 3 ln(1/)3 ) nodes. Furthermore, set qi :=
max{2i , min{0, qÌƒi }}, which has the same approximation and size properties of qÌƒi . Applying Lemma 3.7 with B := 2k
and reals ai := 2iâˆ’kâˆ’1 for i âˆˆ {0, . . . , k + 2} and functions (qi )ki=1 , it follows that there exists q : R â†’ R which
-approximates 1/x along [2âˆ’k , 1] with size O(k 2 ln(1/) + k 4 ln(1/)3 ) and depth O(k ln(1/) + k 2 ln(1/)2 ).
Putting the pieces together gives the proof of the second part of the main theorem.

Neural networks and rational functions

Proof of part 1 of Theorem 1.1. Define 0 := /22k+3 , and use Lemmas 3.2, 3.4 and 3.5 to choose ReLU network approximations fp and fq to p and q at resolution 0 , as well as ReLU network f for multiplication along [0, 1]2 and g to
approximate x 7â†’ 1/x along [2âˆ’kâˆ’1 , 1], again at resolution 0 . The desired network will compute the function h, defined
as
h(x) := 2k+1 f (fp (x), 2âˆ’kâˆ’1 g(fq (x))).
Combining the size bounds from the preceding lemmas, h itself has size bound


o

n

2
+ O ln(1/0 ) + O k 4 ln(1/0 )3
O min sr ln(sr/0 ), sd ln(dsr/0 )


n
o
2
2
7
3
= O min srk ln(sr/), sdk ln(dsr/) + k ln(1/) .
Before verifying the approximation guarantee upon h, it is necessary to verify that the inputs to f and g are of the correct
magnitude, so that Lemmas 3.2 and 3.5 may be applied. Note firstly that g(fq (x)) âˆˆ [1, 2k+1 ], since q(x) âˆˆ [2âˆ’k , 1]
implies fq (x) âˆˆ [2âˆ’k âˆ’ 0 , 1] âŠ† [2âˆ’kâˆ’1 , 1]. Thus 2âˆ’kâˆ’1 g(fq (x)) âˆˆ [0, 1], and so both arguments to f within the
definition of h are within [0, 1]. Consequently, the approximation guarantees of Lemmas 3.2, 3.4 and 3.5 all hold, whereby
h(x) âˆ’


 p(x)
p(x)
= 2k+1 f fp (x), 2âˆ’kâˆ’1 g(fq (x)) âˆ’
q(x)
q(x)
p(x)
+ 2k+1 0
â‰¤ fp (x)g(fq (x)) âˆ’
q(x)
fp (x) p(x)
â‰¤
âˆ’
+ fp (x)0 + 2k+1 0
fq (x) q(x)
p(x) + 0
p(x)
â‰¤
+ fp (x)0 + 2k+1 0
âˆ’
q(x) âˆ’ 0
q(x)
p(x)q(x) + q(x)0 âˆ’ p(x)q(x) + p(x)0
â‰¤
+ fp (x)0 + 2k+1 0
q(x)(q(x) âˆ’ 0 )
p(x)0
0
+
+ fp (x)0 + 2k+1 0
=
q(x) âˆ’ 0
q(x)(q(x) âˆ’ 0 )
â‰¤ 2k+1 0 + 22k+1 0 + fp (x)0 + 2k+1 0
â‰¤ .

The proof of the reverse inequality is analogous.
B.2. Proof of Proposition 1.5
Proof of Proposition 1.5. By (Telgarsky, 2015, Lemma 2.1), a ReLU network g with at most m nodes in each of at most
l layers computes a function which is affine along intervals forming a partition of R of cardinality at most N 0 â‰¤ (2m)l .
Further subdivide this collection of intervals at any point where g intersects f (x) = 1/x; since f is convex and g is
affine within each existing piece of the subdivision, then the number of intervals is at most three times as large as before.
Together, the total number of intervals N 00 now satisfies N 00 â‰¤ 3(2m)l . Finally, intersect the family of intervals with
[1/2, 3/4], obtaining a final number of intervals N â‰¤ 3(2m)l .
Let (U1 , . . . , UN ) denote this final partition of [1/2, 3/4], and let (Î´1 , . . . , Î´N ) denote the corresponding interval lengths.
Let S âŠ† {1, . . . , N } index the subcollection of intervals with length at least 1/(8N ), meaning S := {j âˆˆ {1, . . . , N } :
Î´j â‰¥ 1/(8N )}. Then
X
1 X
1
N
1
Î´j = âˆ’
Î´j > âˆ’
= .
4
4 8N
8
jâˆˆS

j6âˆˆS

Consider now any interval Uj with endpoints {a, b}. Since 1/2 â‰¤ a < b â‰¤ 3/4, then f satisfies 128/27 â‰¤ f 00 â‰¤ 16. In
order to control the difference between f and g along Uj , consider two cases: either f â‰¥ g along this interval, or f â‰¤ g
along this interval (these are the only two cases due to the subdivisions above).

Neural networks and rational functions

â€¢ If f â‰¥ g, then g can be taken to be a tangent to f at some point along the interval [a, b] (otherwise, the distance can
always be only decreased by moving g up to be a tangent). Consequently, g(x) := f (c) + f 0 (c)(x âˆ’ c) for some
c âˆˆ [a, b], and by convexity and since f 00 â‰¥ 128/27 over this interval,
Z

b

Z

b

|f (x) âˆ’ g(x)| dx â‰¥ min
câˆˆ[a,b]

a


(f (c) + f 0 (c)(x âˆ’ c) + f 00 (b)(x âˆ’ c)2 /2) âˆ’ (f (c) + f 0 (c)(x âˆ’ c)) dx

a

Z

b

= min
câˆˆ[a,b]



f 00 (b)(x âˆ’ c)2 /2 dx

a

64
â‰¥
min
27 câˆˆ[a,b]

(b âˆ’ c)3 âˆ’ (a âˆ’ c)3
3

!
.



64
min (Î±(b âˆ’ a))3 + ((1 âˆ’ Î±)(b âˆ’ a))3
81 Î±âˆˆ[0,1]
16(b âˆ’ a)3
=
.
81

=

â€¢ On the other hand, if g â‰¥ f , then g passes above the secant line h between (a, f (a)) and (b, f (b)). The area between
f and g is at least the area between f and h, and this latter area is bounded above by a triangle of width (b âˆ’ a) and
height


 1 1 1
f (a) + f (b)
1
âˆ’ f (a + b)/2 =
+ âˆ’
2
2 a b a+b

1
=
b(a + b) + a(a + b) âˆ’ ab
2ab(a + b)

1
â‰¥
b(a + b) + a(a + b) âˆ’ ab
2ab(a + b)
3/2
.
â‰¥
4
Combining this with b âˆ’ a â‰¤ 1/4, the triangle has area at least 3(b âˆ’ a)/16 â‰¥ 3(b âˆ’ a)3 .
Combining these two cases and summing across the intervals of S (where j âˆˆ Sj implies Î´j â‰¥ 1/(8N )),
Z
XZ
|f (x) âˆ’ g(x)| dx
|f (x) âˆ’ g(x)| dx â‰¥
[1/2,3/4]

jâˆˆS

â‰¥

X Î´j3
jâˆˆS

â‰¥

Uj

6

X
1
Î´j
2
6(8N )
jâˆˆS

1
â‰¥
.
27648(2m)2l
If m < (27648)âˆ’1/(2l) /2, then
Z
|f (x) âˆ’ g(x)| dx â‰¥
[1/2,3/4]

1
> .
27648(2m)2l

