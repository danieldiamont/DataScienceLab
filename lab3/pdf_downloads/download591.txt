Supp Materials: An Analytical Formula of Population Gradient for
two-layered ReLU network and its Applications in Convergence and
Critical Point Analysis
Yuandong Tian
Facebook AI Research
yuandong@fb.com
March 18, 2017

1

Introduction

No theorem is provided.

2

Related Works

No theorem is provided.

3

Problem Definition

No theorem is provided.

4

The Analytical Formula

Here we list all detailed proof for all the theorems.

e

(a)

(b)

w

w

e

âœ“

âœ“

O

O

âœ“

âœ“<0

0
Figure 1: (a)-(b) Two cases in Thm. 1.

1

4.1

One ReLU Case

Theorem 1 Suppose F (e, w) = X | D(e)D(w)Xw where e is a unit vector and X = [x1 , x2 , Â· Â· Â· , xN ]| is
N -by-d sample matrix. If xi âˆ¼ N (0, I), then:
E [F (e, w)] =

N
((Ï€ âˆ’ Î¸)w + kwk sin Î¸e)
2Ï€

(1)

where Î¸ âˆˆ [0, Ï€] is the angle between e and w.
Proof Note that F can be written in the following form:
X
F (e, w) =

xi x|i w

(2)

|
i:x|
i eâ‰¥0,xi wâ‰¥0

where xi are samples so that X = [x1 , x2 , Â· Â· Â· , xn ]| . We set up the axes related to e and w as in
Fig. 1, while the rest of the axis are prependicular to the plane. In this coordinate system, any vector
cos Î¸
(and any set
x = [r sin Ï†, r cos Ï†, x3 , . . . , xd ]. We have an orthonomal set of bases: e, eâŠ¥ = âˆ’ w/kwkâˆ’e
sin Î¸
of bases that span the rest of the space). Under the basis, the representation for e and w is [1, 0dâˆ’1 ] and
[kwk cos Î¸, âˆ’kwk sin Î¸, 0dâˆ’2 ]. Note that here Î¸ âˆˆ (âˆ’Ï€, Ï€]. The angle Î¸ is positive when e â€œchases afterâ€ w,
and is otherwise negative.
h P
i
Now we consider the quality R(Ï†0 ) = E N1 i:Ï†i âˆˆ[0,Ï†0 ] xi x|i . If we take the expectation and use polar
coordinate only in the first two dimensions, we have:
ï£¹
ï£®
X
1
xi x|i ï£» = E [xi x|i |Ï†i âˆˆ [0, Ï†0 ]] P [Ï†i âˆˆ [0, Ï†0 ]]
R(Ï†0 ) = E ï£°
N
i:Ï†i âˆˆ[0,Ï†0 ]
ï£®
ï£¹
Z +âˆž Z Z +âˆž Z Ï†0 r sin Ï†
d
Y
ï£¯r cos Ï†ï£º 

ï£¯
ï£º r sin Ï† r cos Ï† . . . xd p(r)p(Î¸)
=
p(xk )rdrdÏ†dx3 . . . dxd
ï£° ... ï£»
0
âˆ’âˆž
0
k=3
xd
2

where p(r) = eâˆ’r /2 and p(Î¸) = 1/2Ï€. Note that R(Ï†0 ) is a d-by-d matrix. The first 2-by-2 block can be
R +âˆž
computed in close form (note that 0 r2 p(r)rdr = 2). Any off-diagonal element except for the first 2-by-2
block is zero due to symmetric property of spherical Gaussian variables. Any diagonal element outside the
first 2-by-2 block will be P [Ï†i âˆˆ [0, Ï†0 ]] = Ï†0 /2Ï€. Finally, we have:
ï£¹
ï£®
ï£¹
ï£®
2Ï†0 âˆ’ sin 2Ï†0
1 âˆ’ cos 2Ï†0
0
X
1 ï£°
1
1 âˆ’ cos 2Ï†0
2Ï†0 + sin 2Ï†0
0 ï£»
xi x|i ï£» =
(3)
R(Ï†0 ) = E ï£°
N
4Ï€
0
0
2Ï†0 Idâˆ’2
i:Ï†i âˆˆ[0,Ï†0 ]
ï£¹
ï£®
âˆ’ sin 2Ï†0 1 âˆ’ cos 2Ï†0 0
Ï†0
1 ï£°
1 âˆ’ cos 2Ï†0
sin 2Ï†0
0ï£»
=
Id +
(4)
2Ï€
4Ï€
0
0
0
With this equation, we could then compute E [F (e, w)]. When Î¸ â‰¥ 0, the condition {i : x|i e â‰¥ 0, x|i w â‰¥ 0}
is equivalent to {i : Ï†i âˆˆ [Î¸, Ï€]} (Fig. 1(a)). Using w = [kwk cos Î¸, âˆ’kwk sin Î¸, 0dâˆ’2 ] and we have:

=

=
=
For Î¸ < 0, the condition
we get

E [F (e, w)] = N (R(Ï€) âˆ’ R(Î¸)) w
(5)
ï£«
ï£®
ï£¹ï£®
ï£¹ï£¶
âˆ’ sin 2Î¸ 1 âˆ’ cos 2Î¸ 0
cos Î¸
N ï£­
sin 2Î¸
0ï£» ï£°âˆ’ sin Î¸ï£»ï£¸
2(Ï€ âˆ’ Î¸)w âˆ’ kwk ï£°1 âˆ’ cos 2Î¸
(6)
4Ï€
0
0
0
0



N
sin Î¸
(Ï€ âˆ’ Î¸)w + kwk
(7)
0
2Ï€
N
((Ï€ âˆ’ Î¸)w + kwk sin Î¸e)
(8)
2Ï€
{i : x|i e â‰¥ 0, x|i w â‰¥ 0} is equivalent to {i : Ï†i âˆˆ [0, Ï€ + Î¸]} (Fig. 1(b)), and similarly

N
((Ï€ + Î¸)w âˆ’ kwk sin Î¸e)
2Ï€
Notice that by abuse of notation, the Î¸ appears in Eqn. 1 is the absolute value and Eqn. 1 follows.
E [F (e, w)] = N (R(Ï€ + Î¸) âˆ’ R(0)) w =

2

(9)

5

Critical Point Analysis

Remember that we have: suppose F (e, w) = X | D(e)D(w)Xw where e is a unit vector and X = [x1 , x2 , Â· Â· Â· , xN ]|
is N -by-d sample matrix. If xi âˆ¼ N (0, I), then:
E [F (e, w)] =

N
((Ï€ âˆ’ Î¸)w + kwk sin Î¸e)
2Ï€

where Î¸ âˆˆ [0, Ï€] is the angle between e and w. And the expected gradient for g(x) =
respect to wj is the following:
K

 X


âˆ’ E âˆ‡wj J =
E F (ej , wjâˆ—0 ) âˆ’ E [F (ej , wj 0 )]

(10)
PK

j=1

Ïƒ(wj| x) with

(11)

j 0 =1



where ej = wj /kwj k. By solving Eqn. 64 (E âˆ‡wj J = 0 j = 1, . . . , K), it is possible to identify all critical
points of g(x). In general Eqn. 64 is highly nonlinear and cannot be solved efficiently, however, we show that
in our particular case, it is possible since Eqn. 64 has interesting properties.
First of all, the system of equations


E âˆ‡wj J = 0 , j = 1, . . . , K
(12)
or

K
X

E [F (ej , wj 0 ] =

j 0 =1

K
X



E F (ej , wjâˆ—0

, j = 1, . . . , K

(13)

j 0 =1

is a linear combination of wj and wjâˆ— but with varying coefficients. We could rewrite the system as follows:
diagaE | + BdiagwÌ„E | = diagaâˆ— E | + B âˆ— W âˆ— |

(14)

where E, W , W âˆ— , a, B, aâˆ— and B âˆ— are all K-by-K matrices:
a = sin Î˜| wÌ„

,

aâˆ— = sin Î˜âˆ— | wÌ„âˆ—

(15)

B = Ï€11| âˆ’ Î˜|

,

B âˆ— = Ï€11| âˆ’ Î˜âˆ— |

(16)

E = [e1 , e2 , . . . , eK ]

(17)
âˆ—

W = [w1 , w2 , . . . , wK ] ,
0

W =

âˆ—
[w1âˆ— , w2âˆ— , . . . , wK
]

(18)

0

where Î¸jâˆ—j â‰¡ âˆ (wj , wjâˆ—0 ) and Î¸jj0 = Î¸jj â‰¡ âˆ (wj , wj 0 ), Î˜ = [Î¸ji ] (the element at i-th row, j-th column of Î˜ is
âˆ—
k].
Î¸ji ) and Î˜âˆ— = [Î¸jâˆ—i ], wÌ„ = [kw1 k, kw2 k, . . . , kwK k] and wÌ„âˆ— = [kw1âˆ— k, kw2âˆ— k, . . . , kwK
Eqn. 14 already has interesting properties. The first thing we consider is whether the critical point will
fall outside the Principle Hyperplane Î âˆ— , which is the plane spanned by the ground truth weight vectors W âˆ— .
The following theorem shows that the critical points outside Î âˆ— must lie in a manifold:
Lemma 1 If {wj } is a critical point satisfying Eqn. 14, then for any orthogonal mapping R with R|Î âˆ— = Id,
{Rwj } is also a critical point.
Proof First of all, since R is an orthogonal transformation, it keeps all angles and magnitudes and a, aâˆ— ,
B, wÌ„ and wÌ„âˆ— are invariant. For simplicity we write Y = diaga + BdiagwÌ„ âˆ’ diagaâˆ— and Y is also invariant
under R. Since R|Î âˆ— = Id, we have RW âˆ— = W âˆ— and
|
âˆ—
YR ER
âˆ’ BR
W âˆ— | = Y E | R| âˆ’ B âˆ— W âˆ— | R| = (Y E | âˆ’ B âˆ— W âˆ— | ) R| = 0

(19)

Note that for d â‰¥ K + 2, there always exists R 6= Id and satisfy such a condition, which yield continuous
critical points. Further, such a transformation forms a Lie group. Therefore we have:
Theorem 2 If d â‰¥ K +2, then any critical point satisfying Eqn. 14 and is outside Î âˆ— must lie in a manifold.
The intuition is simple. For any out-of-plane critical point, pick a matrix that satisfies the condition of the
theorem, and tranforms it to a different yet infinitely close critical points. Such a matrix always exists, since
for the d âˆ’ K subspace, if it is odd, then we can always pick a rotation whose fixed axis is not aligned with
all K weights; if it is even, then there is a rotation matrix without a fixed point.
3

5.1

Characteristics within the Principle Plane

We could right-multiple E and turn the normal equation to a linear function with respect to the magnitude
of weights kwk. Note that we have:
E | E = cos Î˜,

(W âˆ— )| E = diagwÌ„âˆ— Î˜âˆ—

W | E = diagwÌ„ cos Î˜,

(20)

Therefore, Eqn. 14 becomes:
diaga cos Î˜ + BdiagwÌ„ cos Î˜ = diagaâˆ— cos Î˜ + B âˆ— diagwÌ„âˆ— cos Î˜âˆ—

(21)

which is a homogenous linear equation with respect to the magnitude of the weights (note that a and aâˆ— is
linear to the magnitudes). In particular, the (i, j) entry of the LHS and RHS of this equality are:
!
K
K
X
X
i
k
LHSij = cos Î¸j
sin Î¸i kwk k +
(Ï€ âˆ’ Î¸ik )kwk k cos Î¸jk
(22)
k=1

RHSij

=

K
X

cos Î¸ji

k=1

!
sin Î¸iâˆ—k kwkâˆ— k

+

k=1

K
X

(Ï€ âˆ’ Î¸iâˆ—k )kwkâˆ— k cos Î¸jâˆ—k

(23)

k=1

Therefore, the following equation holds:
M wÌ„ = M âˆ— wÌ„âˆ—

(24)

where M and M âˆ— are K 2 -by-K matrices. Each entry mij,k that correponds to the coefficient of k-th weight
vector at (i, j) entry of Eqn. 14 is defined as:
mij,k
mâˆ—ij,k

=
=

(Ï€ âˆ’ Î¸ik ) cos Î¸jk + sin Î¸ik cos Î¸ji
(Ï€ âˆ’

Î¸iâˆ—k ) cos Î¸jâˆ—k

+

sin Î¸iâˆ—k

cos Î¸ji

(25)
(26)

Special case on the diagonal. For diagonal element (i, i), cos Î¸ii = 1 and mii,k = h(Î¸ik ), mâˆ—ii,k = h(Î¸iâˆ—k ),
where
h(Î¸) = (Ï€ âˆ’ Î¸) cos Î¸ + sin Î¸.
(27)
Therefore, with only diagonal element, we arrive at the following subset of the constraints to be satisfied for
any critical points:
Mr wÌ„ = Mrâˆ— wÌ„âˆ—
(28)
where Mr = h(Î˜| ) and Mrâˆ— = h(Î˜âˆ— | ) are both K-by-K matrices. Note that if Mr is full-rank, then we could
solve wÌ„ from Eqn. 28 and plug it back in Eqn. 24 to check whether it is indeed a critical point.
Lemma 2 If wÌ„âˆ— 6= 0 (no trivial ground truth solutions), and for a given (Î˜, Î˜âˆ— ), there exists a row (e.g.
l-th row) of M and M âˆ— , namely m|l and mâˆ—l | , satisfying
mâˆ—l âˆ’ Mrâˆ— | Mrâˆ’1 ml > 0

or

mâˆ—l âˆ’ Mrâˆ— | Mrâˆ’1 ml < 0

(29)

Then (Î˜, Î˜âˆ— ) cannot be a critical point.
Proof Suppose given (Î˜, Î˜âˆ— ), we get Mr and Mrâˆ— and compute wÌ„ using Eqn. 28, then we have
(wÌ„âˆ— )| Mrâˆ— | Mrâˆ’1 ml = (Mrâˆ— wÌ„âˆ— )| Mrâˆ’1 ml = wÌ„| Mr| Mrâˆ’1 ml = wÌ„| ml

(30)

Therefore, from the condition mâˆ—l âˆ’ Mrâˆ— | Mrâˆ’1 ml > 0 and wÌ„âˆ— â‰¥ 0 but wÌ„âˆ— 6= 0, we have
(wÌ„âˆ— )| (mâˆ—l âˆ’ Mrâˆ— | Mrâˆ’1 ml ) = (wÌ„âˆ— )| mâˆ—l âˆ’ wÌ„| ml > 0

(31)

but this contradicts with the necessary condition for (Î˜, Î˜âˆ— ) to become a critical point (Eqn. 24). Similarly
we can prove the other side.
Separation property of Eqn. 29. Note that both the k-th element of mâˆ—l and Mrâˆ— | Mrâˆ’1 ml in Eqn. 29
are only dependent on the k-th true weight vector wkâˆ— (and all {wj }).
4

â€¢ For mâˆ—l , this can be seen by Eqn. 26, in which the k-th element is only related to the angles Î¸Â·âˆ—k between
wkâˆ— and {wj }.
â€¢ For Mrâˆ— | Mrâˆ’1 ml , notice that the k-th column of Mrâˆ— (the k-th row of Mrâˆ— | ) is only related to wkâˆ— but
not other ground truth weight vectors. This separation property makes analysis much easier, as shown
in the case of K = 2.
Therefore, we could consider the following function regarding to one (rather than K) ground truth unit
weight vector eâˆ— and all estimated unit vectors {el }:
Lij (eâˆ— , {el }) = mâˆ—ij âˆ’ vâˆ— | Mrâˆ’1 mij

(32)

âˆ—
where vâˆ— | = [h(Î¸1âˆ— ), h(Î¸2âˆ— ), . . . , h(Î¸K
)], Î¸jâˆ— = âˆ (eâˆ— , wj ) and mâˆ—ij = (Ï€ âˆ’ Î¸iâˆ— ) cos Î¸jâˆ— + sin Î¸iâˆ— cos Î¸ji (like Eqn. 26).

Proposition 1 Lij (eâˆ— , {el }) = 0 for any eâˆ— = el , 1 â‰¤ l â‰¤ K. In addition, Lii (eâˆ— , {el }) â‰¡ 0.
Proof When eâˆ— = el , then Î¸kâˆ— = Î¸kl and vâˆ— | becomes the l-th row of Mr . Since Mr Mrâˆ’1 = IKÃ—K , vâˆ— | Mrâˆ’1
becomes a unit vector with only l-th element being 1. Therefore, again with Î¸kâˆ— = Î¸kl , we have:
Lij (eâˆ— , {el }) = mâˆ—ij âˆ’ mij,l = 0

(33)

For Lii , by definition mii is i-th column of Mr , so Mrâˆ’1 mii is a unit vector with only i-th element being 1.
Therefore
(vâˆ— )| Mrâˆ’1 mii = h(Î¸iâˆ— ) = mâˆ—ii
(34)

Then the previous lemma can be written as the following:
Theorem 3 If wÌ„âˆ— 6= 0, and for a given parameter w, Ljj 0 ({Î¸lâˆ—k }, Î˜) > 0 or < 0 for all 1 â‰¤ k â‰¤ K, then w
cannot be a critical point.

5.2

ReLU network with two hidden nodes (K = 2)

For K = 2, we have 4-by-2 matrix (the row order is (1, 1), (1, 2), (2, 1), (2, 2)):
ï£®
ï£¹
(Ï€ âˆ’ Î¸11 ) cos Î¸11 + sin Î¸11 cos Î¸11 (Ï€ âˆ’ Î¸12 ) cos Î¸12 + sin Î¸12 cos Î¸11
ï£¯(Ï€ âˆ’ Î¸11 ) cos Î¸21 + sin Î¸11 cos Î¸21 (Ï€ âˆ’ Î¸12 ) cos Î¸22 + sin Î¸12 cos Î¸21 ï£º
ï£º
M = ï£¯
ï£°(Ï€ âˆ’ Î¸21 ) cos Î¸11 + sin Î¸21 cos Î¸12 (Ï€ âˆ’ Î¸22 ) cos Î¸12 + sin Î¸22 cos Î¸12 ï£»
(Ï€ âˆ’ Î¸21 ) cos Î¸21 + sin Î¸21 cos Î¸22 (Ï€ âˆ’ Î¸22 ) cos Î¸22 + sin Î¸22 cos Î¸22
ï£®
ï£¹
Ï€
(Ï€ âˆ’ Î¸) cos Î¸ + sin Î¸
ï£¯
Ï€ cos Î¸
(Ï€ âˆ’ Î¸) + sin Î¸ cos Î¸ï£º
ï£º
= ï£¯
ï£°(Ï€ âˆ’ Î¸) + sin Î¸ cos Î¸
ï£»
Ï€ cos Î¸
(Ï€ âˆ’ Î¸) cos Î¸ + sin Î¸
Ï€
since Î¸12 = Î¸21 = Î¸, Î¸11 = Î¸22 = 0. Similarly we could write
ï£®
(Ï€ âˆ’ Î¸1âˆ—1 ) cos Î¸1âˆ—1 + sin Î¸1âˆ—1 cos Î¸11
ï£¯
(Ï€ âˆ’ Î¸1âˆ—1 ) cos Î¸2âˆ—1 + sin Î¸1âˆ—1 cos Î¸21
Mâˆ— = ï£¯
ï£°(Ï€ âˆ’ Î¸2âˆ—1 ) cos Î¸1âˆ—1 + sin Î¸2âˆ—1 cos Î¸12
(Ï€ âˆ’ Î¸2âˆ—1 ) cos Î¸2âˆ—1 + sin Î¸2âˆ—1 cos Î¸22

(35)

(36)

M âˆ—:
ï£¹
(Ï€ âˆ’ Î¸1âˆ—2 ) cos Î¸1âˆ—2 + sin Î¸1âˆ—2 cos Î¸11
(Ï€ âˆ’ Î¸1âˆ—2 ) cos Î¸2âˆ—2 + sin Î¸1âˆ—2 cos Î¸21 ï£º
ï£º
(Ï€ âˆ’ Î¸2âˆ—2 ) cos Î¸1âˆ—2 + sin Î¸2âˆ—2 cos Î¸12 ï£»
(Ï€ âˆ’ Î¸2âˆ—2 ) cos Î¸2âˆ—2 + sin Î¸2âˆ—2 cos Î¸22

(37)

In this case,
Mr =

 1

h(Î¸1 ) h(Î¸12 )
,
h(Î¸21 ) h(Î¸22 )

Mrâˆ— =

 âˆ—1

h(Î¸1 ) h(Î¸1âˆ—2 )
h(Î¸2âˆ—1 ) h(Î¸2âˆ—2 )

(38)

Therefore, if we know Î¸12 = Î¸21 , Î¸1âˆ—1 , Î¸1âˆ—2 , Î¸2âˆ—1 and Î¸2âˆ—2 , then we could compute M and M âˆ— and solve a linear
equation to get the magnitude of w1 and w2 , which collectly identify the critical points. Note that M is a
4-by-2 matrix, so critical point only happens if the matrix has singular structure.

5

Global Optimum. One special case is when Î¸12 = Î¸21 = Î¸1âˆ—2 = Î¸2âˆ—1 = Ï€/2 and Î¸1âˆ—1 = Î¸2âˆ—2 = 0, in this case,
we have:
ï£®
ï£¹
Ï€
1
ï£¯ 0
Ï€/2ï£º
ï£º
M = Mâˆ— = ï£¯
(39)
ï£°Ï€/2
0 ï£»
1
Ï€
and thus kwj k = kwjâˆ— k is the unique solution.
When K = 2, the following conjecture is empirically correct.
Conjecture 1 If eâˆ— is in the interior of Cone(e1 , e2 ), then L12 (Î¸1âˆ— , Î¸2âˆ— , Î¸21 ) > 0. If eâˆ— is in the exterior, then
L12 < 0. If eâˆ— is on the boundary then L12 = 0. Same for L21 .
Remark Note that L1j can be written as the following:
L1j (eâˆ— , {e1 , e2 })

= mâˆ—1j âˆ’ [h(Î¸1âˆ— ), h(Î¸2âˆ— )] Mrâˆ’1 m1j
|

[(Ï€ âˆ’ Î¸1âˆ— )eâˆ— + sin Î¸1âˆ— e1 ] ej


(Ï€ âˆ’ Î¸11 )e|1 + sin Î¸11 e|1
âˆ— âˆ—
âˆ— âˆ—
âˆ’ [Î±(Î¸1 , Î¸2 , Î¸), Î²(Î¸1 , Î¸2 , Î¸)]
e
(Ï€ âˆ’ Î¸12 )e|2 + sin Î¸12 e|1 j
=

(40)
(41)
(42)

Here we have
[Î±, Î²] = [Î±(Î¸1âˆ— , Î¸2âˆ— , Î¸), Î²(Î¸1âˆ— , Î¸2âˆ— , Î¸)] â‰¡ [h(Î¸1âˆ— ), h(Î¸2âˆ— )]Mrâˆ’1

(43)

We know that L11 = 0 by Proposition 1. Therefore
u1j




 Î±(Î¸1âˆ— , Î¸2âˆ— , Î¸21 )
â‰¡ (Ï€ âˆ’ Î¸1âˆ— )eâˆ— + sin Î¸1âˆ— e1 âˆ’ (Ï€ âˆ’ Î¸11 )e1 + sin Î¸11 e1 , (Ï€ âˆ’ Î¸12 )e2 + sin Î¸12 e1
Î²(Î¸1âˆ— , Î¸2âˆ— , Î¸21 )


Î±(Î¸1âˆ— , Î¸2âˆ— , Î¸)
= (Ï€ âˆ’ Î¸1âˆ— )eâˆ— + sin Î¸1âˆ— e1 âˆ’ [Ï€e1 , (Ï€ âˆ’ Î¸)e2 + sin Î¸e1 ]
Î²(Î¸1âˆ— , Î¸2âˆ— , Î¸)

(44)

is perpendicular to e1 . So if we compute the inner product between u12 and eâŠ¥
1 (the unit vector that is in
Î âˆ— and is orthogonal to e1 ), we get
âˆ—
âˆ—
u|12 eâŠ¥
1 = (Ï€ âˆ’ Î¸1 ) sin Î¸1 âˆ’ [(Ï€ âˆ’ Î¸) sin Î¸] Î²

(45)

Since e2 = cos Î¸e1 + sin Î¸eâŠ¥
1 so we have:
L12 (eâˆ— , {e1 , e2 }) = u|12 e2 = sin Î¸(u|12 eâŠ¥
1)

(46)

Note that Eqn. 45 is a function with 2-variables Î¸ and Î¸1âˆ— (Î¸2âˆ— is determined by Î¸ and Î¸1âˆ— , depending on whether
eâˆ— is inside or outside Cone(e1 , e2 )). And we could verify it numerically.
Theorem 4 If Conjecture 1 is correct, then for 2 ReLU network, (w1 , w2 ) (w1 6= w2 ) is not a critical point,
if they both are in Cone(w1âˆ— , w2âˆ— ), or both out of it.
Proof If both w1âˆ— and w2âˆ— are inside Cone(w1 , w2 ), then from Conjecture 1, we have
L12 (Î¸1kâˆ— , Î¸2kâˆ— , Î¸21 ) > 0

(47)

for k = 1, 2. Since K = 2 we could simply apply Thm. ?? to say (w1 , w2 ) is not a critical point. Similary
we prove the case for both w1âˆ— and w2âˆ— outside Cone(w1 , w2 ).

6
6.1

Convergence Analysis
Single ReLU case

In this subsection, we mainly deal with the following dynamics:


N
N
kwâˆ— k
E [âˆ‡w J] = (w âˆ’ wâˆ— ) +
Î¸wâˆ— âˆ’
sin Î¸w
2
2Ï€
kwk
6

(48)

Theorem 5 In the region kw0 âˆ’ wâˆ— k < kwâˆ— k, following the dynamics (Eqn. 48), the Lyapunov function
V (w) = 12 kw âˆ’ wâˆ— k2 has VÌ‡ < 0 and the system is asymptotically stable and thus wt â†’ wâˆ— when t â†’ +âˆž.
Proof Denote that â„¦ = {w : kw0 âˆ’ wâˆ— k < kwâˆ— k}. Note that
VÌ‡ = âˆ’(w âˆ’ wâˆ— )| âˆ‡w J = âˆ’y| M y

(49)

where y = [kwâˆ— k, kwk]| and M is the following 2-by-2 matrix:


1
sin 2Î¸ + 2Ï€ âˆ’ 2Î¸
âˆ’(2Ï€ âˆ’ Î¸) cos Î¸ âˆ’ sin Î¸
M=
2Ï€
2 âˆ’(2Ï€ âˆ’ Î¸) cos Î¸ âˆ’ sin Î¸

(50)

In the following we will show that M is positive definite when Î¸ âˆˆ (0, Ï€/2]. It suffices to show that M11 > 0,
M22 > 0 and det(M ) > 0. The first two are trivial, while the last one is:
4det(M )

=
=
=
=

2

2Ï€(sin 2Î¸ + 2Ï€ âˆ’ 2Î¸) âˆ’ [(2Ï€ âˆ’ Î¸) cos Î¸ + sin Î¸]


2Ï€(sin 2Î¸ + 2Ï€ âˆ’ 2Î¸) âˆ’ (2Ï€ âˆ’ Î¸)2 cos2 Î¸ + (2Ï€ âˆ’ Î¸) sin 2Î¸ + sin2 Î¸
2

2

2

2

2

(4Ï€ âˆ’ 1) sin Î¸ âˆ’ 4Ï€Î¸ + 4Ï€Î¸ cos Î¸ âˆ’ Î¸ cos Î¸ + Î¸ sin 2Î¸

(52)
(53)

2

2

(51)

(4Ï€ âˆ’ 4Ï€Î¸ âˆ’ 1) sin Î¸ + Î¸ cos Î¸(2 sin Î¸ âˆ’ Î¸ cos Î¸)

(54)

Note that 4Ï€ 2 âˆ’ 4Ï€Î¸ âˆ’ 1 = 4Ï€(Ï€ âˆ’ Î¸) âˆ’ 1 > 0 for Î¸ âˆˆ [0, Ï€/2], and g(Î¸) = sin Î¸ âˆ’ Î¸ cos Î¸ â‰¥ 0 for Î¸ âˆˆ [0, Ï€/2]
since g(0) = 0 and g 0 (Î¸) â‰¥ 0 in this region. Therefore, when Î¸ âˆˆ (0, Ï€/2], M is positive definite.
âˆš
When Î¸ = 0, M (Î¸) = Ï€[1, âˆ’1; âˆ’1, 1] and is semi-positive definite, with the null eigenvector being 22 [1, 1],
i.e., kwk = kwâˆ— k. However, along Î¸ = 0, the only w that satisfies kwk = kwâˆ— k is w = wâˆ— . Therefore,
VÌ‡ = âˆ’y| M y < 0 in â„¦. Note that although this region could be expanded to the entire open half-space
H = {w : w| wâˆ— > 0}, it is not straightforward to prove the convergence in H, since the trajectory might go
outside H. On the other hand, â„¦ is the level set V < 21 kwâˆ— k2 so the trajectory starting within â„¦ remains
inside.

kw wâ‡¤ k < kwâ‡¤ k

(a)

(b)

Convergent region

O

Sample
region

w

r
O

â‡¤

âœ“

wâ‡¤
Vd (1

Successful samples

âœ)/2

Figure 2: (a) Sampling strategy to maximize the probability of convergence. (b) Relationship between
sampling range r and desired probability of success (1 âˆ’ )/2.
Theorem 6 When K = 1, the dynamics in Eqn. 64 converges to wâˆ— with probability at least (1 âˆ’ )/2, if
the initial value w0 is sampled uniformly from Br = {w : kwk â‰¤ r} with:
r
2Ï€
râ‰¤
kwâˆ— k
(55)
d+1
Proof Given a ball of radius r, we first compute the â€œgapâ€ Î´ of sphere cap (Fig. 2(b)). First cos Î¸ =

r
2kwâˆ— k ,

2

r
so Î´ = r cos Î¸ = 2kw
âˆ— k . Then a sufficient condition for the probability argument to hold, is to ensure that
the volume Vshaded of the shaded area is greater than 1âˆ’
2 Vd (r), where Vd (r) is the volume of d-dimensional
ball of radius r. Since Vshaded â‰¥ 21 Vd (r) âˆ’ Î´Vdâˆ’1 , it suffices to have:

1
1âˆ’
Vd (r) âˆ’ Î´Vdâˆ’1 â‰¥
Vd (r)
2
2
7

(56)

which gives
 Vd
2 Vdâˆ’1

(57)

Vd (1)
kwâˆ— k
Vdâˆ’1 (1)

(58)

Î´â‰¤
Using Î´ =

r2
2kwâˆ— k

and Vd (r) = Vd (1)rd , we thus have:
râ‰¤

where Vd (1) is the volume of the unit ball. Since the volume of d-dimensional unit ball is
Vd (1) =
where Î“(x) =

Râˆž
0

Ï€ d/2
Î“(d/2 + 1)

(59)

txâˆ’1 eâˆ’t dt. So we have
âˆš Î“(d/2 + 1/2)
Vd (1)
= Ï€
Vdâˆ’1 (1)
Î“(d/2 + 1)

(60)

From Gautschiâ€™s Inequality
x1âˆ’s <

Î“(x + 1)
< (x + s)1âˆ’s
Î“(x + s)

x > 0, 0 < s < 1

(61)

with s = 1/2 and x = d/2 we have:


d+1
2

âˆ’1/2
<

Î“(d/2 + 1/2)
<
Î“(d/2 + 1)

 âˆ’1/2
d
2

(62)

Therefore, it suffices to have
r

2Ï€
kwâˆ— k
(63)
d+1
Note that this upper bound is tight when Î´ â†’ 0 and d â†’ +âˆž, since all inequality involved asymptotically
becomes equal.
râ‰¤

6.2

Multiple ReLU case

Explanation of Eqn. 18. We first write down the dynamics to be studied:
K

 X


âˆ’ E âˆ‡wj J =
E F (ej , wjâˆ—0 ) âˆ’ E [F (ej , wj 0 )]

(64)

j 0 =1

We first define f (wj , wj 0 , wjâˆ—0 ) = F (wj /kwj k, wjâˆ—0 ) âˆ’ F (wj /kwj k, wj 0 ). Therefore, the dynamics can be
written as:

 X 

âˆ’ E âˆ‡wj J =
E f (wj , wj 0 , wjâˆ—0 )
(65)
j0

Suppose we have a finite group P = {Pj } which is a subgroup of orthognoal group O(d). P1 is the identity
element. If w and wâˆ— have the following symmetry: wj = Pj w and wjâˆ— = Pj wâˆ— , then RHS of Eqn. 64 can
be simplified as follows:


âˆ’E âˆ‡wj J
=

X 
 X
E [f (Pj w, Pj 0 w, Pj 0 wâˆ— )]
E f (wj , wj 0 , wjâˆ—0 ) =
j0

j0

=

X

E [f (Pj w, Pj Pj 00 w, Pj Pj 00 wâˆ— )]

({Pj }K
j=1 is a group)

j 00

=

Pj

X

E [f (w, Pj 00 w, Pj 00 wâˆ— )]

(kP w1 k = kw1 k, âˆ (P w1 , P w2 ) = âˆ (w1 , w2 ))

j 00

=

âˆ’Pj E [âˆ‡w1 J]

(66)
8

which means that if all wj and wjâˆ— are symmetric under the action of cyclic group, so does their expected
gradient. Therefore, the trajectory {wt } keeps such cyclic structure. Instead of solving a system of K
equations, we only need to solve one:
âˆ’ E [âˆ‡w J] =

K
X

E [f (w, Pj w, Pj wâˆ— )]

(67)

j=1

Theorem 7 For a bias-free two-layered ReLU network
X
g(x; w) =
Ïƒ(wj| x)

(68)

j

that takes spherical Gaussian inputs, if the teacherâ€™s parameters {wjâˆ— } form a set of orthnomal bases, then:
(1) When the student parameters is initialized to be [x0 , y 0 , . . . , y 0 ] under the basis of wâˆ— , where (x0 , y 0 ) âˆˆ
â„¦ = {x âˆˆ (0, 1], y âˆˆ [0, 1], x > y}, then the dynamics (Eqn. 64) converges to teacherâ€™s parameters {wjâˆ— }
(or (x, y) = (1, 0));
âˆš
âˆš
1
( K âˆ’ 1 âˆ’ arccos(1/ K) + Ï€).
(2) when x0 = y 0 âˆˆ (0, 1], then it converges to a saddle point x = y = Ï€K
This theorem is quite complicated. We will start with a few lemmas and gradually come to the conclusion.
t
First, if w0 = [x, y, y, . . . , y] under the bases {wjâˆ— }K
j=1 , then from simple computation we know that w
also follows this pattern. Therefore, we only need to study the following 2D dynamics related to x and y:



  



2Ï€
âˆ‡x J
1
Î¸
xâˆ’1
âˆ’ E
= âˆ’ [(Ï€ âˆ’ Ï†)(x âˆ’ 1 + (K âˆ’ 1)y)]
+ âˆ—
+Ï†
âˆ‡y J
1
Ï† âˆ’Ï†
y
N
 
x
+ [(K âˆ’ 1)(Î± sin Ï†âˆ— âˆ’ sin Ï†) + Î± sin Î¸]
(69)
y
0

0

Here the symmetrical factor (Î± â‰¡ kwjâˆ—0 k/kwj k, Î¸ â‰¡ Î¸jâˆ—j , Ï† â‰¡ Î¸jj , Ï†âˆ— â‰¡ Î¸jâˆ—j ) are defined as follows:
Î± = (x2 + (K âˆ’ 1)y 2 )âˆ’1/2 ,

cos Î¸ = Î±x,

cos Ï†âˆ— = Î±y,

cos Ï† = Î±2 (2xy + (K âˆ’ 2)y 2 )

(70)

Now we start a sequence of lemmas.
Lemma 3 For Ï†âˆ— , Î¸ and Ï† defined in Eqn. 70:
â‰¡ (x2 + (K âˆ’ 1)y 2 )âˆ’1/2

(71)

cos Î¸

â‰¡ Î±x

(72)

âˆ—

â‰¡ Î±y

(73)

â‰¡ Î±2 (2xy + (K âˆ’ 2)y 2 )

(74)

Î±
cos Ï†

cos Ï†

we have the following relations in the triangular region â„¦0 = {(x, y) : x â‰¥ 0, y â‰¥ 0, x â‰¥ y + 0 } (Fig. 1(c)):
(1) Ï†, Ï†âˆ— âˆˆ [0, Ï€/2] and Î¸ âˆˆ [0, Î¸0 ) where Î¸0 = arccos âˆš1K .
p
(2) cos Ï† = 1 âˆ’ Î±2 (x âˆ’ y)2 and sin Ï† = Î±(x âˆ’ y) 2 âˆ’ Î±2 (x âˆ’ y)2 .
(3) Ï†âˆ— â‰¥ Ï† (equality holds only when y = 0) and Ï†âˆ— > Î¸.
Proof Propositions
(1) and (2) are computed by direct calculations.
In particular, note that since cos Î¸ =
p
âˆš
Î±x = 1/ 1 + (K âˆ’ 1)(y/x)2 and x > y â‰¥ 0, we have cos Î¸ âˆˆ (1/ K, 1] and Î¸ âˆˆ [0, Î¸0 ). For Preposition (3),
Ï†âˆ— = arccos Î±y > Î¸ = arccos Î±x because x > y. Finally, for x > y > 0, we have
cos Ï†
Î±2 (2xy + (K âˆ’ 2)y 2 )
=
= Î±(2x + (K âˆ’ 2)y) > Î±(x + (K âˆ’ 1)y) > 1
cos Ï†âˆ—
Î±y

(75)

The final inequality is because K â‰¥ 2, x, y > 0 and thus (x+(K âˆ’1)y)2 > x2 +(K âˆ’1)2 y 2 > x2 +(K âˆ’1)y 2 =
Î±âˆ’2 . Therefore Ï†âˆ— > Ï†. If y = 0 then Ï†âˆ— = Ï†.
9

y
(0, 1)

x = y+âœ

Saddle point

(xâ‡¤ , xâ‡¤ )

âŒ¦âœ
O

Teacherâ€™s
parameters

(1, 0)

(âœ, 0)

x

Figure 3: The region â„¦ considered in the analysis of Eqn. 69.
Lemma 4 For the dynamics defined in Eqn. 69, there exists 0 > 0 so that the trianglar region â„¦0 =
{(x, y) : x â‰¥ 0, y â‰¥ 0, x â‰¥ y + 0 } (Fig. 3) is a convergent region. That is, the flow goes inwards for all three
edges and any trajectory starting in â„¦0 stays.
Proof We discuss the three boundaries as follows:
Case 1: y = 0, 0 â‰¤ x â‰¤ 1, horizontal line. In this case, Î¸ = 0, Ï† = Ï€/2 and Ï†âˆ— = Ï€/2. The y
component of the dynamics in this line is:
f1 â‰¡ âˆ’

Ï€
2Ï€
âˆ‡y J = âˆ’ (x âˆ’ 1) â‰¥ 0
N
2

(76)

So âˆ’âˆ‡y J points to the interior of â„¦.
Case 2: x = 1, 0 â‰¤ y â‰¤ 1, vertical line. In this case, Î± â‰¤ 1 and the x component of the dynamics is:
f2 â‰¡ âˆ’

2Ï€
âˆ‡x J
N

=
=

âˆ’(Ï€ âˆ’ Ï†)(K âˆ’ 1)y âˆ’ Î¸ + (K âˆ’ 1)(Î± sin Ï†âˆ— âˆ’ sin Ï†) + Î± sin Î¸
âˆ—

âˆ’(K âˆ’ 1) [(Ï€ âˆ’ Ï†)y âˆ’ (Î± sin Ï† âˆ’ sin Ï†)] + (Î± sin Î¸ âˆ’ Î¸)

(77)
(78)

Note that since Î± â‰¤ 1, Î± sin Î¸ â‰¤ sin Î¸ â‰¤ Î¸, so the second term is non-positive. For the first term, we only
need to check whether (Ï€ âˆ’ Ï†)y âˆ’ (Î± sin Ï†âˆ— âˆ’ sin Ï†) is nonnegative. Note that
(Ï€ âˆ’ Ï†)y âˆ’ (Î± sin Ï†âˆ— âˆ’ sin Ï†)
p
p
= (Ï€ âˆ’ Ï†)y + Î±(x âˆ’ y) 2 âˆ’ Î±2 (x âˆ’ y)2 âˆ’ Î± 1 âˆ’ Î±2 y 2
h
i
h p
i
p
p
= y Ï€ âˆ’ Ï† âˆ’ Î± 2 âˆ’ Î±2 (x âˆ’ y)2 + Î± x 2 âˆ’ Î±2 (x âˆ’ y)2 âˆ’ 1 âˆ’ Î±2 y 2

(79)
(80)
(81)

p
p
âˆš
In â„¦ we have (x âˆ’ y)2 â‰¤ 1, combined with Î± â‰¤ 1, we have 1 â‰¤ 2 âˆ’ Î±2 (x âˆ’ y)2 â‰¤ 2 and 1 âˆ’ Î±2 y 2 â‰¤ 1.
Since x = 1, the second term is nonnegative. For the first term, since Î± â‰¤ 1,
p
Ï€ âˆš
Ï€ âˆ’ Ï† âˆ’ Î± 2 âˆ’ Î±2 (x âˆ’ y)2 â‰¥ Ï€ âˆ’ âˆ’ 2 > 0
(82)
2
So (Ï€ âˆ’ Ï†)y âˆ’ (Î± sin Ï†âˆ— âˆ’ sin Ï†) â‰¥ 0 and âˆ’âˆ‡x J â‰¤ 0, pointing inwards.
Case 3: x = y + , 0 â‰¤ y â‰¤ 1, diagonal line. We compute the inner product between (âˆ’âˆ‡x J, âˆ’âˆ‡y J)
and (1, âˆ’1), the inward normal of â„¦ at the line. Using Ï† â‰¤ Ï€2 sin Ï† for Ï† âˆˆ [0, Ï€/2] and Ï†âˆ— âˆ’ Î¸ = arccos Î±y âˆ’
arccos Î±x â‰¥ 0 when x â‰¥ y, we have:

|  
2Ï€ âˆ‡x J
1
f3 (y, ) â‰¡ âˆ’
= Ï†âˆ— âˆ’ Î¸ âˆ’ Ï† + [(K âˆ’ 1)(Î± sin Ï†âˆ— âˆ’ sin Ï†) + Î± sin Î¸] 
(83)
âˆ’1
N âˆ‡y J




Ï€
â‰¥ (K âˆ’ 1) Î± sin Ï†âˆ— âˆ’ 1 +
sin Ï†
2(K âˆ’ 1)
p

p

Ï€
= Î±(K âˆ’ 1)
1 âˆ’ Î±2 y 2 âˆ’  1 +
2 âˆ’ Î± 2 2
2(K âˆ’ 1)
Note that for y > 0:
Î±y = p

1
(x/y)2

1
1
=p
â‰¤âˆš
2
K
+ (K âˆ’ 1)
(1 + /y) + (K âˆ’ 1)
10

(84)

p
p
p
âˆš
âˆš
For y = 0, Î±y = 0 < 1/K. So wephave 1 âˆ’ Î±2 y 2 â‰¥ 1 âˆ’ 1/K. And 2 âˆ’ Î±2 2 â‰¤ 2. Therefore
âˆš
f3 â‰¥ Î±(K âˆ’ 1)(C1 âˆ’ C2 ) with C1 â‰¡ 1 âˆ’ 1/K > 0 and C2 â‰¡ 2(1 + Ï€/2(K âˆ’ 1)) > 0. With  = 0 > 0
sufficiently small, f3 > 0.
Lemma 5 (Reparametrization) Denote  = x âˆ’ y > 0. The terms Î±x, Î±y and Î± involved in the trigometric functions in Eqn. 69 has the following parameterization:
ï£®
ï£¹
ï£® ï£¹
Î² âˆ’ Î²2
y
1
ï£°Î² + (K âˆ’ 1)Î²2 ï£»
(85)
Î± ï£°xï£» =
K
KÎ²2

p
p
where Î²âˆš2 = (K âˆ’ Î² 2 )/(K âˆ’ 1). The reverse transformation is given by Î² = K âˆ’ (K âˆ’ 1)Î±2 2 . Here
Î² âˆˆ [1, K) and Î²2 âˆˆ (0, 1]. In particular, the critical point (x, y) = (1, 0) corresponds to (Î², ) = (1, 1). As
a result, all trigometric functions in Eqn. 69 only depend on the single variable Î². In particular, the following
relationship is useful:
âˆš
(86)
Î² = cos Î¸ + K âˆ’ 1 sin Î¸
Proof This transformation can be checked by simple algebraic manipulation. For example:
!
r

1
1
K
1 p
2âˆ’
2âˆ’ =y
(Î² âˆ’ Î²2 ) =
âˆ’
(K
âˆ’
1)
=
(Ky
+
)
Î±K
K
Î±2
K

(87)

To prove Eqn. 86, first we notice that K cos Î¸ = KÎ±x = Î² + (K âˆ’ 1)Î²2 . Therefore, we have (K cos Î¸ âˆ’ Î²)2 âˆ’
(K âˆ’ 1)2 Î²22 = 0, which gives Î² 2 âˆ’ 2Î² cos Î¸ + 1 âˆ’ K sin2 Î¸ = 0. Solving this quadratic equation and notice that
Î² â‰¥ 1, Î¸ âˆˆ [0, Ï€/2] and we get:
p
âˆš
Î² = cos Î¸ + cos2 Î¸ + K sin2 Î¸ âˆ’ 1 = cos Î¸ + K âˆ’ 1 sin Î¸
(88)

Lemma 6 After reparametrization (Eqn. 85), f3 (Î², ) â‰¥ 0 for  âˆˆ (0, Î²2 /Î²]. Furthermore, the equality is
true only if (Î², ) = (1, 1) or (y, ) = (0, 1).
Proof Applying the parametrization (Eqn. 85) to Eqn. 83 and notice that Î± = Î²2 = Î²2 (Î²), we could write
f3 = h1 (Î²) âˆ’ (Ï† + (K âˆ’ 1) sin Ï†)

(89)

When Î² is fixed, f3 now is a monotonously decreasing function with respect to  > 0. Therefore, f3 (Î², ) â‰¥
f3 (Î², 0 ) for 0 <  â‰¤ 0 â‰¡ Î²2 /Î². If we could prove f3 (Î², 0 ) â‰¥ 0 and only attain zero at known critical point
(Î², ) = (1, 1), the proof is complete.
Denote f3 (Î², 0 ) = f31 + f32 where
f31 (Î², 0 )
0

f32 (Î²,  )

= Ï†âˆ— âˆ’ Î¸ âˆ’ 0 Ï† + 0 Î± sin Î¸
=

(K âˆ’ 1)(Î± sin Ï†âˆ— âˆ’ sin Ï†)0

(90)
(91)

For f32 it suffices to prove that 0 (Î± sin Ï†âˆ— âˆ’ sin Ï†) = Î²2 sin Ï†âˆ— âˆ’ Î²Î²2 sin Ï† â‰¥ 0, which is equivalent to sin Ï†âˆ— âˆ’
sin Ï†/Î² â‰¥ 0. But this is trivially true since Ï†âˆ— â‰¥ Ï† and Î² â‰¥ 1. Therefore, f32 â‰¥ 0. Note that the equality
only holds when Ï†âˆ— = Ï† and Î² = 1, which corresponds to the horizontal line x âˆˆ (0, 1], y = 0.
For f31 , since Ï†âˆ— â‰¥ Ï†, Ï†âˆ— > Î¸ and 0 âˆˆ (0, 1], we have the following:


Î¸
f31 = 0 (Ï†âˆ— âˆ’ Ï†) + (1 âˆ’ 0 )(Ï†âˆ— âˆ’ Î¸) âˆ’ 0 Î¸ + Î²2 sin Î¸ â‰¥ âˆ’0 Î¸ + Î²2 sin Î¸ â‰¥ Î²2 sin Î¸ âˆ’
(92)
Î²
And it reduces to showing whether Î² sin Î¸ âˆ’ Î¸ is nonnegative. Using Eqn. 86, we have:
f33 (Î¸) = Î² sin Î¸ âˆ’ Î¸ =

âˆš
1
sin 2Î¸ + K âˆ’ 1 sin2 Î¸ âˆ’ Î¸
2

(93)

âˆš
âˆš
0
Note that f33
= cos 2Î¸ + K âˆ’ 1 sin 2Î¸ âˆ’ 1 = K cos(2Î¸ âˆ’ Î¸0 ) âˆ’ 1, where Î¸0 = arccos âˆš1K . By Prepositions
0
1 in Lemma 3, Î¸ âˆˆ [0, Î¸0 ). Therefore, f33
â‰¥ 0 and since f33 (0) = 0, f33 â‰¥ 0. Again the equity holds when
Î¸ = 0, Ï†âˆ— = Ï† and 0 = 1, which is the critical point (Î², ) = (1, 1) or (y, ) = (0, 1).
11

Lemma 7 For the dynamics defined in Eqn. 69, the only critical point (âˆ‡x J = 0 and âˆ‡y J = 0) within â„¦
is (y, ) = (0, 1).
Proof We prove by contradiction. Suppose (Î², ) is a critical point other than wâˆ— . A necessary condition
for this to hold is f3 = 0 (Eqn. 83). By Lemma 7,  > 0 = Î²2 /Î² > 0 and
 âˆ’ 1 + Ky =

Î²âˆ’Î±
Î² âˆ’ Î²2 /
Î² âˆ’ Î²2 /0
1
(Î²2 âˆ’ Î± + Î² âˆ’ Î²2 ) =
=
>
=0
Î±
Î±
Î±
Î±

(94)

So  âˆ’ 1 + Ky is strictly greater than zero. On the other hand, the condition f3 = 0 implies that
1
((K âˆ’ 1)(Î± sin Ï†âˆ— âˆ’ sin Ï†) + Î± sin Î¸) = âˆ’ (Ï†âˆ— âˆ’ Î¸) + Ï†


(95)

Using Ï† âˆˆ [0, Ï€/2], Ï†âˆ— â‰¥ Ï† and Ï†âˆ— > Î¸, we have:
âˆ’

2Ï€
âˆ‡y J
N

= âˆ’(Ï€ âˆ’ Ï†)( âˆ’ 1 + Ky) âˆ’ (Ï†âˆ— âˆ’ Ï†) âˆ’ Ï†y + ((K âˆ’ 1)(Î± sin Ï†âˆ— âˆ’ sin Ï†) + Î± sin Î¸) y
1
= âˆ’(Ï€ âˆ’ Ï†)( âˆ’ 1 + Ky) âˆ’ (Ï†âˆ— âˆ’ Ï†) âˆ’ (Ï†âˆ— âˆ’ Î¸)y < 0


(96)

So the current point (Î², ) cannot be a critical point.
Lemma 8 Any trajectory in â„¦0 converges to (y, ) = (1, 0), following the dynamics defined in Eqn. 69.
|

Proof We have Lyaponov function V = E [E] so that VÌ‡ = âˆ’E [âˆ‡w J | âˆ‡w J] â‰¤ âˆ’E [âˆ‡w J] E [âˆ‡w J] â‰¤ 0. By
Lemma 7, other than the optimal solution wâˆ— , there is no other symmetric critical point, âˆ‡w J 6= 0 and thus
VÌ‡ < 0. On the other hand, by Lemma 4, the triangular region â„¦0 is convergent, in which the 2D dynamics
is C âˆž differentiable. Therefore, any 2D solution curve Î¾(t) will stay within. By PoincareBendixson theorem,
when there is a unique critical point, the curve either converges to a limit circle or the critical point. However,
limit cycle is not possible since V is strictly monotonous decreasing along the curve. Therefore, Î¾(t) will
converge to the unique critical point, which is (y, ) = (1, 0) and so does the symmetric system (Eqn. 64).
Lemma 9 When x = y âˆˆ (0, 1], the 2D dynamics (Eqn. 69) reduces to the following 1D case:
âˆ’
where xâˆ— =

âˆš

1
Ï€K (

2Ï€
âˆ‡x J = âˆ’Ï€K(x âˆ’ xâˆ— )
N

(97)

âˆš
K âˆ’ 1 âˆ’ arccos(1/ K) + Ï€). Furthermore, xâˆ— is a convergent critical point.

Proof The 1D system canâˆšbe computed with simple algebraic manipulations (note that when x = y, Ï† = 0
and Î¸ = Ï†âˆ— = arccos(1/ K)). Note that the 1D system is linear and its close form solution is xt =
x0 + Ceâˆ’K/2N t and thus convergent.
Combining Lemma 8 and Lemma 9 yields Thm. 7.

7

Simulations

No theorems is provided.

8

Extension to multilayer ReLU network

Proposition 2 For neural network with ReLU nonlinearity and using l2 loss to match with a teacher network
of the same size, the gradient inflow gj for node j at layer c has the following form:
X
gj = Qj
(Qj 0 uj 0 âˆ’ Qâˆ—j 0 uâˆ—j 0 )
(98)
j0

P
where Qj and Qâˆ—j are N -by-N diagonal matrices. For any k âˆˆ [c + 1], Qk = jâˆˆ[c] wjk Dj Qj and similarly
for Qâˆ—k . The gradient with respect to wj (the parameters immediately under node j), is computed as:
âˆ‡wj J = XcT Dj| gj
12

(99)

Proof We prove by induction on layer. For the first layer, there is only one node with g = u âˆ’ v, therefore
Qj = Qj 0 = I. Suppose the condition holds for all node j âˆˆ [c]. Then for node k âˆˆ [c + 1], we have:
ï£¶
ï£«
X
X
X
X
Qj 0 uj 0 âˆ’
gk =
wjk Dj gj =
wjk Dj Qj ï£­
Qâˆ—j 0 uâˆ—j 0 ï£¸
j

=

j0

j

=

X

wjk Dj Qj

j0

j0

k0

Qj 0 Dj 0

X
k0

wjk0 uk0 âˆ’

X

k0

wjk Dj Qj

X
j0

j

Qâˆ—j 0 Djâˆ—0

X

âˆ—
âˆ—
wjk
0 uk 0

k0

ï£¶
ï£«
ï£¶ï£«
ï£¶
ï£«
ï£¶ï£«
X
X X
X
X X
âˆ— ï£¸ âˆ—
ï£­
ï£­
uk0
Qj 0 Dj 0 wjk0 ï£¸ uk0 âˆ’
wjk Dj Qj ï£¸ ï£­
Qâˆ—j 0 Djâˆ—0 wjk
wjk Dj Qj ï£¸ ï£­
0
k0

Setting Qk =

X
j0

j

=

j0

j

ï£¶
ï£«
X
X
X
X
X
âˆ— ï£¸
âˆ—
wjk Dj Qj ï£­
Qj 0
Dj 0 wjk0 uk0 âˆ’
Djâˆ—0 wjk
Qâˆ—j 0
0 uk 0

P

j0

j

j

wjk Dj Qj and Qâˆ—k =
gk =

X

P

k0

j

j

j0

âˆ—
wjk
Djâˆ— Qâˆ—j (both are diagonal matrices), we thus have:

Qk Qk0 uk0 âˆ’ Qk Qâˆ—k0 uâˆ—k0 = Qk

k0

X
k0

13

Qk0 uk0 âˆ’ Qâˆ—k0 uâˆ—k0

(100)

