Appendix for
â€œOn Mixed Memberships and Symmetric Nonnegative Matrix Factorizationsâ€

Xueyu Mao 1 Purnamrita Sarkar 2 Deepayan Chakrabarti 3

A. Identifiability
Lemma A.1. (Lemma 1.1 of (Minc, 1988)) The inverse of a nonnegative matrix matrix M is nonnegative if and only if
M is a generalized permutation matrix.
Proof of Theorem 2.1. Suppose there are two parameter settings (Î˜(1) , B(1) , Ï(1) ) and (Î˜(2) , B(2) , Ï(2) ) that yield the
same probability matrix:
T

T

P = Ï(1) Î˜(1) B(1) Î˜(1) = Ï(2) Î˜(2) B(2) Î˜(2) .
(1)

(2)

Pick up pure node indices set I1 of Î˜(1) such that Î˜I1 = I, and denote M = Î˜I1 . Similarly, pick up pure node indices
(2)

(1)

set I2 of Î˜(2) such that Î˜I2 = I, and let W = Î˜I2 .
Then
Ï(1) B(1) = Ï(2) MB(2) MT and Ï(1) WB(1) WT = Ï(2) B(2) .
Denote T = MW, then
B(1) =
(2)

1
Ï(1)

MÏ(1) WB(1) WT MT = TB(1) TT .

(1)

(1)

Note that M Â· 1 = Î˜I1 Â· 1 = 1 and W Â· 1 = Î˜I2 Â· 1 = 1, so T Â· 1 = MW Â· 1 = 1. We can consider T as a transition
matrix of a Markov chain, whose states are the nodes of the graph. Keep applying equation (1) to its RHS, we get
T

B(1) = Tk B(1) Tk ,
which implies B(1) = Tâˆ B(1) TTâˆ , where Tâˆ = lim Tk .
kâ†’âˆ

(1)

Given that B has full rank K, we must have Tâˆ has full rank. Now we prove that stationary point of the Markov chain,
Tâˆ , must be identity matrix.
The nodes of a finite-size Markov chain can be split into a finite number of communication classes, and possibly some
transient nodes.
1. If a communication class has at least two nodes and is aperiodic, then the rows corresponding to those nodes in Tâˆ
are the stationary distribution for that class. Hence, Tâˆ has identical rows, so it cannot be full rank.
2. The probability of a Markov chain ending in a transient node goes to zero as the number of iterations k grows, so the
column of Tâˆ corresponding to any transient node is identically zero. Again, this means that Tâˆ cannot be full rank.
1
Department of Computer Science. 2 Department of Statistics and Data Sciences. 3 Department of Information, Risk, and Operations
Management. The University of Texas at Austin, TX, USA. Correspondence to: Xueyu Mao <xmao@cs.utexas.edu>, Purnamrita
Sarkar <purna.sarkar@austin.utexas.edu>, Deepayan Chakrabarti <deepay@utexas.edu>.

Proceedings of the 34 th International Conference on Machine Learning, Sydney, Australia, PMLR 70, 2017. Copyright 2017 by the
author(s).

On Mixed Memberships and Symmetric Nonnegative Matrix Factorizations

Hence, the only configuration in which Tâˆ has full rank is when it contains K communication classes, each with one
node. This implies that Tâˆ = I, and hence T = I. Note that if the communication classes are periodic, we can consider
Tt where t is the product of the periods of all the classes; the matrix Tt is now aperiodic for all the communication classes,
and the above argument still applies to Tâˆ = lim (Tt )k .
kâ†’âˆ

As I = T = MW, M and W have full rank, then Mâˆ’1 = W, which is the case that a nonnegative matrix M has
nonnegative inverse W, using Lemma A.1, we know that M is a generalized permutation matrix, and note that each row
of M sums to 1, the scale goes away and thus M is a permutation matrix, which implies W is also a permutation matrix.
As largest element of B(1) and B(2) are equals as 1, we should have Ï(1) = Ï(2) and thus B(1) = MB(2) MT .
Also since we have
T

(1)

T

(2)

T

Ï(1) B(1) Î˜(1) = Ï(1) Î˜I1 B(1) Î˜(1) = Ï(2) Î˜I1 B(2) Î˜(2) = Ï(2) MB(2) Î˜(2)
T

T

T

= Ï(2) MB(2) MT MÎ˜(2) = Ï(1) B(1) MÎ˜(2) ,
left multiply Ï(1) B(1)

âˆ’1

on both sides, we have Î˜(1) = Î˜(2) MT .

Thus we have shown that MMSB is identifiable up to a permutation.

B. Uniqueness of SNMF for MMSB networks
Lemma B.1 (Huang et al. (2014)). If rank(P) = K, the Symmetric NMF P = WWT is unique if and only if the nonnegative orthant is the only self-dual simplicial cone A with K extreme rays that satisfies cone(WT ) âŠ† A = Aâˆ— , where
Aâˆ— is the dual cone of A, defined as Aâˆ— = {y|xT y â‰¥ 0, âˆ€x âˆˆ A}.
Proof of Theorem 2.2. When B is diagonal, it has a square root C = B1/2 , where C is also a positive diagonal matrix. It
is easy to see that cone(C) is the non-negative orthant RK
+ , so we have
âˆ—

K
cone(WT ) = cone(CT Î˜T ) = cone(CT ) = cone(C) = RK
+ = R+ .

The second equality follows from the fact that Î˜ contains all pure nodes, and other nodes are convex combinations of these
pure nodes. The fourth equality is due to the diagonal form of C.
To see that this is unique, suppose there
is another self-dual simplicial cone satisfying cone(WT ) âŠ† A = Aâˆ— . Then we

âˆ—
K âˆ—
K
have RK
âŠ†
A
and
A
=
A
âŠ†
R
=
RK
+
+
+ , which implies A = R+ .
Hence, by Lemma B.1, an identifiable MMSB model with a diagonal B is sufficient for the Symmetric NMF solution to
be unique and correct.

C. Concentration of the Laplacian
We will use X = c(1 Â± ) to denote X âˆˆ c[1 âˆ’ , 1 + ] for ease of notation from now onwards.
Lemma C.1. For Î˜ âˆˆ RnÃ—K , where each row Î¸i âˆ¼ Dirichlet(Î±), âˆ€j âˆˆ [K],
s
!!
n
X
Î±j
Î±0 log n
Î¸ij = n
1 Â± OP
Î±0
Î±j n
i=1
with probability larger than 1 âˆ’ 1/n3 .
Proof. By using Chernoff bound
 n

!
!
Î±
X
2 n Î±0j
Î±j 
Î±j

Î¸ij âˆ’ n  > n
P 
â‰¤ exp âˆ’
,

Î±0 
Î±0
3
i=1

 q
 P
q
 n
Î±j 
Î±j
n
3
so by setting  = OP 3 nÎ±log
,
Î¸
âˆ’
n
â‰¤
3


ij
i=1
Î±0
Î±0 n log n, with probability larger than 1 âˆ’ 1/n .
j /Î±0

On Mixed Memberships and Symmetric Nonnegative Matrix Factorizations

That is
n
X

Î±j
Â± OP
Î¸ij = n
Î±0
i=1

r

Î±j
n log n
Î±0



Î±j
=n
Î±0

s
1 Â± OP

Î±0 log n
Î±j n

!!
.

Lemma C.2. (Theorem 5.2 of (Lei et al., 2015)) Let A be the adjacency matrix of a random graph on n nodes in which
edges occur independently. Set E[A] = P and assume that n maxi,j Pij â‰¤ d for d â‰¥ c0 log n and c0 > 0. Then, for any
r > 0 there exists a constant C = C(r, c0 ) such that:
âˆš
P(kA âˆ’ Pk â‰¤ C d) â‰¥ 1 âˆ’ nâˆ’r .
Fact C.1. If M is rank k, then kMk2F â‰¤ kkMk2 .
Lemma C.3. (Variant of Davis-Kahan (Yu et al., 2015)). Let P, AÌ‚ âˆˆ RnÃ—n be symmetric, with eigenvalues Î»1 â‰¥ Â· Â· Â· â‰¥ Î»n
and Î»Ì‚1 â‰¥ Â· Â· Â· â‰¥ Î»Ì‚n respectively. Fix 1 â‰¤ r â‰¤ s â‰¤ n, and assume that min(Î»râˆ’1 âˆ’ Î»r , Î»s âˆ’ Î»s+1 ) > 0, where we define
Î»0 = âˆ and Î»n+1 = âˆ’âˆ. Let d = s âˆ’ r + 1, and let V = (vr , vr+1 , Â· Â· Â· , vs ) âˆˆ RnÃ—d and VÌ‚ = (vÌ‚r , vÌ‚r+1 , Â· Â· Â· , vÌ‚s ) âˆˆ
RnÃ—d have orthonormal columns satisfying Pvj = Î»j vj and AÌ‚vÌ‚j = Î»Ì‚j vÌ‚j for j = r, r + 1, Â· Â· Â· , s. Then there exists an
orthogonal matrix OÌ‚ âˆˆ RdÃ—d such that

 
 


 



23/2 min d1/2 AÌ‚ âˆ’ P , AÌ‚ âˆ’ P


F
VÌ‚ âˆ’ VOÌ‚ â‰¤
min(Î»râˆ’1 âˆ’ Î»r , Î»s âˆ’ Î»s+1 )
F
Lemma C.4. (Lemma A.1. of (Tang et al., 2013)). Let H1 , H2 âˆˆ RnÃ—n be positive semidefinite with rank(H1 ) =
rank(H2 ) = K. Let X, Y âˆˆ RnÃ—K be of full column rank such that XXT = H1 and YYT = H2 . Let Î»K (H2 )) be the
smallest nonzero eigenvalue of H2 . Then there exists an orthogonal matrix R âˆˆ RKÃ—K such that:
p

p
âˆš
K kH1 âˆ’ H2 k
kH1 k + kH2 k
kXR âˆ’ YkF â‰¤
.
Î»K (H2 )
Lemma C.5. Recall that AÌ‚1 = VÌ‚1 EÌ‚1 VÌ‚1T and P1 = P(S, S) in Algorithm 1. If Ïn = â„¦(log n), then




p
âˆš




AÌ‚1 âˆ’ P1  = OP ( Ïn), and AÌ‚1 âˆ’ P1  = OP ( KÏn)
F

with probability larger than 1 âˆ’ 1/n3 .
Proof. Lemma C.2 gives the spectral bound of binary symmetric random matrices, in our model,
n
n
n
n
n
max P1 (i, j) â‰¤ max P(i, j) = max ÏÎ¸i BÎ¸jT â‰¤ max ÏÎ¸i IÎ¸jT â‰¤ Ï .
2 i,j
2 i,j
2 i,j
2 i,j
2
Note that we need to use B is diagonal probability matrix and Î¸i , i âˆˆ [ n2 ] has `1 norm 1 and all nonnegative elements for
the last two inequality.
Since Ïn = â„¦(log n), âˆƒc0 â‰¥ 0 that Ï n2 â‰¥ c0 log n2 .
Let d = Ï n2 , then d â‰¥

n
2

maxi,j P1 (i, j) and d â‰¥ c0 log n2 , by Lemma C.2, âˆ€r â‰¥ 0, âˆƒ C > 0 that

P kA1 âˆ’ P1 k â‰¤ C

r
Ï

n
2



n
â‰¥ 1 âˆ’ ( )âˆ’r ,
2

âˆš
where A1 = A(S, S). So kA1 âˆ’ P1 k = OP ( Ïn), specially, taking r = 3 then it is with probability larger than 1âˆ’1/n3 .
Hence

 
 

âˆš
âˆš

 
 

AÌ‚1 âˆ’ P1  â‰¤ AÌ‚1 âˆ’ A1 + A1 âˆ’ P1  â‰¤ AÌ‚1 âˆ’ A1  + kA1 âˆ’ P1 k = ÏƒÌ‚K+1 + OP ( Ïn) = OP ( Ïn),

On Mixed Memberships and Symmetric Nonnegative Matrix Factorizations

âˆš
where ÏƒÌ‚K+1 is the (K + 1)-th eigenvalue of A1 and is OP ( Ïn) by Weylâ€™s inequality.
Since AÌ‚1 and P1 have rank K, then by Fact C.1,




p
âˆš




AÌ‚1 âˆ’ P1  â‰¤ 2K AÌ‚1 âˆ’ P1  = OP ( KÏn).
F

T

n

Lemma C.6 (Concentration of degrees). Denote Î²min = mina Baa . Let P = ÏÎ˜(1) BÎ˜(2) , where Ï, B, Î˜(1) âˆˆ R 2 Ã—K ,
n
and Î˜(2) âˆˆ R 2 Ã—K follow the restrictions of MMSB model. Let D and D be diagonal matrices representing the sample
and population node degrees. Then
p
Dii = OP (Ïn/K), Dii = â„¦(Î²min Ïn/K), and |Dii âˆ’ Dii | = OP ( Ïn log n/K)
with probability larger than 1 âˆ’ OP (1/n3 ).
Proof. âˆ€i âˆˆ [ n2 ], we have
Dii =

n/2
X

Pij =

n/2 K
X
X

j=1

=

Ïn
2K

(2)

j=1 `=1
(1)
`=1 Î¸i` Î±l

PK
= Ïn

(1)

ÏÎ¸i` B`` Î¸j` â‰¤

Î±0
1 + OP

K
X

(1)

ÏÎ¸i`

n/2
X

(2)

Î¸j` = Ï

j=1

`=1

K
X

(1)

Î¸i`

n/2
X

(2)

Î¸j`

(maxa Baa = 1 by definition)

j=1

`=1

!!
r
1
Î±0 log n
+ OP
2
Î±l n
!!
r
K log n
,
n

(from Lemma C.1)
(when Î±k =

Î±0
K , âˆ€k

âˆˆ [K])

so Dii = OP (Ïn/K).
Similarly,
Dii â‰¥

K
X

(1)

Î²min ÏÎ¸i`

n/2
X

(2)

Î¸j` = Î²min Ï

j=1

`=1

1
+ OP
2

Î±0

Î²min
=
Ïn 1 + OP
2K

(1)

Î¸i`

r

K log n
n

n/2
X

(2)

Î¸j`

j=1

`=1

(1)
`=1 Î¸i` Î±l

PK
= Î²min Ïn

K
X

r

Î±0 log n
Î±l n

!!
(from Lemma C.1)

!!
,

(when Î±l =

Î±0
K , âˆ€l)

so Dii = â„¦(Î²min Ïn/K).
Then using Chernoff bound, we have
 2

 Dii
P (|Dii âˆ’ Dii | > Dii ]) â‰¤ exp âˆ’
,
3
 q

p
log n
so when  = OP 3 K Ïn
, |Dii âˆ’ Dii | â‰¤ Dii = OP ( Ïn log n/K) with probability at least 1 âˆ’ 1/n3 . Note we
have used Lemma C.1, so in total it is with probability larger than 1 âˆ’ OP (1/n3 ).

Lemma C.7. Denote Î²min = mina Baa . If Ïn = â„¦(log n), then
Î»K (P1 ) = â„¦(Î²min Ïn/K),

Î»1 (P1 ) = OP (Ïn/K)

Î»K (A1 ) = â„¦(Î²min Ïn/K),

Î»1 (A1 ) = OP (Ïn/K)

and

2

3

with probability larger than 1 âˆ’ OP (K /n ).

On Mixed Memberships and Symmetric Nonnegative Matrix Factorizations

Proof. For conciseness, we will omit the subscript 1 (see Lemma C.5) in the following proof without loss of generality.
The K-th eigenvalue of P is
Î»K (P) = Î»K (ÏÎ˜BÎ˜T ) = Î»K (ÏÎ˜B1/2 B1/2 Î˜T ) = Î»K (ÏB1/2 Î˜T Î˜B1/2 ).
Here we consider Î¸i as a random variable. Denote
n/2

MÌ‚ =
then MÌ‚ab =

1
n/2

âˆš

Î²a Î²b

Pn/2
i=1

1
1 X
ÏB1/2 Î˜T Î˜B1/2 =
ÏB1/2 Î¸iT Î¸i B1/2 ,
n/2
n/2 i=1

ÏÎ¸ia Î¸ib .

Consider Î¸i âˆ¼ Dirichlet(Î±), then
E[Î¸ia Â· Î¸ib ] =
so E[MÌ‚ab ] =

âˆš

(
Cov[Î¸ia , Î¸ib ] + E[Î¸ia ] Â· E[Î¸ib ] =
2

Var[Î¸ia ] + E [Î¸ia ] =

Î±a Î±b
Î±0 (Î±0 +1) ,

Î±a (Î±a +1)
Î±0 (Î±0 +1) ,

if a 6= b
if a = b

Î²a Î²b ÏE[Î¸ia Â· Î¸ib ] â‰¤ Ï. And
E[MÌ‚] = Ï(diag(BÎ±) + B1/2 Î±Î±T B1/2 )/(Î±0 (Î±0 + 1)).

Using Chernoff bound, we have



2 n E[MÌ‚ab ]


P MÌ‚ab âˆ’ E[MÌ‚ab ] > E[MÌ‚ab ] â‰¤ exp âˆ’ 2
3
so when  = OP

q

18 log n
Ïn

!

2 Ïn
â‰¤ exp âˆ’
6



,


 


, MÌ‚ab âˆ’ E[MÌ‚ab ] â‰¤ E[MÌ‚ab ] with probability larger than 1 âˆ’ 1/n3 . Thus
q

 


 

MÌ‚ âˆ’ E[MÌ‚] â‰¤ MÌ‚ âˆ’ E[MÌ‚] â‰¤ K 2 2 E2 [MÌ‚ab ] â‰¤ KÏ.
F

Note that
Î»K (E[MÌ‚]) = ÏÎ»K (diag(BÎ±) + B1/2 Î±Î±T B1/2 )/(Î±0 (Î±0 + 1))


â‰¥ Ï Î»K (diag(BÎ±)) + Î»K (B1/2 Î±Î±T B1/2 ) /(Î±0 (Î±0 + 1))


= Ï min Î²a Î±a + 0 /(Î±0 (Î±0 + 1))
a

mina Î²a Î±a
=Ï
Î±0 (Î±0 + 1)
Î²min Ï
,
=
K(Î±0 + 1)

(when Î±a =

Î±0
K , âˆ€a)

the first inequality is by definition of the smallest eigenvalue and property of min function; the second equality is by the
smallest eigenvalue of a K Ã— K rank-1 matrix (K > 1) is 0.
By Weylâ€™s inequality,

 


 

Î»K (MÌ‚) âˆ’ Î»K (E[MÌ‚]) â‰¤ MÌ‚ âˆ’ E[MÌ‚] = OP

r
K

Ï log n
n

!
,

so
n
n
Î»K (P) = Î»K (MÌ‚) â‰¥
2
2

Î²min Ï
âˆ’ OP
K(Î±0 + 1)

r
K

Ï log n
n

!!

On Mixed Memberships and Symmetric Nonnegative Matrix Factorizations

with probability larger than 1 âˆ’ K 2 /n3 , and thus Î»K (P) = â„¦(Î²min Ïn/K).
With similar argument we can get


Î±0
kÎ²k1 /(K(Î±0 + 1))
Î»1 (E[MÌ‚]) â‰¤ Ï 1 +
K
â‰¤ Ï (1 + Î±0 ) /(K(Î±0 + 1))
Ï
= ,
K
then Î»1 (P) = OP (Ïn/K).
From Weylâ€™s inequality, we have
âˆš
|Î»i (A) âˆ’ Î»i (P)| â‰¤ kA âˆ’ Pk = OP ( Ïn) ,
so
âˆš
Î»K (A) â‰¥ Î»K (P) âˆ’ OP ( Ïn) =â‡’ Î»K (A) = â„¦(Î²min Ïn/K)
âˆš
Î»1 (A) â‰¤ Î»K (P) + OP ( Ïn) =â‡’ Î»1 (A) = OP (Ïn/K) .

Lemma C.8. If Ïn = â„¦(log n), âˆƒ orthogonal matrix OÌ‚1 âˆˆ RKÃ—K ,




K 3/2


VÌ‚1 âˆ’ V1 OÌ‚1  = OP
âˆš
Î²min Ïn
F
with probability larger than 1 âˆ’ OP (K 2 /n3 ).
Proof. From Lemma C.7 we know that
Î»K (P1 ) = â„¦(Î²min Ïn/K)
with probability larger than 1 âˆ’ OP (K 2 /n3 ). Because P1 has rank K, its K + 1 eigenvalue is 0, and the gap between
the K-th and (K + 1)-th eigenvalue of P1 is Î´ = â„¦(Î²min Ïn/K). Using variant of Davis-Kahanâ€™s theorem (Lemma C.3),
setting r = 1, s = K, then d = K is the interval corresponding to the first K principle eigenvalues of P1 , we have
âˆƒ OÌ‚1 âˆˆ RKÃ—K ,
 
 
âˆš 

 



23/2 min
K AÌ‚1 âˆ’ P1  , AÌ‚1 âˆ’ P1 


F
,
VÌ‚1 âˆ’ V1 OÌ‚1  â‰¤
Î´
F
using Lemma C.5,
 3/2 âˆš





2
KÏn
K 3/2


VÌ‚
âˆ’
V
OÌ‚
=
O
=
O
 1
âˆš
1 1
P
P
Î²min Ïn/K
Î²min Ïn
F
with probability larger than 1 âˆ’ OP (K 2 /n3 ).

Lemma C.9. If Ïn = â„¦(log n), then the orthogonal matrix OÌ‚1 âˆˆ RKÃ—K of Lemma C.8 satisfies


p


EÌ‚1 âˆ’ OÌ‚T1 E1 OÌ‚1  = OP ( KÏn/Î²min )
F

with probability larger than 1 âˆ’ OP (K 2 /n3 ).

On Mixed Memberships and Symmetric Nonnegative Matrix Factorizations

Proof. We have




p




VÌ‚1 EÌ‚1 VÌ‚1T âˆ’ V1 E1 V1T  = AÌ‚1 âˆ’ P1  = OP ( KÏn)
F

F

3

with probability larger than 1 âˆ’ 1/n by Lemma C.5, and




K 3/2


VÌ‚1 âˆ’ V1 OÌ‚1  = OP
âˆš
Î²min Ïn
F
with probability larger than 1 âˆ’ OP (K 2 /n3 ) by Lemma C.8. Also,



 

VÌ‚1 EÌ‚1 VÌ‚1T âˆ’ V1 E1 V1T = VÌ‚1 EÌ‚1 âˆ’ OÌ‚T1 E1 OÌ‚1 VÌ‚1T + VÌ‚1 OÌ‚T1 E1 OÌ‚1 VÌ‚1T âˆ’ V1T + VÌ‚1 OÌ‚T1 âˆ’ V1 E1 V1T .
So

 







EÌ‚1 âˆ’ OÌ‚T1 E1 OÌ‚1  = VÌ‚1 EÌ‚1 âˆ’ OÌ‚T1 E1 OÌ‚1 VÌ‚1T 
F
F













T
T
T
T
â‰¤ VÌ‚1 EÌ‚1 VÌ‚1 âˆ’ V1 E1 V1  + VÌ‚1 OÌ‚1 E1 OÌ‚1 VÌ‚1 âˆ’ V1T  +  VÌ‚1 OÌ‚T1 âˆ’ V1 E1 V1T 
F
F
F


p

T
â‰¤OP ( KÏn) + 2 kE1 k VÌ‚1 âˆ’ V1 OÌ‚1 
F


p
K 3/2
Ïn
=OP ( KÏn) + OP
Â·
âˆš
K Î²min Ïn
p

=OP
KÏn/Î²min ,
with probability larger than 1 âˆ’ OP (K 2 /n3 ).
Lemma C.10. If Ïn = â„¦(log n), then âˆƒ an orthogonal matrix R1 âˆˆ RKÃ—K , together with the orthogonal matrix OÌ‚ âˆˆ
RKÃ—K of Lemma C.8 satisfies





1/2
1/2 
2
R1 E1 OÌ‚1 âˆ’ EÌ‚1  = OP K 3/2 /Î²min
F

with probability larger than 1 âˆ’ OP (K 2 /n3 ).
Proof. From Lemma C.9 we have




p





KÏn/Î²min .
OÌ‚1 EÌ‚1 OÌ‚T1 âˆ’ E1  = EÌ‚1 âˆ’ OÌ‚T1 E1 OÌ‚1  = OP
F

2

F

3

with probability larger than 1 âˆ’ OP (K /n ).
By Lemma C.4, there exists an orthogonal matrix R1 âˆˆ RdÃ—d such that:

 r
 p
âˆš 




T
T
K OÌ‚1 EÌ‚1 OÌ‚1 âˆ’ E1 
OÌ‚1 EÌ‚1 OÌ‚1  + kE1 k



1/2
1/2 
OÌ‚1 EÌ‚1 R1 âˆ’ E1  â‰¤
Î»K (E)
F
âˆš

p Ïn 
p Ïn 
âˆš
K Â· OP
KÏn/Î²min OP
K + OP
K
â‰¤
â„¦(Î²min Ïn/K)


2
â‰¤ OP K 3/2 /Î²min
.

(from Lemma C.7)

Note that







 1/2


1/2
1/2 
1/2
1/2
1/2 
R1 E1 OÌ‚1 âˆ’ EÌ‚1  = E1 âˆ’ RT1 EÌ‚1 OÌ‚T1  = OÌ‚1 EÌ‚1 R1 âˆ’ E1  ,
F

F

so





1/2
1/2 
2
.
R1 E1 OÌ‚1 âˆ’ EÌ‚1  = OP K 3/2 /Î²min
F

F

On Mixed Memberships and Symmetric Nonnegative Matrix Factorizations

Proof of Lemma 4.1. Note that if Î± = u1, u > 0, then
D21 (i, i) =

X

X

ÏÎ¸ia Baa Î¸ja =

aâˆˆ[K],jâˆˆS

ÏÎ¸ia Baa

X
jâˆˆS

aâˆˆ[K]

Î¸ja

Ïn X
Î¸ia Baa
=
2K

r
1 Â± OP

aâˆˆ[K]

K log n
n

!!
.

(by Lemma C.1)
Because
"
#
2

P
2
âˆš
2
Ï aâˆˆ[K] Î¸ia
Baa
Ï eTi Î˜2 B1/2 F
1
1

âˆ’1/2
T
1/2 
p
p
,
âˆˆ Ïn P
 Ï Â· ei D21 Î˜2 B  =
D21 (i, i)
F
aâˆˆ[K] Î¸ia Baa 1 + OP ( K log n/n) 1 âˆ’ OP ( K log n/n)
2K
P
2
i
h
p
p
2K
aâˆˆ[K] Î¸ia Baa
=
1 âˆ’ OP ( K log n/n), 1 + OP ( K log n/n) ,
Â·P
n
aâˆˆ[K] Î¸ia Baa
also note that
P
2
2K
2K
2K
aâˆˆ[K] Î¸ia Baa
Â·P
Â· max Î¸ia â‰¤
,
â‰¤
a
n
n
n
Î¸
B
ia
aa
aâˆˆ[K]
where the first inequality is an equality when âˆ€k âˆˆ [K], Î¸ik = maxa Î¸ia or 0. The second inequality becomes an equality
when maxa Î¸ia = 1 (i.e. i is a pure node). This implies that the LHS of the above equation equals 2K/n if and only if i
corresponds to a pure node. Then we have
âˆš
2


p
2K


âˆ’1/2
Â· max Î¸ia 1 + OP ( K log n/n) ,
 Ï Â· eTi D21 Î˜2 B1/2  â‰¤
a
n
F
and


P
2
2
âˆš
2
 2K P
p
2K
aâˆˆ[K] Î¸ia Baa 
aâˆˆ[K] Î¸ia Baa

âˆ’1/2
T
1/2 
Â·P
Â·P
Â· OP ( K log n/n)
 Ï Â· ei D21 Î˜2 B  âˆ’
=

n
n
F
aâˆˆ[K] Î¸ia Baa 
aâˆˆ[K] Î¸ia Baa


2K p
= OP
Â· K log n/n
n
with probability larger than 1 âˆ’ O(1/n3 ).

2
âˆš

âˆ’1/2
So  Ï Â· eTi D21 Î˜2 B1/2  concentrates around
F

2K
n

for pure nodes. Note that we implicitly assume that the impure

nodes have maxa Î¸ia bounded away from one, and hence have norm bounded away from 2K/n.

Proof of Theorem 4.2. Denote Î˜1 = Î˜(S, :) and Î˜2 = Î˜(SÌ„, :). Denote A12 = A(S, SÌ„) and A21 = A(SÌ„, S), D12
âˆ’1/2
âˆ’1/2
âˆ’1/2
and D21 are the (row) degree matrix of A12 and A21 . GeoNMF projects D21 A21 onto VÌ‚1 EÌ‚1 , and D12 A12 onto
âˆ’1/2
VÌ‚2 EÌ‚2 .
Now, V1 E1 V1T = P1 = ÏÎ˜1 BÎ˜T1 , with both E1 and B diagonal. This imples that there exists an orthogonal matrix Q1
âˆš
1/2
such that V1 E1 Q1 = Ï Â· Î˜1 B1/2 (by Lemma A.1 of (Tang et al., 2013)).
Also, as shown in Lemmas C.8 and C.10, there exists orthogonal matrices OÌ‚1 and and R1 such that




K 3/2


,
VÌ‚1 âˆ’ V1 OÌ‚1  = OP
âˆš
Î²min Ïn
F
with probability larger than 1 âˆ’ O(K 2 /n3 ).

and






1/2
1/2 
2
R1 E1 OÌ‚1 âˆ’ EÌ‚1  = OP K 3/2 /Î²min
F

On Mixed Memberships and Symmetric Nonnegative Matrix Factorizations

Then we have:


âˆš

 T
âˆ’1/2
âˆ’ Ï Â· eTi Î˜2 B1/2 QT1 RT1 
ei P21 V1 OÌ‚1 EÌ‚1
F


âˆš

âˆ’1/2
T
T
T
1/2 T T 
= Ï Â· ei Î˜2 BÎ˜1 V1 OÌ‚1 EÌ‚1
âˆ’ Ï Â· ei Î˜2 B Q1 R1 
F




âˆš


âˆ’1/2
1/2 T
T
1/2
T
B Î˜1 V1 OÌ‚1 EÌ‚1
âˆ’ Ï Â· ei Î˜2 B1/2 QT1 RT1 
= Ï Â· ei Î˜2 B

F

T

âˆš 
1/2
âˆ’1/2
T
1/2
T
1/2
T
T
V1 E1 Q1 V1 OÌ‚1 EÌ‚1
= ÏÂ·
âˆ’ ei Î˜2 B Q1 R1 
ei Î˜2 B

F




âˆš  T
1/2
âˆ’1/2
1/2 T T
T
1/2 T T 
âˆ’ ei Î˜2 B Q1 R1 
= Ï Â· ei Î˜2 B Q1 R1 R1 E1 OÌ‚1 EÌ‚1
F
âˆš




1/2
1/2
âˆ’1/2 
T
1/2 T T
=  Ï Â· ei Î˜2 B Q1 R1 R1 E1 OÌ‚1 âˆ’ EÌ‚1
EÌ‚1 
F


 
âˆš

1/2
1/2   âˆ’1/2 
T
1/2 T T  
â‰¤  Ï Â· ei Î˜2 B Q1 R1  R1 E1 OÌ‚1 âˆ’ EÌ‚1  EÌ‚1 
F
s
!
âˆš



K

T
1/2 T T 
3/2
2
â‰¤  Ï Â· ei Î˜2 B Q1 R1  Â· OP K /Î²min Â· OP
Î²min Ïn
F

(by P21 = ÏÎ˜2 BÎ˜T1 )

(by Lemma A.1 of (Tang et al., 2013))

(by Lemmas 4.1, C.6, C.7 and C.10)



âˆš

âˆš




âˆ’1/2
=â‡’ eTi P21 V1 OÌ‚1 EÌ‚1
âˆ’ Ï Â· eTi Î˜2 B1/2 QT1 RT1  =  Ï Â· eTi Î˜2 B1/2 QT1 RT1  Â· OP
F

F

K2
5/2 âˆš

!
.

(2)

Î²min Ïn

Now that


âˆš

 T âˆ’1/2
âˆ’1/2
âˆ’1/2
âˆ’ Ï Â· eTi D21 Î˜2 B1/2 QT1 RT1 
ei D21 A21 VÌ‚1 EÌ‚1
F

 p

p
 âˆš


âˆ’1/2
â‰¤ eTi A21 VÌ‚1 EÌ‚1
1 + OP
K log n/nÏ âˆ’ Ï Â· eTi Î˜2 B1/2 QT1 RT1  / D21 (i, i)

(by Lemma C.6)

F


p
  h


i
âˆš
 T

âˆ’1/2
1 + OP
K log n/nÏ Â· ei (A21 âˆ’ P21 ) VÌ‚1 + P21 VÌ‚1 âˆ’ V1 OÌ‚1 + P21 V1 OÌ‚1 EÌ‚1
âˆ’ Ï Â· eTi Î˜2 B1/2 QT1 RT1 
F
p
â‰¤
D21 (i, i)

 p
 âˆš
p


+ OP
K log n/nÏ Â·  Ï Â· eTi Î˜2 B1/2 QT1 RT1  / D21 (i, i)
F






p
 n
 T

âˆ’1/2 
âˆ’1/2 
â‰¤ 1 + OP
K log n/nÏ Â· ei (A21 âˆ’ P21 ) VÌ‚1 EÌ‚1  + eTi P21 VÌ‚1 âˆ’ V1 OÌ‚1 EÌ‚1 
F

 o p F
 p

âˆš
 T
âˆ’1/2
T
1/2 T T 
2
+ ei P21 V1 OÌ‚1 EÌ‚1
âˆ’ Ï Â· ei Î˜2 B Q1 R1  / D21 (i, i) + OP K log n/n Ï
F


â‰¤ 1 + OP



 (

p
1 p
K log n/nÏ
Â· OP
Klog n Â· OP

(by Lemmas 4.1 and C.6)
s

K

!

(by Azumaâ€™s and Lemma C.7)
Î²min
Î²min Ïn
s
!)
r 


p
Ïn
K 3/2
K
+OP
Â· OP
Â· OP
/ Î²min Ïn/K
(by Lemmas C.6, C.8, and Eq. (2))
âˆš
K
Î²min Ïn
Î²min Ïn
!
r
 p

2K
K2
2Ï
+
Â· OP
+
O
K
log
n/n
P
5/2 âˆš
n
Î²min Ïn
!
âˆš
K 5/2 log n
=OP
.
5/2
Î²min Ïn

2


In the last step we use the fact that eTi (A21 âˆ’ P21 ) VÌ‚1  is a sum of K projections of eTi (A21 âˆ’ P21 ) on a fixed
F
unit
come from the different partition of the graph). Now Azumaâ€™s inequality gives
 vector (since the eigenvectors
âˆš
 T

ei (A21 âˆ’ P21 ) VÌ‚1  = OP ( K log n) with probability larger than 1 âˆ’ O(1/n3 ).
F

On Mixed Memberships and Symmetric Nonnegative Matrix Factorizations

Now as

2
âˆš
2
Ï eTi Î˜2 B1/2 F
Ï Â· eTi Î˜2 BÎ˜T2 ei

âˆ’1/2
T
1/2 
=
 Ï Â· ei D21 Î˜2 B  =
D21 (i, i)
D21 (i, i)
F


 
P2 (i, i)
Ï
K
=
=â„¦
= OP
,
D21 (i, i)
Ïn/K
n
let O = QT1 RT1 , then âˆ€i,


âˆš

 T âˆ’1/2
âˆ’1/2
âˆ’1/2
âˆ’ Ï Â· eTi D21 Î˜2 B1/2 O 
ei D21 A21 VÌ‚1 EÌ‚1
F


= OP

âˆš
âˆ’1/2
 Ï Â· eTi D21 Î˜2 B1/2 

r !
âˆš
K 5/2 log n
n
Â·
5/2
K
Î²min Ïn
!
âˆš
K 2 log n
5/2 âˆš
Î²min Ï n

F

= OP
with probability larger than 1 âˆ’ n Â· O(K 2 /n3 )=1 âˆ’ O(K 2 /n2 ).

D. Correctness of Pure node clusters
p
Proof of Lemma 4.3. Recall that max
around 2K/n and this is achieved at the pure nodes. For ease
pi kXi k concentrates p
of analysis let us introduce YÌ‚ := n/2K
 = n/2KX. Recall that from Theorem 4.2 we have entry-wise
 XÌ‚ and Y
consistency on kYÌ‚i âˆ’ Yi Ok â‰¤ 0 = OP
Let norm = OP

q

K log n
n



âˆš
K 2 log n
5/2 âˆš
Î²min Ï n

with probability larger than 1 âˆ’ OP (K 2 /n2 ).

= OP (0 ) be the error of the norm of pure nodes in Lemma 4.1. Then âˆ€i âˆˆ F,

p
kXÌ‚i k â‰¥ (1 âˆ’ 0 ) max kXÌ‚j k â‰¥ (1 âˆ’ 0 )(1 âˆ’ 0 ) max kXj k â‰¥ (1 âˆ’ 0 )(1 âˆ’ 0 )(1 âˆ’ norm ) 2K/n.
j

j

Hence we have a series of inequalities,
(1 âˆ’ 0 )(1 âˆ’ 0 )(1 âˆ’ norm ) â‰¤ kYÌ‚i k â‰¤ kYÌ‚i âˆ’ Yi Ok + kYi k â‰¤ 0 + kYi k.
Hence
kYi k2 â‰¥ (1 âˆ’ 0 âˆ’ 20 âˆ’ norm )2 â‰¥ 1 âˆ’ 2(0 + 20 + norm )
And from the proof of Lemma 4.1,
2
aâˆˆ[K] Î¸ia Baa

P
0

2

1 âˆ’ 2(0 + 2 + norm ) â‰¤ kYi k â‰¤ P
=â‡’ max Î¸ia â‰¥ 1 âˆ’ 2(0 +
a

â‰¤ max Î¸ia (1 + norm )

aâˆˆ[K] Î¸ia Baa
20 + 1.5norm )

a

= 1 âˆ’ OP (0 + 0 )

for  = 2(0 + 20 + 1.5norm ) = OP (0 + 0 ), with probability larger than 1 âˆ’ OP (K 2 /n2 ).
Note that kXi k2 of those nearly pure nodes with maxa Î¸ia â‰¥ 1 âˆ’  also concentrate around 2K
n . These nearly pure nodes
can also be used along with the pure nodes to recover the MMSB model asymptotically correctly.
Lemma D.1. Let F be the set of nodes with kXÌ‚i k â‰¥ (1 âˆ’ 0 ) maxj kXÌ‚j k. Then when 0 = OP (0 ) and  = OP (0 + 0 )
from Lemma 4.3,
min D2 (i, i) =
iâˆˆF

Ïn
(Î²min Â± OP ()) ,
2K

with probability larger than 1 âˆ’ OP (K 2 /n2 ).

and

max D2 (i, i) =
iâˆˆF

Ïn
(1 Â± OP ())
2K

On Mixed Memberships and Symmetric Nonnegative Matrix Factorizations

Proof. From Lemma 4.3 we know that âˆ€i âˆˆ F, âˆƒai that Î¸iai â‰¥ 1 âˆ’ , where  = OP (0 + 0 ) = OP (0 ). Then
D2 (i, i) =

n/2
X

Pij =

j=1

=Ï

K
X

n/2 K
X
X

(2)

(2)

ÏÎ¸i` B`` Î¸j` = Ï

j=1 `=1
(2)

Î¸i` B``

`=1

K
X

(2)

Î¸i` B``

`=1

r

n
2K

1Â±OP

K log n
n

n/2
X

(2)

Î¸j`

j=1

!!
(from Lemma C.1)

!!
r
K log n
Ïn
((1 âˆ’ OP ())Bai ai + OP ()) 1 Â± OP
=
2K
n
Ïn
=
(Bai ai Â± OP ()) .
2K
h
q

q
i
K log n
K log n
,
1
+
O
, so
Using the proof in Lemma C.6, we have D2 (i, i) âˆˆ D2 (i, i) 1 âˆ’ OP
P
Ïn
Ïn
D2 (i, i) =

Ïn
(Bai ai Â± OP ()) .
2K

Then
Ïn
(Î²min Â± OP ()) ,
2K
Ïn
max D2 (i, i) =
(1 Â± OP ())
iâˆˆF
2K
min D2 (i, i) =
iâˆˆF

with probability larger than 1 âˆ’ OP (K 2 /n2 ).
Proof of Theorem 4.4. To prove this theorem, it is equivalent to prove that the upper bound of Euclidean distances within
each communityâ€™s (nearly) pure nodes is far more smaller than the lower bound of Euclidean distances between different
communitiesâ€™ (nearly) pure nodes.
0
Recall that from
 Lemma4.3, for i 6= j âˆˆ F, âˆƒ a, b âˆˆ [K], such that Î¸ia â‰¥ 1 âˆ’  and Î¸jb â‰¥ 1 âˆ’ . Note that  = OP (0 +  )

for 0 = OP

âˆš
K 2 log n
5/2 âˆš
Î²min Ï n

and 0 = OP (0 ).

Using a similar argument as in the proof of Lemma 4.1, we have:
1. if a 6= b,
"

kYi âˆ’

2
Yj k2

â‰¥

1/2

1/2

Î¸ia Baa
Î¸ja Baa
pP
âˆ’ pP
k Î¸ik Bkk
k Î¸jk Bkk

!2

1/2

+

1/2

Î¸ib B
Î¸jb B
pP bb
âˆ’ pP bb
k Î¸ik Bkk
k Î¸jk Bkk

!2 #

r
Â·

1 âˆ’ OP

!!
r
2

2 #
1âˆ’

1âˆ’

K log n
â‰¥ Baa âˆš
âˆ’âˆš
+ Bbb âˆš
âˆ’âˆš
Â· 1 âˆ’ OP
n
Î²max
Î²min
Î²max
Î²min
"
!!
r

2 #
1âˆ’

K log n
â‰¥ 2Î²min âˆš
âˆ’âˆš
Â· 1 âˆ’ OP
n
Î²max
Î²min
ï£±
ï£¼
s
"
! #2
!!
r
ï£² Î²
ï£½
Î²max
K log n
min
â‰¥ 2
1âˆ’ 1+

Â· 1 âˆ’ OP
ï£³ Î²max
ï£¾
Î²min
n
s
(
"
!
#)
!!
r
Î²min
Î²max
K log n
2
= 2
1âˆ’2 1+
 + OP ( )
Â· 1 âˆ’ OP
Î²max
Î²min
n
s
!!
Î²min
Î²max
=2
1 âˆ’ OP 
.
Î²max
Î²min
"



K log n
n

!!2

On Mixed Memberships and Symmetric Nonnegative Matrix Factorizations

So,
s
kXi âˆ’ Xj k2 â‰¥

Î²min
2
Î²max

r

s

2K
n

1 âˆ’ OP



Î²max
Î²min

!!
,

and then,












XÌ‚i âˆ’ XÌ‚j  â‰¥ kXi âˆ’ Xj k2 âˆ’ XÌ‚i âˆ’ Xi  âˆ’ XÌ‚j âˆ’ Xj 
2
2
2
s
s
!!
r
Î²min 2K
Î²max
â‰¥ 2
1 âˆ’ OP 
âˆ’ 2 kXi k Â· 0
Î²max
n
Î²min
s
s
!!
r
r
Î²max
2K
Î²min 2K
â‰¥ 2
1 âˆ’ OP 
âˆ’2
Â· (1 + OP ()) Â· 0
Î²max
n
Î²min
n
r
r !
KÎ²min
K
=2
âˆ’ OP 
.
(Î²max = 1 by definition)
n
n
2. if a = b, first of all we have
(1 âˆ’ )Î²a â‰¤

X

Î¸ik Bkk â‰¤ Î²a + 

k

X

Î²k ,

k6=a

then
1/2

kYi âˆ’

2
Yj k2

=

X
l

1/2

Î¸jl B
Î¸il B
pP ll
âˆ’ pP ll
Î¸
B
k ik kk
k Î¸jk Bkk

!2

r
Â·

1 + OP

K log n
n
ï£¹

!!2

ï£®ï£«
ï£¶2
1/2
1/2
X Î²max ï£º
Baa
(1 âˆ’ )Baa
ï£¯ï£­
ï£¸ +
âˆ’q
â‰¤ï£° p
2 ï£» Â· (1 + OP ())
P
Î²min
(1 âˆ’ )Î²a
Î²a +  k6=a Î²k
k6=a
(
)
P

2
Î²


Î²
k
max
k6
=
a
=
1 + + OP (2 ) âˆ’ (1 âˆ’ ) 1 âˆ’
+ OP (2 )
+ (K âˆ’ 1)
2 Â· (1 + OP ())
2
2
Î²a
Î²min
(
P

2

)
3
Î²max 2
k6=a Î²max
2
+
â‰¤
 + OP ( ) + OP K

Â· (1 + OP ())
2
2Î²min
Î²min


Î²max 2
 .
= OP K
Î²min
So,
r
kXi âˆ’ Xj k2 â‰¤

2K
OP
n

s

Î²max
 K
Î²min

!

and then,












XÌ‚i âˆ’ XÌ‚j  â‰¤ kXi âˆ’ Xj k2 + XÌ‚i âˆ’ Xi  + XÌ‚j âˆ’ Xj 
2
2
2
s
!
r
2K
Î²max
â‰¤
OP  K
+ 2 kXi k Â· 0
n
Î²min
s
!
r
r
2K
Î²max
2K
â‰¤
OP  K
+2
Â· (1 + OP ()) Â· 0
n
Î²min
n
s
!
K2
= OP 
.
(Î²max = 1 by definition)
nÎ²min

On Mixed Memberships and Symmetric Nonnegative Matrix Factorizations

q

Now we can see 12 KÎ²nmin can be used as a threshold to separate different clusters. However, in the algorithm we do not
know Î²min in advance, so we need to approximate it with some computable statistics. From Lemma D.1, we know that
Ïn
D2 (i, i) = 2K
(Bai ai Â± OP (0 )) when Î¸iai â‰¥ 1 âˆ’ . So miniâˆˆF D2 (i, i) and maxiâˆˆF D2 (i, i) can be used to estimate
Î²min .
s
s
s
!
r
K miniâˆˆF D2 (i, i)
K Ïn (Î²min Â± OP ()) /(2K)
1 KÎ²min
K
Ï„=
=
=
Â± OP 
.
4n maxiâˆˆF D2 (i, i)
4n Ïn (1 Â± OP ()) /(2K)
2
n
nÎ²min
Clearly,
r
2

KÎ²min
Â± OP
n

r


K
n

s

!
> 2Ï„  OP



K2
nÎ²min

!
,

which means PartitionPureNodes(XÌ‚(F, :), Ï„ ) can exactly give us K clusters of different (nearly) pure nodes and return
one (nearly) pure node from each of the K clusters with probability larger than 1 âˆ’ OP (K 2 /n2 ).

E. Consistency of inferred parameters
p
p
Proof of Theorem 4.5. Let YÌ‚ := n/2K XÌ‚ and Y = n/2KX. Let  = OP (0 + 0 ) = O (0 ) from Lemma 4.3, where
we show that kYi k2 â‰¥ 1 âˆ’  for i âˆˆ SP . Furthermore for ease of exposition let us assume that the pure nodes are arranged
so that Î˜Ì‚2p = Î˜Ì‚2 (Sp , :) is close to an identity matrix, i.e., the columns are arranged with a particular permutation.
p
P
Thus kYp k2F = i kYp (i, :)k2 â‰¥ K(1 âˆ’ ) and so kYp kF â‰¥ K(1 âˆ’ ).
âˆš
We have also shown that kYp (i, :)k2 â‰¤ 1 + , so kYp kF â‰¤ K (1 + ).
We will use
kYÌ‚pâˆ’1 âˆ’ (Yp O)

âˆ’1

âˆ’1

kF â‰¤ k (Yp O)

(Yp O âˆ’ YÌ‚p )YÌ‚pâˆ’1 kF â‰¤ kYpâˆ’1 kF kYp O âˆ’ YÌ‚p kF kYÌ‚pâˆ’1 k.

(3)

First we will prove a bound on kYÌ‚pâˆ’1 k. Let ÏƒÌ‚i be the ith singular value of YÌ‚p ,
kYÌ‚pâˆ’1 k =

1
.
ÏƒÌ‚K

(4)

We can bound ÏƒÌ‚K by bounding ÏƒK . In what follows we use M1p to denote the rows of M1 indexed by Sp when
âˆš M1
is n/2 Ã— K and âˆšby the square submatrix
M
(S
,
S
)
is
when
M
is
n/2
Ã—
n/2.
Note
that
kÎ˜
âˆ’
Ik
=
K,
1 p
p
1
2p
F
âˆš
âˆ’1
kB1/2 kF = OP ( K), kÎ˜2p kF = OP ( K) and kD21p
kF = OP (K 3/2 /Î²min Ïn),
Ïƒi2 = Î»i (Yp YpT ) =

Ïn
âˆ’1/2
âˆ’1/2
Î»i (D21p Î˜2p BÎ˜T2p D21p )
2K

Ïn
âˆ’1
Î»i (B1/2 Î˜T2p D21p
Î˜2p B1/2 )
2K 


Ïn
âˆ’1
âˆ’1
âˆ’1
=
Î»i B1/2 D21p
+ (Î˜2p âˆ’ I)T D21p
Î˜2p + D21p
(Î˜2p âˆ’ I) B1/2 .
2K

=

âˆ’1 1/2
Note that the matrix B1/2 D21p
B
is a diagonal matrix with the (i, i)th diagonal element being Î²i /D21p (i, i).

With similar arguments in the proof of Lemma D.1, we can get
D21p (i, i) =

nÏ
(Î²i Â± OP ()) ,
2K

so
âˆ’1 1/2
Î»K (B1/2 D21p
B )=

2K
(1 Â± OP (/Î²min )) .
Ïn

On Mixed Memberships and Symmetric Nonnegative Matrix Factorizations

By Weylâ€™s inequality and note that operator norm is less than or equal to Frobenius norm, it immediately gives us:


Ïn  1/2 âˆ’1 1/2  Ïn 

 2

âˆ’1
âˆ’1
Î»i B D21p B
Â· B1/2 (Î˜2p âˆ’ I)T D21p
Î˜2p B1/2 + B1/2 D21p
(Î˜2p âˆ’ I)B1/2 
Ïƒi âˆ’
â‰¤
2K
2K 


 âˆ’1 
Ïn  1/2 

1/2 
 Â· 2 kÎ˜2p k Â· 
â‰¤
Â· B  Â· kÎ˜2p âˆ’ IkF Â· D21p

B
F
F
2K
F
F


âˆš
âˆš
Ïn âˆš
K 3/2 âˆš
=OP
Â· K Â· K Â·
Â· KÂ· K
2K
Î²min Ïn
!
âˆš
K 9/2 log n
=OP
7/2 âˆš
Î²min Ï n
!
âˆš
K 9/2 log n
2
=â‡’ ÏƒK =1 Â± OP
.
7/2 âˆš
Î²min Ï n
Now, Weylâ€™s inequality for singular values gives us:
âˆš
|ÏƒÌ‚i âˆ’ Ïƒi | â‰¤ kYÌ‚p âˆ’ Yp Ok â‰¤ kYÌ‚p âˆ’ Yp OkF = OP ( K)
!!1/2
!!
âˆš
âˆš
âˆš
K 9/2 log n
K 2 log n
ÏƒÌ‚K = 1 Â± OP
1 Â± OP
K Â· 5/2 âˆš
= 1 Â± OP
7/2 âˆš
Î²min Ï n
Î²min Ï n

!
âˆš
K 9/2 log n
.
7/2 âˆš
Î²min Ï n

Plugging this into Equation (4) we get:
kYÌ‚pâˆ’1 k = 1 Â± OP

!
âˆš
K 9/2 log n
.
7/2 âˆš
Î²min Ï n

Finally putting everything together with Equation (3) we get:
âˆ’1

kXÌ‚âˆ’1
p âˆ’ (Xp O)
kXâˆ’1
p kF

kF

âˆ’1

=

kYÌ‚pâˆ’1 âˆ’ (Yp O)

kF

kYpâˆ’1 kF

â‰¤ kYp O âˆ’

YÌ‚p kF kYÌ‚pâˆ’1 k

= OP

!
âˆš
K 5/2 log n
5/2 âˆš
Î²min Ï n

(5)

with probability larger than 1 âˆ’ OP (K 2 /n2 ).
âˆ’1/2

1/2

(Sp , Sp ). First note that if one plugs in the population
Proof of Theorem 4.6. Recall that Î˜Ì‚2 = Î˜Ì‚(SÌ„) = D12 XÌ‚XÌ‚âˆ’1
p D21
counterparts of the the terms in Î˜Ì‚2 , then for some permutation matrix Î  that Î˜2p := Î˜2 (Sp , :) Â· Î  is close to an identity
matrix, and


 1
âˆ’1/2
âˆ’1/2
1/2
âˆ’1/2
1/2 âˆš
âˆ’1 1/2
âˆ’1
1/2
âˆ’1/2
Ï
Â·
D
Î˜
B
Â·
B
Î Î˜
D
D21 XXâˆ’1
D
=
D
âˆš
2
p
21p
21
21
2p
21p D21p = Î˜2 Î Î˜2p ,
Ï
so
âˆ’1/2

1/2

Î˜2 Î  = D21 XXâˆ’1
p D21p Î˜2p .
We have the following decomposition








 1/2
 1/2
âˆ’1/2 
1/2
âˆ’1 âˆ’1/2 
Î˜Ì‚2 âˆ’ Î˜2 Î  â‰¤ (D21 âˆ’ D21 )XÌ‚XÌ‚âˆ’1
p D21p  + D21 (XÌ‚ âˆ’ XO)XÌ‚p D21p 
F
F
F




 1/2
 1/2
âˆ’1/2 
âˆ’1/2
âˆ’1/2 
âˆ’1
âˆ’1
+ D21 XO(XÌ‚âˆ’1
âˆ’
(X
O)
)D
+
XX
(D
D21
p
p
p
21p 
21p âˆ’ D21p )
F
F


 1/2

âˆ’1 âˆ’1/2
+ D21 XXp D21p (I âˆ’ Î˜2p ) .
F

p

p

p
From the proof of Lemma C.6 we have D21 (i, i) = D21 (i, i)(1 Â± OP ( K log n/nÏ)) and hence

 

p
 1/2
 1/2 
1/2 
D21 âˆ’ D21  = D21  OP ( K log n/nÏ),

On Mixed Memberships and Symmetric Nonnegative Matrix Factorizations

and

 

p
 âˆ’1/2 
 âˆ’1/2
âˆ’1/2 
D21p âˆ’ D21p  â‰¤ D21p  OP ( K log n/nÏ).
p
p
And kXÌ‚âˆ’1
n/(2K)kYÌ‚pâˆ’1 k = OP ( n/K), as we have shown in the proof of Theorem 4.5. Furthermore, by
p k =
âˆš
Fact C.1, kXÌ‚âˆ’1
p kF = OP ( n).
âˆš
From the proof of Theorem 4.2 we can get kXÌ‚ âˆ’ XOkF = OP ( K0 ). Theorem 4.5 gives
!
âˆš
K 5/2 log n
âˆ’1
âˆ’1
âˆ’1
kXÌ‚p âˆ’ (Xp O) kF = kXp kF Â· OP
5/2 âˆš
Î²min Ï n
!
!
r 
âˆš
âˆš

âˆš
n
K 5/2 log n
K 5/2 log n
= OP
KÂ·
Â· OP
= OP
.
5/2 âˆš
5/2
K
Î² Ï n
Î² Ï
min

min

âˆš
around its population entry-wisely, and the max norm of any row of the
Also kXÌ‚kF =pOP ( K), since it concentrates
âˆš
population is 2K/n, so kXkF = OP ( K). And
p
p
âˆš
1/2
1/2 âˆš
âˆ’1/2
kD21 Xk = kD21 Ï Â· D21 Î˜2 B1/2 k = k Ï Â· Î˜2 B1/2 k = kPk = OP ( Ïn/K).
Hence,



  


 1/2
 1/2
1/2
âˆ’1/2 
1/2     âˆ’1   âˆ’1/2 
(D21 âˆ’ D21 )XÌ‚XÌ‚âˆ’1
p D21p  â‰¤ D21 âˆ’ D21  XÌ‚ XÌ‚p  D21p 
F
F




p
âˆš 
p
p
p
p
Ïn/K OP
K log n/nÏ Â· OP
K Â· OP
n/K Â· OP ( K/Î²min Ïn) = OP
K log n/Î²min Ï ,
= OP




 


 1/2
 1/2  
  âˆ’1   âˆ’1/2 
âˆ’1/2 
D21 (XÌ‚ âˆ’ XO)XÌ‚âˆ’1
p D21p  â‰¤ D21  XÌ‚ âˆ’ XO  XÌ‚p  D21p 
F
F

r
 2âˆš

p


âˆš

p
p
n 0
K log n
0
= OP
Ïn/K Â· OP
K Â· OP
n/K Â· OP ( K/Î²min Ïn) = OP
 = OP
,
3 Ï
Î²min
Î²min




 

 1/2
 1/2  
âˆ’1/2 
âˆ’1
âˆ’1   âˆ’1/2 
)D21p  â‰¤ D21 X XÌ‚âˆ’1
D21 X(XÌ‚âˆ’1
 D21p 
p âˆ’ (Xp O)
p âˆ’ (Xp O)
F
F
!
âˆš
 5/2 âˆš


p
5/2
p
K
log n
K
log n
Ïn/K Â· OP
Â· OP ( K/Î²min Ïn) = OP
= OP
,
3 Ï
5/2
Î²min
Î²min Ï





  âˆ’1/2
 1/2
 1/2  
âˆ’1/2
âˆ’1/2 
âˆ’1/2 
 âˆ’1  
D21 XXâˆ’1
D21p âˆ’ D21p 
p (D21p âˆ’ D21p ) â‰¤ D21 X Xp
F
F



p
p
p
p
p
âˆš
Ïn/K Â· OP ( K Â· n/K) Â· OP ( K/Î²min Ïn)OP
K log n/nÏ = OP
K log n/Î²min Ï ,
= OP




  âˆ’1/2 

 1/2

 1/2  
âˆ’1/2
 âˆ’1  
D21p  kI âˆ’ Î˜2p kF
D21 XXâˆ’1
p D21p (I âˆ’ Î˜2p ) â‰¤ D21 X Xp
F
F
s
!
 5/2 âˆš

p

p
p
âˆš
âˆš 0
Kn 0
K
log n
= OP
Ïn/K Â· OP ( K Â· n/K) Â· OP ( K/Î²min Ïn) Â· K = OP
 = OP
.
3 Ï
Î²min
Î²min
So
 5/2 âˆš



K
log n


.
Î˜Ì‚2 âˆ’ Î˜2 Î  = OP
3 Ï
Î²min
F
Since kÎ˜2 k2F = â„¦(n/K), we finally have:




Î˜Ì‚2 âˆ’ Î˜2 Î 

F

kÎ˜2 kF
with probability larger than 1 âˆ’ O(K 2 /n2 ).


â‰¤ OP

âˆš

K 3 log n
âˆš
3 Ï n
Î²min

On Mixed Memberships and Symmetric Nonnegative Matrix Factorizations

2



1/2
Proof of Theorem 4.7. Recall that ÏÌ‚Î²Ì‚a = eTa D21 (Sp , Sp )XÌ‚p  , and for some permutation matrix Î  that Î˜2p :=
F

Î˜2 (Sp , :) Â· Î  is close to an identity matrix, if one plugs in the population counterparts of the the terms in Î˜Ì‚2 ,
âˆš


âˆš


âˆš

 T 1/2




ea D21 (Sp , Sp )Xp  =  Ï Â· eTa Î˜2p Î T B1/2  =  Ï Â· eTa (Î˜2p âˆ’ I) Î T B1/2 + Ï Â· eTa Î T B1/2 
F
F
F
âˆš
âˆš




T
T 1/2 
T
T 1/2 
â‰¤  Ï Â· ea (Î˜2p âˆ’ I) Î  B  +  Ï Â· ea Î  B 
F
F
p
âˆš
= Ï0 + ÏÎ²a0 ,
where a0 âˆˆ [K] satisfies Î a0 a = 1.
Using the bounds mentioned in the proof of Theorem 4.6, we have:


 

 T 1/2
 
1/2
1/2
1/2
1/2
ei (D21 XÌ‚ âˆ’ D21 XO) = eTi (D21 âˆ’ D21 )XÌ‚ + eTi D21 (XÌ‚ âˆ’ XO)
p
 p


p

 

â‰¤
D21 (i, i) âˆ’ D21 (i, i) eTi XÌ‚ +  D21 (i, i)eTi (XÌ‚ âˆ’ XO)


p
 
  
p
 p




â‰¤
D21 (i, i) âˆ’ D21 (i, i) eTi XÌ‚ âˆ’ XO  + eTi X + D21 (i, i) eTi (XÌ‚ âˆ’ XO)
s
!
!"
r !#
p
r 
r 
nÏ
K log n
K 5 log n
K
nÏ
= OP
+
O
OP
OP
+
O
Â· OP
P
P
5/2
K
nÏ
n
K
Î²min Ïn
!
K 5/2 log n
= OP
.
5/2 âˆš
Î²min Ïn

p

K 5 log n

!

5/2

Î²min Ïn

As a result,
q

p


 ÏÌ‚Î²Ì‚a âˆ’ ÏÎ²a0  â‰¤ OP



K 5/2 log n
5/2 âˆš
Î²min Ïn

!
+

âˆš

0

Ï = OP

K 5/2 log n
5/2 âˆš
Î²min Ïn

!
,

and note that ÏÎ²a0 = â„¦(Ï), we have
"
ÏÌ‚Î²Ì‚a âˆˆ ÏÎ²a0 1 âˆ’ OP

K 5/2 log n
5/2 âˆš
Î²min Ï n

!
, 1 + OP

K 5/2 log n
5/2 âˆš
Î²min Ï n

!#

with probability larger than 1 âˆ’ O(K 2 /n2 ).

References
Huang, Kejun, Sidiropoulos, Nicholas, and Swami, Ananthram. Non-negative matrix factorization revisited: Uniqueness
and algorithm for symmetric decomposition. Signal Processing, IEEE Transactions on, 62(1):211â€“224, 2014.
Lei, Jing, Rinaldo, Alessandro, et al. Consistency of spectral clustering in stochastic block models. The Annals of Statistics,
43(1):215â€“237, 2015.
Minc, Henryk. Nonnegative matrices. 1988.
Tang, Minh, Sussman, Daniel L, Priebe, Carey E, et al. Universally consistent vertex classification for latent positions
graphs. The Annals of Statistics, 41(3):1406â€“1430, 2013.
Yu, Yi, Wang, Tengyao, Samworth, Richard J, et al. A useful variant of the davisâ€“kahan theorem for statisticians.
Biometrika, 102(2):315â€“323, 2015.

