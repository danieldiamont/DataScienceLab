Supplementary Material

A

Proof of Lemmas

Proof of Lemma 4. Let t = min{|t1 + · · · + tl |, τ } ∈ [0, τ ], then it suffices to show
that p(|t1 |) + · · · + p(|tl |) ≥ p(t). Note that we have |t1 | + · · · + |tl | ≥ |t1 + · · · +
tl | ≥ t. Moreover, since p(0) = 0 and p(·) is concave on [0, τ ], we must have p(·)
being subadditive, i.e., for any s1 , . . . , sl ≥ 0 such that s1 + · · · + sl ≤ τ , we have
p(s1 ) + · · · + p(sl ) ≥ p(s1 + · · · + sl ). Combining both facts, we have
!


l
l
l
X
X
X
t
t
p(|ti |) ≥
p
· |ti | ≥ p
· |ti | = p(t),
|t1 | + · · · + |tl |
|t | + · · · + |tl |
i=1
i=1
i=1 1
where the first inequality is due to monotonicity and the second is due to subadditivity
of p(·).

Proof of Lemma 5. According to the conditions for p(·), there exists τ2 < τ such that
p(·) is twice continuously differentiable on [τ2 , τ ]. We first show that there exists
τ0 ∈ (τ2 , τ ) such that p(·) is concave but not linear on [0, τ0 ]. If otherwise, p(·) must
be a linear function on [0, τ ), then since p(·) is continuous at t = τ where continuity
follows from concavity, we must have p(·) is a linear function on [0, τ ], which contradicts
with that p(·) is not linear on [0, τ ]. In the following, we show that this τ0 satisfies the
conditions in the lemma.
0 /3)
We first show that C1 > 0. If otherwise, we have p(τ0 /3)−p(0)
≤ p(τ0 )−p(2τ
.
τ0 /3
τ0 /3
Since p(t) is concave, this must imply that p(t) is linear on [0, τ0 ], which contradicts
with that p(·) is not linear on [0, τ0 ].
Before proving the result, we first introduce two auxiliary functions. For any
s ∈ [0, τ0 ], define e
(s) := p(e
t − s) + p(s) − p(e
t) and (s) := p(τ0 − s) + p(s) − p(τ0 ).
Note that they have the following properties:
(i) C1 =

(τ0 /3)
τ0 /3 ;

(ii) (s) ≤ e
(s): this is due to e
(s)−(s) = (p(τ0 )−p(τ0 −s))−(p(e
t)−p(e
t −s)) ≥ 0;
(iii) (s)/s is non-increasing in s: this is due to
(s)
p(s) − p(0) p(τ0 ) − p(τ0 − s)
=
−
s
s
s
1

where

p(s)−p(0)
s

is non-increasing while

p(τ0 )−p(τ0 −s)
s

is non-decreasing;

(iv) Combining (i) – (iii) above, for any s ∈ (0, τ0 /3], we have
p(s) ≥ p(s) + p(e
t − s) − p(e
t) = e
(s) ≥ (s) ≥ C1 s.
When s = τ0 /3, this implies that p(τ0 /3) + p(e
t − τ0 /3) − p(e
t) ≥ C1 · τ0 /3 > C1 δ.
Now we prove the last statement of Lemma 5. Suppose t1 + · · · + tl = e
t, and
p(|t1 |) + · · · + p(|tl |) − p(e
t) < C1 δ. Without loss of generality, we assume t1 ≥ t2 ≥
· · · ≥ tl . Now it suffices to show that |e
t − t1 | < δ, t2 < δ, and tl > −δ.
Denote T = {t1 , . . . , tl }. For any S ⊆ T , we use σ(S) to denote the sum of
all
P the elements of S. Now we show that σ(S) > −δ for any S. If otherwise, then
e
e
S c ti ≥ t + δ ≥ t, and we have
X
X
C1 δ >
p(|ti |) +
p(|ti |) − p(e
t) ≥ p(δ) + p(e
t) − p(e
t) ≥ C1 δ,
S

Sc

where the second inequality is due to Lemma 4 and the monotonicity of p(·), and the
third one is due to (iv) above. This is a contradiction. Note that by having S = {tl }, this
result implies that tl > −δ. Also, by considering the complement of a subset, we have
σ(S) = σ(T ) − σ(S c ) < e
t + δP
< τ for any S ⊆P
T . This has two implications. First,
according to Lemma 4, we have S p(|ti |) ≥ p(| S ti |); second, by letting S = {t1 },
we have t1 < e
t + δ.
Now we show that t1 > e
t −δ, by sequentially showing that t1 > τ0 /3, t1 > e
t −τ0 /3,
and then t1 > e
t − δ. If t1 ≤ τ0 /3, then we have |ti | ≤ τ0 /3 for any i. Then
we can divide T into two sets T1 and T2 such that |σ(T1 ) − σ(T2 )| ≤ τ0 /3, thus
σ(T1 ), σ(T2 ) ∈ (e
t/2 − τ0 /6, e
t/2 + τ0 /6) ⊆ (τ0 /3, e
t − τ0 /3). Now we have

!

!
X 
X 




C1 δ > p 
ti  + p 
ti  − p(e
t) ≥ p(τ0 /3) + p(e
t − τ0 /3) − p(e
t) > C1 δ,




ti ∈T1

ti ∈T2

which is a contradiction. Note that here the first inequality is due to Lemma 4, and the
second one is due to the concavity of p(·).
Now we show that t1 > e
t − τ0 /3. If otherwise, since we have proved that t1 ≥ τ0 /3,
we have t1 ∈ [τ0 /3, e
t − τ0 /3]. Now by letting T1 = {t1 } and T2 = T − T1 , we have
σ(T1 ), σ(T2 ) ∈ (τ0 /3, e
t − τ0 /3), and contradiction arises in the same way as in the
previous case.
Now we show that t1 > e
t −δ, which is equivalent to showing that e
t2 = t2 +· · ·+tl =
e
t − t1 < δ. If e
t2 ≥ δ, then due to subadditivity, concavity, and (iv) above, we have
C1 δ > p(|t1 |) + p(|e
t2 |) − p(e
t) ≥ p(e
t − δ) + p(δ) − p(e
t) ≥ C1 δ,
which is a contradiction.
Now to complete the proof, the only last thing we need to show is that t2 < δ. If
t2 ≥ δ, then due to subadditivity and concavity, we have
C1 δ > p(|t2 |) + p(|e
t − t2 |) − p(e
t) ≥ p(δ) + p(e
t − δ) − p(e
t) ≥ C1 δ,


which is a contradiction.
2

Proof of Lemma 6. According to Lemma 5, p(·) is twice continuously differentiable on
[τ0 , τ ], thus there exists K > 0 such that p00 (t) ≥ −K for any t ∈ [τ0 , τ ]. Now we take
p(b
τ )+θb
τ q +1
1+K
θ = q(q−1) min{τ
q−2 q−2 , and µ =
θ·|τ0 −b
τ |q , and verify the results in the lemma.
,τ
}
0

For the first result, we have for any t ∈ [τ0 , τ ],
00
gθ,µ
(t) = p00 (t)+θq(q −1)tq−2 +µq(q −1)|b
τ −t|q−2 ≥ −K +θq(q −1)tq−2 +0 ≥ 1,
00
thus gθ,µ
(t) ≥ 1 for any t ∈ [τ0 , τ ].
Now we show the result of unique minimizer. Since gθ,µ (t) is strictly increasing on
[b
τ , +∞), any global minimizer must lie in (−∞, τb]. Moreover, for any t ∈ (−∞, τ0 ],
we have

gθ,µ (t) > 0+0+θµ·|τ0 −b
τ |q = θ/θ·(p(b
τ )+θb
τ q +1) ≥ p(b
τ )+θb
τ q +1 = gθ,µ (b
τ )+1,
(A.1)
thus any global minimizer must lie within (τ0 , τb] ⊆ (τ0 , τ ). Now since g 00 (t) ≥ 1 for
any t ∈ (τ0 , τ ), we know that g(·) is strictly convex thereon, thus the global minimizer
of gθ,µ (t) on [τ0 , τ ] exists and is unique. Denote the minimizer on [τ0 , τ ] by t∗ (θ, µ),
then according to the previous discussion, t∗ (θ, µ) must also be the global minimizer of
gθ,µ (t) on .
Now we show the last statement. Suppose that gθ,µ (t̄) < h(θ, µ) + δ 2 for some
δ ∈ (0, δ̄). We first consider the case where t̄ ∈ [τ0 , τ ]. According to the mean-value
theorem, there exists e
t between t̄ and t∗ (θ, µ) such that
1
1
t)(t̄ − t∗ (θ, µ))2 ≥ h(θ, µ) + (t̄ − t∗ (θ, µ))2
gθ,µ (t̄) = gθ,µ (t∗ (θ, µ)) + g 00 (e
2
2
Therefore, a necessary condition for gθ,µ (t̄) < h(θ, µ) + δ 2 is that |t̄ − t∗ (θ, µ)| < δ.
Note that this implies gθ,µ (τ ) ≥ h(θ, µ) + δ 2 . Now to complete the proof, we only need
to show that gθ,µ (t) ≥ h(θ, µ) + δ 2 for any t ∈ (−∞, τ0 ] ∪ [τ, +∞). The inequality
with t ∈ (−∞, τ0 ] has been proved in (A.1). And for any t ∈ [τ, +∞), we have
gθ,µ (t) ≥ gθ,µ (τ ) ≥ h(θ, µ) + δ 2 . Therefore, the proof is complete.

n
o
τ )+1
Proof of Lemma 7. We take µ
b = max 1 + p0 (τ0 ), p(b
and verify the results in
τb−τ0
the lemma. Note that we have p(·) being twice continuously differentiable on [τ0 , τ ]
thus p0 (τ0 ) is well-defined.
0
For any t ∈ [τ0 , τb), we have g0,µ
(t) = p0 (t) − µ ≤ p0 (τ0 ) − µ
b ≤ −1; and for any
0
0
t ∈ (b
τ , τ ], we have g0,µ (t) = p (t) + µ ≥ 0 + µ
b ≥ 1. Therefore, the first property in
Lemma 7 holds.
Now we show the result of unique minimizer. Since g0,µ (t) is strictly increasing on
[b
τ , +∞), any global minimizer must lie in (−∞, τb]. Moreover, for any t ∈ (−∞, τ0 ],
we have
g0,µ (t) ≥ 0 + µ
b · |τ0 − τb| ≥ p(b
τ ) + 1 = g0,µ (b
τ ) + 1,
(A.2)
0
thus any global minimizer must lie within (τ0 , τb]. Now since g0,µ
(t) < −1 for any
∗
b
t ∈ [τ0 , τb), the global minimizer of g0,µ (·) is t (0, µ) = τb and is unique.

3

Now we show the last statement. Suppose that g0,µ (t̄) < h(0, µ) + δ 2 for some
δ ∈ (0, δ̄). Again we first consider the case where t̄ ∈ [τ0 , τ ]. When t̄ ∈ [b
τ , τ ], since
0
0
g0,µ
(t) > 1, we have g0,µ (t̄) − g0,µ (b
τ ) ≥ t̄ − τb; when t̄ ∈ [τ0 , τb], since g0,µ
(t) < −1,
we have g0,µ (t̄) − g0,µ (b
τ ) ≥ τb − t̄. Therefore, a necessary condition for g0,µ (t̄) <
h(0, µ) + δ 2 is that |t̄ − τb| < δ 2 < δ. Note that this implies g0,µ (τ ) ≥ h(0, µ) + δ 2 .
Now to complete the proof, we only need to show that g0,µ (t) > h(0, µ) + δ 2 for any
t ∈ (−∞, τ0 ] ∪ [τ, +∞). The inequality with t ∈ (−∞, τ0 ] has been proved in (A.2).
And for any t ∈ [τ, +∞), we have g0,µ (t) ≥ g0,µ (τ ) ≥ h(0, µ) + δ 2 . Therefore, the
proof is complete.

Proof of Lemma 8. If q > 1, then we can find θ and µ such that the properties in Lemma
6 is satisfied; if q = 1, then we can set θ = 0 and find µ such that the properties in
Lemma 7 is satisfied.
Now we first prove the desired inequality in two cases. In the first case, we suppose
Pl
Pl
that | j=1 tj | > τ . Then due to Lemma 4, We have j=1 p(|tj |) ≥ p(τ ), thus

q

q
X

X

 l

 l




p(|tj |)+θ·
tj  +µ·
tj − τb > p(τ )+θτ q +µ|τ −b
τ |q = gθ,µ (τ ) > h(θ, µ)+δ 2




j=1
j=1
j=1
(A.3)
where the last inequality is proved in Lemmas 6 and 7. In the second case, we supPl
Pl
pose that | j=1 tj | ≤ τ . Then according to Lemma 4, we have j=1 p(|tj |) ≥

P
 l

p  k=1 tk  , thus
l
X


q

q



 l
 l

l
X
X 
X

p(|tj |) + θ · 
tj  + µ · 
tj − τb ≥ gθ,µ 
tj  ≥ h(θ, µ),




j=1
j=1
j=1
j=1

l
X

(A.4)

where the second inequality is due to Lemmas 6 and 7.
Now we prove the “only if” statement. Suppose we have t1 , . . . , tl ∈ such that (3)
Pl
holds. Now according to (A.3), we must have | j=1 tj | ≤ τ , and combining (A.4),
P

Pl
l
we have gθ,µ
< h(θ, µ) + δ 2 . Then we have | j=1 tj − t∗ (θ, µ)| < δ
j=1 tj
Pl
according to Lemmas 6 and 7, thus e
t := j=1 tj ∈ [τ0 , τ ]. Moreover, in order for
Pl
(3) to hold, we must also have j=1 p(|tj |) − p(e
t) ≤ δ 2 ≤ C1 δ. Then according to
Lemma 5, we must have |ti − e
t| < δ for some i while |tj | < δ for all j 6= i. Now since
|e
t − t∗ (θ, µ)| < δ, we have |ti − t∗ (θ, µ)| < 2δ, which completes the proof.


B

Proof of Theorem 2

In this section, we prove the hardness of approximation of Problem 1 for general
loss function `. We develop the reduction proof through a series of preliminary lemmas. In particular, our Lemmas B.1,B.2,B.3 establish important properties about the

4

sparse penalty function p, and are analogs to Lemmas 4, 5 and 8, respectively. We
have to reprove these lemmas with additional technicalities in order to address the
-approximibility instead of exact solution. Our first lemma gives us a key fact about
the nonconvex penalty function p. We use B(θ, δ) to denote the interval (θ − δ, θ + δ).
Lemma B.1. For any penalty function p that satisfies Assumption 2, we have
(i) p(t) is continuous on (0, τ ].
Pn
Pl
Pl
(ii) For any t1 , ..., tl ≥ 0, if
i=1 ti ≤ τ , then
i=1 p(ti ) ≥ p(
i=1 ti ).
Pl
(iii) There exists a ∈ [1/2, 1) such that when i=1 ti ∈ [aτ, τ ], the above inequality
holds as equality if and only if ti = t∗ for some i while tj = 0 for j 6= i.
(iv) Denote κ = mint∈[aτ,τ ] { 2p(t/2)−p(t)
}. For the constant a given in (iii), we
t
Pl
have that ∀δ > 0, t1 , · · · , tl ∈ R, ∀ ≤ κδ : if i=1 ti = t∗ ∈ [aτ, τ ] and
Pl
Pl
p( i=1 ti ) +  ≥ i=1 p(ti ), then there is at most one i such that ti 6∈ B(0, δ).
Proof. As (i), (ii) and (iii) are proved in Ge et al. (2015), we prove (iv) here. We first
prove the lemma when t1 , · · · , tl ≥ 0. We start by proving the case when l = 2. For
the simplicity of notation, we use t∗ to denote t1 + t2 in the rest of the proof. By
(iii), there exists a such that when t∗ ∈ [aτ, τ ] and p(t∗ ) ≥ p(t1 ) + p(t2 ), we have
t1 = 0 or t2 = 0. It follow that when t1 6= 0, t2 6= 0 and t∗ ∈ [aτ, τ ], we have
p(t1 + t2 ) < p(t1 ) + p(t2 ). Without loss of genearlity, we assume that t1 ≤ t2 . Then,
we have
p(t∗ ) − p(t∗ − t1 )
p(t1 )
<
.
t1
t1
Notice that the right term is non-increasing with the increment of t1 as p is a concave
function and the left term is non-decreasing with the increment of t1 when t∗ is fixed.
∗
/2)
p(t∗ )−p(t∗ −t1 )
1)
As t1 ≤ t∗ /2, we have p(t
≥ k1 (t∗ ) := p(t
≤ k2 (t∗ ) :=
t1
t∗ /2 and
t1
p(t∗ )−p(t∗ /2)
.
t∗ /2

As p is not linear on [0, t∗ ], we have k1 (t∗ ) > k2 (t∗ ).
On the other hand, we can see that when p(t1 + t2 ) +  ≥ p(t1 ) + p(t2 ),
p(t1 + t2 ) − p(t2 )

p(t1 )
+
≥
.
t1
t1
t1


Assume t1 < t2 , we have k2 (t∗ ) + /t1 ≥ k1 (t∗ ) 1 . As a result t1 ≤ k1 (t∗ )−k
∗ .
2 (t )
Note that k1 and k2 are defined on a closed interval [aτ, τ ] by (iii), giving us that
mint∈[aτ,τ ] (k1 (t)−k2 (t)) > 0. Therefore, ∃a ∈ (0, 1), ∀δ > 0, ∃0 = mint∈[aτ,τ ] (k1 (t)−
k2 (t)) · δ, ∀ < 0 , if t1 + t2 = t∗ ∈ [aτ, τ ] and p(t1 + t2 ) +  ≥ p(t1 ) + p(t2 ), then

t1 ≤ k1 (t∗ )−k
≤ δ. Therefore, there is at most one i such that ti 6∈ B(0, δ).
∗
2 (t )
Now consider the case when l > 2 and t1 , . . . , tl ≥ 0. If there are more than one i
such that ti 6∈ B(0, δ), assume t1 and t2 are two of them. By (ii), we have
!
l
l
X
X
p(ti ) ≥ p(t1 ) + p
ti .
i=1
1

i=2

For the case when t1 = 0, (iv) holds trivially.

5

Pn
Pl
Pl
Pl
If t1 + i=2Pti ∈ [aτ, τ ] and p(t1 + i=2 ti ) +  ≥ i=1 p(ti ) ≥ p(t1 ) + p( i=2 ti ),
n
either t1 or i=2 ti should be inside B(0, δ). This is contradictory to our assumption
that both t1 and t2 are outside B(0, δ). To this point, we prove (iv) when t1 , · · · , tl ≥ 0.
Next, we prove the lemma when t1 , · · · , tl could be smaller than 0. Suppose
Pl
Pl
t∗ = i=1 ti ∈ [aτ, τ ] and p(t∗ ) +  ≥ i=1 p(ti ). We consider two cases separately.
In the first case, assume that there is one ti ≤ −δ and one tj ≥ δ. Without loss of
generality, we assume that t∗ > 0. Then we can choose α = δ, β = t∗ − α and get
X
X
p(α + β) +  = p(t∗ ) +  ≥
p(ti ) +
p(ti ) ≥ p(α) + p(β),
i∈{j:tj <0}

i∈{j:tj >0}

which is a contradiction to the previous proof that only one of α, β could be outside of
B(0, δ) as δ is smaller than t∗ /2 by our choice. We then proceed to the case when there
is one ti ≥ δ and one tj ≥ δ. Suppose that α = ti ≥ tj = β. If α + β > t∗ , we set
t∗ −2δ
t∗ −2δ
α0 = δ + α+β−2δ
· (α − δ) and β 0 = δ + α+β−2δ
· (β − δ). It is easy to verify that
p(α0 + β 0 ) +  = p(t∗ ) +  ≥

l
X

p(ti ) ≥ p(α) + p(β) ≥ p(α0 ) + p(β 0 ),

i=1

which is a contradiction. If α + β < t∗ , we can verify that
p(α + β + t∗ − α − β) +  = p(t∗ ) +  ≥

l
X

p(ti ) ≥ p(α) + p(β) + p(t∗ − α − β),

i=1

which is also a contradiction. To this point, we prove the case that t1 , · · · , tl could be
smaller than 0, which completes the proof of the lemma.
Remark. In the proof of (iv), our choice of  is linear to δ given δ. However, in
the case of L0 ,  could be any constant smaller than 1 no matter what δ is. This property
of L0 has wide applications in statistical problems. Actually, suppose that penalty
function is indexed by δ and pδ satisfies
pδ (δ) − pδ (aτ ) + pδ (aτ − δ) ≥ C

(B.1)

for some constant C, then ∀δ > 0 and  ≤ C, the proposition stated in (iv) holds.
To prove this, just note that if p(t1 + t2 ) − p(t2 ) +  > p(t1 ) and t1 > δ, then
p(t1 ) − p(t1 + t2 ) + p(t2 ) > p(δ) − p(aτ ) + p(aτ − δ) ≥ C which is a contradiction
to that  should be smaller than C.

Lemma B.1 states the key properties of the penalty function p. Property (iv) is of
special interest. It indicates that if we can manipulate the sum of non-negative variables
to let it lie within [aτ, τ ] while minimizing the penalty function, we can be sure that
only one variable has positive value.
Our second lemma explores the relationship between the penalty function p and the
loss function `.

6

Lemma B.2. Let Assumption 2 hold. Let f (·) be a convex function with a unique
(b
τ)
minimizer τb ∈ (aτ, τ ) and f (bτ ±x)−f
≥ C(0 < x < δ̄) for some N ∈ Z+ , δ̄ ∈
xN
+
+
R , C ∈ R . Define
gµ (t) = p(|t|) + µ · f (t),
where µ > 0. Let h(µ) be the minimum value of gµ (·). We have ∀δ < δ̄, µδ >
N
p(|b
τ |)2N
, ∃0 = µδ · C · 2δ
− p(|b
τ |): if t satisfies h(µδ ) + 0 ≥ gµδ (t) ≥ h(µδ ),
Cδ N
then t ∈ [b
τ − δ/2, τb + δ/2].
Proof. First, we can see that when t > τb + δ/2, we have
gµδ (t) ≥ p(|b
τ |) + µδ · f (t) > p(|b
τ |) + µδ · f (b
τ + δ/2) ≥ p(|b
τ |) + µδ · f (b
τ ) + µδ · C ·
 N
 N
δ
δ
≥ h(µδ ) + µδ · C ·
≥ h(µδ ) + 0 ,
= gµδ (b
τ ) + µδ · C ·
2
2
by the definition of f (·). When t < τb − δ/2, we have
 N
δ
2
 N 

 N
p(|b
τ |)2N
δ
p(|b
τ |)2N
δ
= µδ · f (b
τ) +
·C ·
+ µδ −
·C ·
N
N
Cδ
2
Cδ
2
 N
δ
≥ h(µδ ) + µδ · C ·
− p(|b
τ |).
2

gµδ (t) ≥ µδ · f (t) > µδ · f (b
τ − δ/2) ≥ µδ · f (b
τ ) + µδ · C ·

N
τ |), point t satisfying h(µδ ) + 0 ≥
Therefore, when we choose 0 = µδ · C · 2δ − p(|b
gµδ (t) ≥ h(µδ ) must lie in [b
τ − δ/2, τb + δ/2].

Lemma B.3. Let Assumption 2 hold and let f (·) be a convex function with a unique
(b
τ)
minimizer τb ∈ (aτ, τ ) and f (bτ ±x)−f
≥ C1 (0 < x < δ̄) for some N ∈ Z+ , δ̄ ∈
xN
+
+
R , C1 ∈ R . Let h(µ) be the minimum value of gµ (x) = p(|x|) + µ · f (x), then we
have
P

Pn
n
(i) ∀µ ∈ Z+ , t1 , ..., tn ∈ R : j=1 p(|tj |) + µ · f
j=1 tj ≥ h(µ).
(ii) ∃κ = mint∈[aτ,τ ] { 2p(t/2)−p(t)
}, ∀δ ≤ min{δ̄, 4τ −4b
τ , 4b
τ −4aτ, p(b
τ )/κ}, ∃µ =
t
p(|b
τ |)4N +1
, 0
C1 δ N

= κ · nδ , ∀θ ∈ [b
τ − δ/4, τb + δ/4] : if t1 , ..., tn ∈ R satisfy
h(µ) + 0 ≥

n
X



n
X
p(|tj |) + µ · f 
tj  ≥ h(µ),

j=1

j=1

then ti ∈ B(θ, δ) for one i and tj ∈ B(0, δ) for all j 6= i.

7

(B.2)

 N
δ
2

Proof.PWe first prove (i). We consider two cases separately. In the first case, we suppose
n
that | j=1 tj | > τ . Then we have
n
X


n
X
τ
p(|tj |) ≥
p Pn

j=1

j=1

k=1

|tk |



n
X
τ
Pn
· |tj | ≥ p 
j=1

k=1


|tk |

· |tj | ≥ p(τ ),

where the first inequality is inferred by the monotonicity of p and the second inequality
is due to (ii) of Lemma B.1. Thus, we have


n
n
X
X
p(|tj |) + µ · f 
tj  > min{p(τ ) + µ · f (τ ), p(τ ) + µ · f (−τ )} ≥ h(µ).
j=1

j=1

As a result, we can see that (i) holds when |
Pn
suppose | j=1 tj | ≤ τ and obtain

Pn

j=1 tj |

> τ . In the second case, we





X

 Pn

n
n Pn
n
X
X


| k=1 tk |
|
t
|
Pnk=1 k |tj | ≥ p 
p(|tj |) ≥
p Pn
|tj | ≥ p 
tj  ,
 j=1 
k=1 |tk |
k=1 |tk |
j=1
j=1
j=1

n
X

where the second inequality is due to (ii) of Lemma B.1. It follows that








 n 
n
n
n
n
X
X
X
X
X 
tj  = gµ 
tj  ≥ h(µ).
tj +µ·f 
p(|tj |)+µ·f 
tj  ≥ p 


j=1
j=1
j=1
j=1
j=1
(B.3)
which completes our proof of (i).
Pn
We then prove (ii). Assume equation (B.2) holds. If j=1 tj > τ , we can see that
by choosing 0 ≤ gµ (τ ) − gµ (b
τ ), we have


n
n
X
X
p(|tj |) + µ · f 
tj  > gµ (τ ) = gµ (b
τ ) + gµ (τ ) − gµ (b
τ ) ≥ h(µ) + 0 .
j=1

j=1

We will show later that our choice of 0 is indeed smaller
τ ). We will
Pnthan gµ (τ ) − gµ (b
also show later that equation (B.2) cannot hold when j=1 tj < −τ under our choice
Pn
of parameters. Thus, if equation (B.2) holds, then | j=1 tj | ≤ τ , which implies that




X

n
X
 n 
p 
tj  + µ · f 
tj  ≤ h(µ) + 0 ,
 j=1 
j=1
by equation (B.2) and the first inequality of (B.3), and


 n 
n
X
X 
tj  + 0 ,
p(|tj |) ≤ p 

j=1
j=1 
8

(B.4)

(B.5)

due to equation (B.2) and equation (B.3). Note that we just need to prove the case when
δ is sufficiently small. Thus, we assume in the following paper that δ is smaller than
δ̄, 4τ − 4b
τ , 4b
τ − 4aτ .
Consider the case when equation (B.4) holds. By Lemma B.3, if we choose µ =
p(|b
τ |)4N +1
and 1 = 3p(|b
τ |), then all of the points t such that h(µ) + 1 ≥ gµ (t) ≥ h(µ)
Cδ N
Pn
Pn
lie in [b
τ − δ/4, τb + δ/4]. Thus, we have j=1 tj ∈ [aτ, τ ] and j=1 tj ∈ B(θ, 2δ ) for
all θ ∈ [b
τ − δ/4, τb + δ/4]. Note that gµ (t) is non-increasing
Pn when t < 0, meaning that
equation (B.2) cannot hold under our choice of 1 when j=1 tj ≤ −τ .
On the other hand, if equation (B.2) holds, equation (B.5) should also hold. By (iv)
δ
of Lemma B.1, for the same δ, ∃2 = mint∈[aτ,τ ] (k1 (t) − k2 (t)) · 2n−2
, there is at
P
n
δ
δ
most one i such that ti 6∈ B(0, 2n−2 ). As j=1 tj ∈ B(θ, 2 ), we have ti ∈ B(θ, δ)
for all i = 1, · · · , n. Observe that gµ (τ ) − gµ (b
τ ) is always larger than 1 . Also,
1 > 2 if δ is sufficiently small. Therefore, ∃κ = mint∈[aτ,τ ] (k1 (t) − k2 (t))/2, ∀δ ≤
N +1

|)4
,  = κ· nδ , ∀θ ∈ [b
min{δ̄, 4τ −4b
τ , 4b
τP
−4aτ p(b
τ )/κ}, ∃µ = p(|bτCδ
τ −δ/4, τb+δ/4] :
N
n
if h(µ) +  ≥ gµ ( j=1 ti ), then ti ∈ B(θ, δ) for some i while tj ∈ B(0, δ) for all
j 6= i.


Now we are ready to prove the main theorem.
Proof of Theorem 2. Suppose that we are given the input to the 3-partition problem,
i.e., 3m positive integers s1 , ..., s3m . Assume without loss of generality that all si ’s are
upper bounded by some polynomial function M (m). This restriction on the input space
does not weaken our result, because the 3-partition problem is strongly NP-hard.
In what follows, we construct a reduction from P
the 3-partition problemPto Problem
3m
3m
1
1
1. We assume without loss of generality that 4m
j=1 sj < si < 2m
j=1 sj for
all i = 1, . . . , n. Such condition can always be satisfied by adding a sufficiently large
integer to all si ’s.

Step 1: The Reduction
The first reduction is developed through the following steps.
1
such that `1 (y) =
1. For the interval [aτ, τ ] determined by p, we choose {b1i }ki=1
P
k
1
1
i=1 `(y, b1i ) satisfies Assumption 2 with constants C, N, δ̄ and has a unique
λ
minimizer τb inside the interval (aτ, τ ). Let κ = mint∈[aτ,τ ] { 2p(t/2)−p(t)
}. Let
t

aτ
δ ≤ { 9m·M
τ , 4b
τ − 4aτ, p(b
τ )/κ}, µ ≥
(m) , δ̄, 4τ − 4b

such that Lemma B.3 is satisfied. Note that  ≥
by our construction.

p(|b
τ |)4N +1
C1 δ N

C3
m2 ·M (m)

and  = κ ·

δ
3m

for some constant C3

2. For the µ and  chosen in the previous step, all the minimizers of gµ (x) =
p(|x|) + µ · `1 (x) lie in [b
τ − δ/4, τb + δ/4] by Lemma B.3. By the Lipschitz

continuity of p(|x|), f (x) and thus gµ (x) on [aτ, τ ], there exists δ = 6mK
(K
is the Lipschitz constant) such that we can find in polynomial time an interval

[θ1 , θ2 ] where θ2 − θ1 = δ and gµ (x) − gµ (t∗ ) < 6m
for x ∈ [θ1 , θ2 ]. This
interval can be find in polynomial time as gµ (x) is Lipschitz continuous.

9

2
3. By Assumption 1, for the interval [θ1 , θ2 ], we choose {b2i }ki=1
to construct a
loss function `2 : R 7→ R in polynomial time with regard to 1/δ such that
Pk2
`(y, b2i ) has a unique minimizer at e
t ∈ [θ1 , θ2 ]. We choose
`2 (y) = λ1 i=1


ν = / max `2 (e
t + 2δm) − `2 (e
t), `2 (e
t − 2δm) − `2 (e
t) + 1,

and construct function f : R3m×m 7→ R where


m
3m
m
m
3m X
X
X
X
X
f (x) = λ ·
p (|xij |) + λµ ·
`1 
xij  + λν ·
`2
i=1 j=1

i=1

j=1

j=1

3m
X

!

si
P3m

0
i0 =1 si /m

i

(B.6)
Note that by (iii) of Assumption 1, ν is polynomial in max(d δ1 e, dθ2 e). In the
rest of the paper, we ignore the dθ2 e term in the bound as it can be upperbounded
by τ , which can be taken as a constant in the reduction.
t|) + µ · 3m · `1 (e
t) −
4. Let Φ1 = 3m · p(|e


2

and Φ2 = ν · m · `2 (e
t). We claim that

(i) If there exists z such that
Φ1 + Φ 2 +  ≥

1
f (z) ≥ Φ1 + Φ2 ,
λ

then we obtain a feasible assignment for the 3-partition problem as follows:
If zij ∈ B(e
t, δ), we assign number i to subset j.
(ii) If the 3-partition problem has a solution, we have λ1 minx f (x) ≤ Φ1 +
Φ2 + 2 .


c 1/(1−c1 −c2 )
2(3m·λ·µ·k1 +m·λ·ν·k2 )c1 (3m2 ) 2
where c1 and c2
5. Choose r =
/κ
are two arbitrary constants that c1 + c2 < 1. Construct the following instance of
Problem 1:
r
X

min
x(1) ,··· ,x(r) ∈R3m×m

λµ

k1
r X
3m X
X
q=1 i=1 t=1


`

f (x(q) ) =

x(1) ,··· ,x(r) ∈R3m×m

q=1
m
X

λ·

min


(q)
xij , b1t 

+ λν

k2
r X
m X
X
q=1 j=1 t=1

j=1

`

r X
3m X
m
X

(q)

p(|xij |)+

q=1 i=1 j=1
3m
X

si
P3m

i=1

0
i0 =1 si /m

!
(q)
xij , b2t

(B.7)
where the input data are coefficients of x and the values b11 , . . . , b1t , b21 , . . . , b2t .
The variable dimension d is r · 3m2 and the sample size n is λ · µ · r · 3m · k1 +
λ · ν · r · m · k2 . The input size is polynomial with respect to m. Our choice of r
is the solution to r = 2κnc1 dc2 where κ = mint∈[aτ,τ ] { 2p(t/2)−p(t)
}.
t
The parameters µ, ν, δ, r, d are bounded by polynomial functions of m. Computing their values also takes polynomial time. The parameter k1 and k2 is a
constant determined by the loss function ` and is not related to m. As a result, the
reduction is polynomial.
10

,

xij

.

6. Let z (1) , ·P
· · z (r) ∈ R3m×m be a λ · κ · nc1P
dc2 -optimal solution to problem (B.16)
r
r
(i)
such that i=1 f (z ) ≤ minx(1) ,··· ,x(r) i=1 f (x(i) ) + λ · κ · nc1 dc2 . We claim
that
(iii) If the approximate solution z (1) , · · · z (r) satisfies
r

1X
f (z (i) ) ≤ rΦ1 + rΦ2 + 2κnc1 dc2 ,
λ i=1

(B.8)

we can choose one z (i) such that Φ1 + Φ2 +  ≥ λ1 f (z (i) ) ≥ Φ1 + Φ2
(i)
and obtain a feasible assignment: If zij ∈ B(e
t, δ), we assign number i to
c1 c2
subset j. If the λ · κ · n d -optimal solution z (1) , · · · z (r) does not satisfy
(B.8), the 3-partition problem has no feasible solution.
We have constructed a polynomial reduction from the 3-partition problem to finding
an λ · κ · nc1 dc2 -optimal solution to problem (B.16). In what follows, we prove that the
reduction works.
Step 2: Proof of Claim (i)
We begin with the proof (i). By our choice of µ and Lemma B.3(i), we can see that for
all x ∈ R3m×m ,


3m X
m
3m
m
X
X
X
p(|xij |) + µ ·
`1 
xij  ≥ 3m · p(|t∗ |) + µ · 3m · `1 (t∗ ) ≥ Φ1 ,
i=1 j=1

i=1

j=1


where the last inequality is due to that gµ (e
t) − gµ (t∗ ) < 6m
. By the fact e
t =
3m×m
argmint `2 (t), we have for all x ∈ R
that
!
m
3m
X
X
si
h
ν·
xij ≥ ν · m · `2 (e
t) = Φ 2 .
P3m
0 /m
s
0
i
i =1
i=1
j=1

Thus we always have minz λ1 f (z) ≥ Φ1 + Φ2 . Now if there exists z such that Φ1 +
Φ2 +  ≥ λ1 f (z) ≥ Φ1 + Φ2 , we must have


3m X
m
3m
m
X
X
X
Φ1 +  ≥
p(|zij |) + µ ·
h
zij  ≥ Φ1 ,
(B.9)
i=1 j=1

i=1

j=1

and
Φ2 +  ≥ ν ·

m
X
j=1

h

3m
X

si
P3m

i=1

0
i0 =1 si /m

!
zij

≥ Φ2 .

(B.10)

In order for equation (B.9) to hold, we have that for all i,


m
m
X
X

p(|e
t|) + µ · `1 (e
t) + ≥
p(|zij |) + µ · `1 
zij  ≥ p(|t∗ |) + µ · `1 (t∗ ).
2 j=1
j=1
11


Consider an arbitrary i. By Lemma B.3(ii) and gµ (e
t) − gµ (t∗ ) < 6m
, we have zij ∈
e
e
B(t, δ) for one j while zik = 0 for all k 6= j. If zij ∈ B(t, δ), we assign number i
to subset j. As δ < aτ /2 ≤ e
t/2, B(e
t, δ) and B(0, δ) are not overlapping. Thus each
number index i is assigned to exactly one subset index j. Therefore the assignment is
feasible.
P3m
We claim that every subset sum must equal to i=1 si /m. Assume that the jth
P3m
subset sum is greater than or equal to i=1 si /m + 1. Let Ij = {i | zij ∈ B(e
t, δ)}.
P
P3m
Thus, i∈Ij si ≥ i=1 si /m + 1. As a result, we have
3m
X

si
P3m

i=1

i0 =1

s /m

zij ≥

i0

si

X
P3m
i∈I1

i0 =1

s /m

(e
t − δ) +

i0

si

X
P3m
i∈I2

0
i0 =1 si /m

(−δ)

P3m
≥

e
t
i=1 si /m + 1 e
− δm.
t − δm = e
t + P3m
P
3m
i=1 si /m
i=1 si /m

Because si ≤ M (m) for all i and δ =
e
t
P3m

i=1 si /m

− δm ≥

aτ
9m·M (m) ,

we have

aτ
m − δm = 2δm > 0.
3m · M (n)

Since h is a convex function with minimizer y ∗ , we apply the preceding inequalities
and further obtain
!
3m
X
si
zij ≥ `2 (e
t + 2δm).
`2
P3m
0 /m
s
0
i
i =1
i=1
By our construction of ν and Assumption 1(iii), we further have
!
!
3m
X

si
ν · `2
zij − `2 (e
t) ≥ ν · `2 (e
t + 2δm) − `2 (e
t) > . (B.11)
P3m
0
i0 =1 si /m
i=1
However, in order for equation (B.10) to hold, we have that for all j,
!
3m
X
s
i
ν · `2 (e
t) +  ≥ ν · `2
zij ≥ ν · `2 (e
t),
P3m
0
i0 =1 si /m
i=1
yielding a contradiction to (B.11). We could prove
P3msimilarly that it is not possible for
1
any subset sum to be strictly smaller than m
sum of every
i=1 si . Therefore, the
P3m
P3m
1
subset equals to i=1 si /m. Finally, using the assumption that 4m i=1 si < si <
P3m
1
i=1 si , each subset has exactly three components. Therefore the assignment is
2m
indeed a solution to the 3-partition problem.
Step 3: Proof of Claim (ii)
Suppose we have a solution to the 3-partition problem. Now we construct z to the
optimization problem such that f (z) ≤ Φ1 + Φ2 + 2 . For all 1 ≤ i ≤ 3m, if number i
12

is assigned to subset j, let zij = e
t and zik = 0 for all k 6= j. We can easily verify that


3m X
m
3m
m
X
X
X


p (|zij |) + µ ·
`1 
zij  = 3m · p(e
t) + µ · `1 (e
t) = Φ1 + ,
2
i=1 j=1
i=1
j=1
Also, we have
ν·

m
X

3m
X

`2

P3m

j=1

!

si
i0 =1

i=1

si0 /m

zij

= ν · m · `2 (e
t) = Φ 2 .

Therefore,

1

f (z) ≤ Φ1 + Φ2 + .
λ
2
which completes the proof of (ii).

(B.12)

Step 4: Proof of Claim (iii)
Pr
Suppose that the λ · κ · nc1 dc2 -optimal solution satisfies (B.8), i.e., λ1 i=1 f (z (i) ) ≤
rΦ1 + rΦ2 + 2κnc1 dc2 . It follows that there exists at least one term z (i) such that
2κnc1 dc2
1
f (z (i) ) ≤ Φ1 + Φ2 +
≤ Φ1 + Φ2 + .
(B.13)
λ
r
where the second inequality equality uses r = 2κnc1 dc2 . Therefore, by claim (ii), we
can find a solution to the 3-partition problem.
Suppose that the 3-partition problem has a solution. By claim (ii), there exists z
such that λ1 f (z) ≤ Φ1 + Φ2 + 2 . Thus we have
r

min
x(1) ,··· ,x(r)

1X
r
f (x(i) ) ≤ f (z) ≤ rΦ1 + rΦ2 + κnc1 dc2 .
λ i=1
λ

(B.14)

Thus if z (1) , · · · z (r) is a λ · κ · nc1 dc2 -optimal solution to (B.16), we have
r

r

1X
1X
f (z (i) ) ≤ min
f (x(i) )+κnc1 dc2 ≤ rΦ1 +rΦ2 +2κnc1 dc2 (B.15)
λ i=1
x(1) ,··· ,x(r) λ
i=1
implying that the relation (B.8) must hold. If (B.8) is not satisfied, the 3-partition
problem has no solution.

Remark. When the loss function is L2 loss, we can move λµ and λν of equation (B.16)
into the loss. Specifically, we have

min
x(1) ,··· ,x(r) ∈R3m×m

r
X
q=1

f (x(q) ) =

min
x(1) ,··· ,x(r) ∈R3m×m

λ·

r X
3m X
m
X

(q)

p(|xij |)+

q=1 i=1 j=1


2
!2
√
r X
3m
m p
r X
m
3m
X
X
X
X
p
√
λνs
i
(q)
(q)

xij − λνb2 ,
λµxij − λµb1  +
P3m
0
i0 =1 si /m
q=1 i=1
q=1 j=1
j=1
i=1
(B.16)
13

√
√
where µ, ν is chosen such that λµ, λν are rational numbers. In this case, the variable
dimension is r · 3m2 and the sample
size n is 4r · m. Our choice
of r is the solution to

1/(1−c1 −c2 ) 
c1
2 c2
2(4m)
(3m
)
r = 2κnc1 dc2 which is r =
. The value of r doesn’t
/κ
depend on λ and p, which means that we can plug in any λ, p and the reduction is still
polynomial in m. It means that for any choice of λ and p, it is strongly NP hard to find
a λκnc1 dc2 -optimal solution.

References
D. Ge, Z. Wang, Y. Ye, H. Yin, Strong NP-Hardness Result for Regularized
L_q-Minimization Problems with Concave Penalty Functions, arXiv preprint
arXiv:1501.00622 .
D. Ge, X. Jiang, Y. Ye, A note on the complexity of L p minimization, Mathematical
programming 129 (2) (2011) 285–299.

14

